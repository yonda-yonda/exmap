(self.webpackChunkexmap=self.webpackChunkexmap||[]).push([[491],{7228:function(e){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n},e.exports.__esModule=!0,e.exports.default=e.exports},2858:function(e){e.exports=function(e){if(Array.isArray(e))return e},e.exports.__esModule=!0,e.exports.default=e.exports},3646:function(e,t,r){var n=r(7228);e.exports=function(e){if(Array.isArray(e))return n(e)},e.exports.__esModule=!0,e.exports.default=e.exports},4575:function(e){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports.default=e.exports},9100:function(e,t,r){var n=r(9489),i=r(7067);function o(t,r,a){return i()?(e.exports=o=Reflect.construct,e.exports.__esModule=!0,e.exports.default=e.exports):(e.exports=o=function(e,t,r){var i=[null];i.push.apply(i,t);var o=new(Function.bind.apply(e,i));return r&&n(o,r.prototype),o},e.exports.__esModule=!0,e.exports.default=e.exports),o.apply(null,arguments)}e.exports=o,e.exports.__esModule=!0,e.exports.default=e.exports},3913:function(e){function t(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}e.exports=function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports},9713:function(e){e.exports=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e},e.exports.__esModule=!0,e.exports.default=e.exports},6525:function(e,t,r){var n=r(8331);function i(){return"undefined"!=typeof Reflect&&Reflect.get?(e.exports=i=Reflect.get,e.exports.__esModule=!0,e.exports.default=e.exports):(e.exports=i=function(e,t,r){var i=n(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},e.exports.__esModule=!0,e.exports.default=e.exports),i.apply(this,arguments)}e.exports=i,e.exports.__esModule=!0,e.exports.default=e.exports},9754:function(e){function t(r){return e.exports=t=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},2205:function(e,t,r){var n=r(9489);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&n(e,t)},e.exports.__esModule=!0,e.exports.default=e.exports},430:function(e){e.exports=function(e){return-1!==Function.toString.call(e).indexOf("[native code]")},e.exports.__esModule=!0,e.exports.default=e.exports},7067:function(e){e.exports=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}},e.exports.__esModule=!0,e.exports.default=e.exports},6860:function(e){e.exports=function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},e.exports.__esModule=!0,e.exports.default=e.exports},3884:function(e){e.exports=function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o=[],a=!0,s=!1;try{for(r=r.call(e);!(a=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);a=!0);}catch(u){s=!0,i=u}finally{try{a||null==r.return||r.return()}finally{if(s)throw i}}return o}},e.exports.__esModule=!0,e.exports.default=e.exports},521:function(e){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},8206:function(e){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},8585:function(e,t,r){var n=r(1160).default,i=r(1506);e.exports=function(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return i(e)},e.exports.__esModule=!0,e.exports.default=e.exports},3038:function(e,t,r){var n=r(2858),i=r(3884),o=r(379),a=r(521);e.exports=function(e,t){return n(e)||i(e,t)||o(e,t)||a()},e.exports.__esModule=!0,e.exports.default=e.exports},8331:function(e,t,r){var n=r(9754);e.exports=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=n(e)););return e},e.exports.__esModule=!0,e.exports.default=e.exports},319:function(e,t,r){var n=r(3646),i=r(6860),o=r(379),a=r(8206);e.exports=function(e){return n(e)||i(e)||o(e)||a()},e.exports.__esModule=!0,e.exports.default=e.exports},1160:function(e){function t(r){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},379:function(e,t,r){var n=r(7228);e.exports=function(e,t){if(e){if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}},e.exports.__esModule=!0,e.exports.default=e.exports},5957:function(e,t,r){var n=r(9754),i=r(9489),o=r(430),a=r(9100);function s(t){var r="function"==typeof Map?new Map:void 0;return e.exports=s=function(e){if(null===e||!o(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(e))return r.get(e);r.set(e,t)}function t(){return a(e,arguments,n(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i(t,e)},e.exports.__esModule=!0,e.exports.default=e.exports,s(t)}e.exports=s,e.exports.__esModule=!0,e.exports.default=e.exports},3015:function(e,t,r){"use strict";var n=r(5318);t.Z=void 0;var i=n(r(2174)),o=r(5893),a=(0,i.default)((0,o.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}),"Add");t.Z=a},4959:function(e,t,r){"use strict";var n=r(5318);t.Z=void 0;var i=n(r(2174)),o=r(5893),a=(0,i.default)((0,o.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),"Delete");t.Z=a},4682:function(e,t,r){"use strict";r.d(t,{Z:function(){return P}});var n=r(4942),i=r(3366),o=r(7462),a=r(7294),s=r(9408),u=r(7663),l=r(8440),c=r(7761),f=r(2067),h=r(5893),d=(0,f.Z)((0,h.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"RadioButtonUnchecked"),p=(0,f.Z)((0,h.jsx)("path",{d:"M8.465 8.465C9.37 7.56 10.62 7 12 7C14.76 7 17 9.24 17 12C17 13.38 16.44 14.63 15.535 15.535C14.63 16.44 13.38 17 12 17C9.24 17 7 14.76 7 12C7 10.62 7.56 9.37 8.465 8.465Z"}),"RadioButtonChecked"),m=r(3656),v=(0,m.ZP)("span")({position:"relative",display:"flex"}),y=(0,m.ZP)(d,{skipSx:!0})({transform:"scale(1)"}),g=(0,m.ZP)(p,{skipSx:!0})((function(e){var t=e.theme,r=e.ownerState;return(0,o.Z)({left:0,position:"absolute",transform:"scale(0)",transition:t.transitions.create("transform",{easing:t.transitions.easing.easeIn,duration:t.transitions.duration.shortest})},r.checked&&{transform:"scale(1)",transition:t.transitions.create("transform",{easing:t.transitions.easing.easeOut,duration:t.transitions.duration.shortest})})}));var b=function(e){var t=e.checked,r=void 0!==t&&t,n=e.classes,i=void 0===n?{}:n,a=e.fontSize,s=(0,o.Z)({},e,{checked:r});return(0,h.jsxs)(v,{className:i.root,ownerState:s,children:[(0,h.jsx)(y,{fontSize:a,className:i.background,ownerState:s}),(0,h.jsx)(g,{fontSize:a,className:i.dot,ownerState:s})]})},w=r(9240),_=r(9060),x=r(211);var T=r(8416);function E(e){return(0,T.Z)("MuiRadio",e)}var k=(0,r(2194).Z)("MuiRadio",["root","checked","disabled","colorPrimary","colorSecondary"]),S=["checked","checkedIcon","color","icon","name","onChange","size"],A=(0,m.ZP)(l.Z,{shouldForwardProp:function(e){return(0,m.FO)(e)||"classes"===e},name:"MuiRadio",slot:"Root",overridesResolver:function(e,t){var r=e.ownerState;return[t.root,t["color".concat((0,w.Z)(r.color))]]}})((function(e){var t=e.theme,r=e.ownerState;return(0,o.Z)({color:t.palette.text.secondary,"&:hover":{backgroundColor:(0,u.Fq)("default"===r.color?t.palette.action.active:t.palette[r.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"default"!==r.color&&(0,n.Z)({},"&.".concat(k.checked),{color:t.palette[r.color].main}),(0,n.Z)({},"&.".concat(k.disabled),{color:t.palette.action.disabled}))}));var R=(0,h.jsx)(b,{checked:!0}),C=(0,h.jsx)(b,{}),P=a.forwardRef((function(e,t){var r,n,u,l,f=(0,c.Z)({props:e,name:"MuiRadio"}),d=f.checked,p=f.checkedIcon,m=void 0===p?R:p,v=f.color,y=void 0===v?"primary":v,g=f.icon,b=void 0===g?C:g,T=f.name,k=f.onChange,P=f.size,D=void 0===P?"medium":P,O=(0,i.Z)(f,S),M=(0,o.Z)({},f,{color:y,size:D}),I=function(e){var t=e.classes,r=e.color,n={root:["root","color".concat((0,w.Z)(r))]};return(0,o.Z)({},t,(0,s.Z)(n,E,t))}(M),L=a.useContext(x.Z),Z=d,U=(0,_.Z)(k,L&&L.onChange),F=T;return L&&(void 0===Z&&(u=L.value,Z="object"==typeof(l=f.value)&&null!==l?u===l:String(u)===String(l)),void 0===F&&(F=L.name)),(0,h.jsx)(A,(0,o.Z)({type:"radio",icon:a.cloneElement(b,{fontSize:null!=(r=C.props.fontSize)?r:D}),checkedIcon:a.cloneElement(m,{fontSize:null!=(n=R.props.fontSize)?n:D}),ownerState:M,classes:I,name:F,checked:Z,onChange:U,ref:t},O))}))},4439:function(e,t,r){"use strict";r.d(t,{Z:function(){return x}});var n=r(9439),i=r(7462),o=r(3366),a=r(7294),s=r(5505),u=r(9408),l=r(3656),c=r(7761),f=r(8416);function h(e){return(0,f.Z)("MuiFormGroup",e)}(0,r(2194).Z)("MuiFormGroup",["root","row"]);var d=r(5893),p=["className","row"],m=(0,l.ZP)("div",{name:"MuiFormGroup",slot:"Root",overridesResolver:function(e,t){var r=e.ownerState;return[t.root,r.row&&t.row]}})((function(e){var t=e.ownerState;return(0,i.Z)({display:"flex",flexDirection:"column",flexWrap:"wrap"},t.row&&{flexDirection:"row"})})),v=a.forwardRef((function(e,t){var r=(0,c.Z)({props:e,name:"MuiFormGroup"}),n=r.className,a=r.row,l=void 0!==a&&a,f=(0,o.Z)(r,p),v=(0,i.Z)({},r,{row:l}),y=function(e){var t=e.classes,r={root:["root",e.row&&"row"]};return(0,u.Z)(r,h,t)}(v);return(0,d.jsx)(m,(0,i.Z)({className:(0,s.Z)(y.root,n),ownerState:v,ref:t},f))})),y=r(5973),g=r(6127),b=r(211),w=r(2152),_=["actions","children","defaultValue","name","onChange","value"],x=a.forwardRef((function(e,t){var r=e.actions,s=e.children,u=e.defaultValue,l=e.name,c=e.onChange,f=e.value,h=(0,o.Z)(e,_),p=a.useRef(null),m=(0,g.Z)({controlled:f,default:u,name:"RadioGroup"}),x=(0,n.Z)(m,2),T=x[0],E=x[1];a.useImperativeHandle(r,(function(){return{focus:function(){var e=p.current.querySelector("input:not(:disabled):checked");e||(e=p.current.querySelector("input:not(:disabled)")),e&&e.focus()}}}),[]);var k=(0,y.Z)(t,p),S=(0,w.Z)(l);return(0,d.jsx)(b.Z.Provider,{value:{name:S,onChange:function(e){E(e.target.value),c&&c(e,e.target.value)},value:T},children:(0,d.jsx)(v,(0,i.Z)({role:"radiogroup",ref:k},h,{children:s}))})}))},211:function(e,t,r){"use strict";var n=r(7294).createContext(void 0);t.Z=n},1939:function(e,t,r){"use strict";var n=(0,r(2696).ZP)();t.Z=n},964:function(e){var t=1e3,r=60*t,n=60*r,i=24*n,o=7*i,a=365.25*i;function s(e,t,r,n){var i=t>=1.5*r;return Math.round(e/r)+" "+n+(i?"s":"")}e.exports=function(e,u){u=u||{};var l=typeof e;if("string"===l&&e.length>0)return function(e){if((e=String(e)).length>100)return;var s=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!s)return;var u=parseFloat(s[1]);switch((s[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return u*a;case"weeks":case"week":case"w":return u*o;case"days":case"day":case"d":return u*i;case"hours":case"hour":case"hrs":case"hr":case"h":return u*n;case"minutes":case"minute":case"mins":case"min":case"m":return u*r;case"seconds":case"second":case"secs":case"sec":case"s":return u*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return u;default:return}}(e);if("number"===l&&isFinite(e))return u.long?function(e){var o=Math.abs(e);if(o>=i)return s(e,o,i,"day");if(o>=n)return s(e,o,n,"hour");if(o>=r)return s(e,o,r,"minute");if(o>=t)return s(e,o,t,"second");return e+" ms"}(e):function(e){var o=Math.abs(e);if(o>=i)return Math.round(e/i)+"d";if(o>=n)return Math.round(e/n)+"h";if(o>=r)return Math.round(e/r)+"m";if(o>=t)return Math.round(e/t)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},6157:function(e,t,r){var n;t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;var r="color: "+this.color;t.splice(1,0,r,"color: inherit");var n=0,i=0;t[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(n++,"%c"===e&&(i=n))})),t.splice(i,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(r){}},t.load=function(){var e;try{e=t.storage.getItem("debug")}catch(r){}!e&&"undefined"!=typeof process&&"env"in process&&(e={}.DEBUG);return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(n=!1,function(){n||(n=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||function(){},e.exports=r(425)(t),e.exports.formatters.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}},425:function(e,t,r){var n=r(319);e.exports=function(e){function t(e){var r,n,o,a=null;function s(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];if(s.enabled){var o=s,a=Number(new Date),u=a-(r||a);o.diff=u,o.prev=r,o.curr=a,r=a,n[0]=t.coerce(n[0]),"string"!=typeof n[0]&&n.unshift("%O");var l=0;n[0]=n[0].replace(/%([a-zA-Z%])/g,(function(e,r){if("%%"===e)return"%";l++;var i=t.formatters[r];if("function"==typeof i){var a=n[l];e=i.call(o,a),n.splice(l,1),l--}return e})),t.formatArgs.call(o,n);var c=o.log||t.log;c.apply(o,n)}}return s.namespace=e,s.useColors=t.useColors(),s.color=t.selectColor(e),s.extend=i,s.destroy=t.destroy,Object.defineProperty(s,"enabled",{enumerable:!0,configurable:!1,get:function(){return null!==a?a:(n!==t.namespaces&&(n=t.namespaces,o=t.enabled(e)),o)},set:function(e){a=e}}),"function"==typeof t.init&&t.init(s),s}function i(e,r){var n=t(this.namespace+(void 0===r?":":r)+e);return n.log=this.log,n}function o(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){var e=[].concat(n(t.names.map(o)),n(t.skips.map(o).map((function(e){return"-"+e})))).join(",");return t.enable(""),e},t.enable=function(e){var r;t.save(e),t.namespaces=e,t.names=[],t.skips=[];var n=("string"==typeof e?e:"").split(/[\s,]+/),i=n.length;for(r=0;r<i;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;var r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(964),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((function(r){t[r]=e[r]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){for(var r=0,n=0;n<e.length;n++)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t}},9498:function(e,t,r){"use strict";r.r(t),r.d(t,{GeoTIFF:function(){return Xr},MultiGeoTIFF:function(){return Qr},Pool:function(){return rt},addDecoder:function(){return Ce},default:function(){return Yr},fromArrayBuffer:function(){return tn},fromBlob:function(){return an},fromFile:function(){return nn},fromUrl:function(){return Jr},fromUrls:function(){return un},getDecoder:function(){return Pe},globals:function(){return _e},rgb:function(){return n},setLogger:function(){return jr},writeArrayBuffer:function(){return cn}});var n={};r.r(n),r.d(n,{fromBlackIsZero:function(){return Te},fromCIELab:function(){return Ae},fromCMYK:function(){return ke},fromPalette:function(){return Ee},fromWhiteIsZero:function(){return xe},fromYCbCr:function(){return Se}});var i=r(4942),o=r(9439),a=r(5861),s=r(136),u=r(6215),l=r(1120),c=r(9611);function f(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(ie){return!1}}function h(e,t,r){return h=f()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var i=new(Function.bind.apply(e,n));return r&&(0,c.Z)(i,r.prototype),i},h.apply(null,arguments)}function d(e){var t="function"==typeof Map?new Map:void 0;return d=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return h(e,arguments,(0,l.Z)(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),(0,c.Z)(n,e)},d(e)}var p=r(3144),m=r(5671),v=r(7757),y=r.n(v),g=r(3433);function b(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return _(e,t,n)}}function w(e,t){return b(x(e,t).get)}var _=Reflect.apply,x=(Reflect.construct,Reflect.defineProperty,Reflect.get,Reflect.getOwnPropertyDescriptor),T=Reflect.getPrototypeOf,E=(Reflect.has,Reflect.ownKeys,Reflect.set,Reflect.setPrototypeOf,Proxy,Number),k=(E.isFinite,E.isNaN,Symbol.iterator),S=(Symbol.species,Symbol.toStringTag),A=(Symbol.for,Object),R=A.create,C=(A.defineProperty,A.freeze,A.is,A.prototype),P=(b(C.isPrototypeOf),A.hasOwn||b(C.hasOwnProperty),Array),D=(P.isArray,P.prototype),O=(b(D.join),b(D.push),b(D.toLocaleString),D[k]),M=b(O),I=(Math.trunc,ArrayBuffer),L=(I.isView,b(I.prototype.slice),w(I.prototype,"byteLength"),"undefined"!=typeof SharedArrayBuffer?SharedArrayBuffer:null),Z=(L&&w(L.prototype,"byteLength"),T(Uint8Array)),U=(Z.from,Z.prototype),F=(U[k],b(U.keys),b(U.values),b(U.entries),b(U.set),b(U.reverse),b(U.fill),b(U.copyWithin),b(U.sort),b(U.slice),b(U.subarray),w(U,"buffer"),w(U,"byteOffset"),w(U,"length"),w(U,S),Uint16Array,Uint32Array),G=Float32Array,j=T([][k]()),B=b(j.next),N=b(y().mark((function e(){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))().next),z=T(j),V=DataView.prototype,$=b(V.getUint16),K=(b(V.setUint16),TypeError,RangeError,Set.prototype),W=(b(K.add),b(K.has),WeakMap),H=W.prototype,q=b(H.get);b(H.has),b(H.set);function X(e){if(e[k]===O)return e;var t=M(e);return R(null,(0,i.Z)({next:{value:function(){return B(t)}}},k,{value:function(){return this}}))}var Y=new W;R(z,(0,i.Z)({next:{value:function(){var e=q(Y,this);return N(e)},writable:!0,configurable:!0}},S,{value:"Array Iterator",configurable:!0}));for(var Q=new I(4),J=new G(Q),ee=new F(Q),te=new F(512),re=new F(512),ne=0;ne<256;++ne){var ie=ne-127;ie<-27?(te[ne]=0,te[256|ne]=32768,re[ne]=24,re[256|ne]=24):ie<-14?(te[ne]=1024>>-ie-14,te[256|ne]=1024>>-ie-14|32768,re[ne]=-ie-1,re[256|ne]=-ie-1):ie<=15?(te[ne]=ie+15<<10,te[256|ne]=ie+15<<10|32768,re[ne]=13,re[256|ne]=13):ie<128?(te[ne]=31744,te[256|ne]=64512,re[ne]=24,re[256|ne]=24):(te[ne]=31744,te[256|ne]=64512,re[ne]=13,re[256|ne]=13)}var oe=new F(2048),ae=new F(64),se=new F(64);oe[0]=0;for(var ue=1;ue<1024;++ue){for(var le=ue<<13,ce=0;0==(8388608&le);)ce-=8388608,le<<=1;le&=-8388609,ce+=947912704,oe[ue]=le|ce}for(var fe=1024;fe<2048;++fe)oe[fe]=939524096+(fe-1024<<13);ae[0]=0;for(var he=1;he<31;++he)ae[he]=he<<23;ae[31]=1199570944,ae[32]=2147483648;for(var de=33;de<63;++de)ae[de]=2147483648+(de-32<<23);ae[63]=3347054592,se[0]=0;for(var pe=1;pe<64;++pe)se[pe]=32===pe?0:1024;function me(e){var t=e>>10;return ee[0]=oe[se[t]+(1023&e)]+ae[t],J[0]}function ve(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];return me($.apply(void 0,[e,t].concat((0,g.Z)(X(n)))))}var ye=r(3349),ge=r.n(ye),be=r(7690),we=r.n(be),_e=r(5383);function xe(e,t){for(var r,n=e.width,i=e.height,o=new Uint8Array(n*i*3),a=0,s=0;a<e.length;++a,s+=3)r=256-e[a]/t*256,o[s]=r,o[s+1]=r,o[s+2]=r;return o}function Te(e,t){for(var r,n=e.width,i=e.height,o=new Uint8Array(n*i*3),a=0,s=0;a<e.length;++a,s+=3)r=e[a]/t*256,o[s]=r,o[s+1]=r,o[s+2]=r;return o}function Ee(e,t){for(var r=e.width,n=e.height,i=new Uint8Array(r*n*3),o=t.length/3,a=t.length/3*2,s=0,u=0;s<e.length;++s,u+=3){var l=e[s];i[u]=t[l]/65536*256,i[u+1]=t[l+o]/65536*256,i[u+2]=t[l+a]/65536*256}return i}function ke(e){for(var t=e.width,r=e.height,n=new Uint8Array(t*r*3),i=0,o=0;i<e.length;i+=4,o+=3){var a=e[i],s=e[i+1],u=e[i+2],l=e[i+3];n[o]=(255-a)/256*255*((255-l)/256),n[o+1]=(255-s)/256*255*((255-l)/256),n[o+2]=(255-u)/256*255*((255-l)/256)}return n}function Se(e){for(var t=e.width,r=e.height,n=new Uint8ClampedArray(t*r*3),i=0,o=0;i<e.length;i+=3,o+=3){var a=e[i],s=e[i+1],u=e[i+2];n[o]=a+1.402*(u-128),n[o+1]=a-.34414*(s-128)-.71414*(u-128),n[o+2]=a+1.772*(s-128)}return n}function Ae(e){for(var t=e.width,r=e.height,n=new Uint8Array(t*r*3),i=0,o=0;i<e.length;i+=3,o+=3){var a=(e[i+0]+16)/116,s=(e[i+1]<<24>>24)/500+a,u=a-(e[i+2]<<24>>24)/200,l=void 0,c=void 0,f=void 0;c=-.9689*(s=.95047*(s*s*s>.008856?s*s*s:(s-16/116)/7.787))+1.8758*(a=1*(a*a*a>.008856?a*a*a:(a-16/116)/7.787))+.0415*(u=1.08883*(u*u*u>.008856?u*u*u:(u-16/116)/7.787)),f=.0557*s+-.204*a+1.057*u,l=(l=3.2406*s+-1.5372*a+-.4986*u)>.0031308?1.055*Math.pow(l,1/2.4)-.055:12.92*l,c=c>.0031308?1.055*Math.pow(c,1/2.4)-.055:12.92*c,f=f>.0031308?1.055*Math.pow(f,1/2.4)-.055:12.92*f,n[o]=255*Math.max(0,Math.min(1,l)),n[o+1]=255*Math.max(0,Math.min(1,c)),n[o+2]=255*Math.max(0,Math.min(1,f))}return n}var Re=new Map;function Ce(e,t){Array.isArray(e)||(e=[e]),e.forEach((function(e){return Re.set(e,t)}))}function Pe(e){return De.apply(this,arguments)}function De(){return(De=(0,a.Z)(y().mark((function e(t){var r,n;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Re.get(t.Compression)){e.next=3;break}throw new Error("Unknown compression method identifier: ".concat(t.Compression));case 3:return e.next=5,r();case 5:return n=e.sent,e.abrupt("return",new n(t));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Oe(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return new(Object.getPrototypeOf(e).constructor)(t*r*n)}function Me(e,t,r,n,i){var o=t/n,a=r/i;return e.map((function(e){for(var s=Oe(e,n,i),u=0;u<i;++u)for(var l=Math.min(Math.round(a*u),r-1),c=0;c<n;++c){var f=Math.min(Math.round(o*c),t-1),h=e[l*t+f];s[u*n+c]=h}return s}))}function Ie(e,t,r){return(1-r)*e+r*t}function Le(e,t,r,n,i){var o=t/n,a=r/i;return e.map((function(e){for(var s=Oe(e,n,i),u=0;u<i;++u)for(var l=a*u,c=Math.floor(l),f=Math.min(Math.ceil(l),r-1),h=0;h<n;++h){var d=o*h,p=d%1,m=Math.floor(d),v=Math.min(Math.ceil(d),t-1),y=e[c*t+m],g=e[c*t+v],b=e[f*t+m],w=e[f*t+v],_=Ie(Ie(y,g,p),Ie(b,w,p),l%1);s[u*n+h]=_}return s}))}function Ze(e,t,r,n,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"nearest";switch(o.toLowerCase()){case"nearest":return Me(e,t,r,n,i);case"bilinear":case"linear":return Le(e,t,r,n,i);default:throw new Error("Unsupported resampling method: '".concat(o,"'"))}}function Ue(e,t,r,n,i,o){for(var a=t/n,s=r/i,u=Oe(e,n,i,o),l=0;l<i;++l)for(var c=Math.min(Math.round(s*l),r-1),f=0;f<n;++f)for(var h=Math.min(Math.round(a*f),t-1),d=0;d<o;++d){var p=e[c*t*o+h*o+d];u[l*n*o+f*o+d]=p}return u}function Fe(e,t,r,n,i,o){for(var a=t/n,s=r/i,u=Oe(e,n,i,o),l=0;l<i;++l)for(var c=s*l,f=Math.floor(c),h=Math.min(Math.ceil(c),r-1),d=0;d<n;++d)for(var p=a*d,m=p%1,v=Math.floor(p),y=Math.min(Math.ceil(p),t-1),g=0;g<o;++g){var b=e[f*t*o+v*o+g],w=e[f*t*o+y*o+g],_=e[h*t*o+v*o+g],x=e[h*t*o+y*o+g],T=Ie(Ie(b,w,m),Ie(_,x,m),c%1);u[l*n*o+d*o+g]=T}return u}function Ge(e,t,r,n,i,o){var a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"nearest";switch(a.toLowerCase()){case"nearest":return Ue(e,t,r,n,i,o);case"bilinear":case"linear":return Fe(e,t,r,n,i,o);default:throw new Error("Unsupported resampling method: '".concat(a,"'"))}}function je(e,t,r){for(var n=0,i=t;i<r;++i)n+=e[i];return n}function Be(e,t,r){switch(e){case 1:if(t<=8)return new Uint8Array(r);if(t<=16)return new Uint16Array(r);if(t<=32)return new Uint32Array(r);break;case 2:if(8===t)return new Int8Array(r);if(16===t)return new Int16Array(r);if(32===t)return new Int32Array(r);break;case 3:switch(t){case 16:case 32:return new Float32Array(r);case 64:return new Float64Array(r)}}throw Error("Unsupported data format/bitsPerSample")}function Ne(e,t){return(1!==e&&2!==e||!(t<=32)||t%8!=0)&&(3!==e||16!==t&&32!==t&&64!==t)}function ze(e,t,r,n,i,o,a){var s=new DataView(e),u=2===r?1:n,l=Be(t,i,2===r?a*o:a*o*n),c=parseInt("1".repeat(i),2);if(1===t){var f=o*(1===r?n*i:i);0!=(7&f)&&(f=f+7&-8);for(var h=0;h<a;++h)for(var d=h*f,p=0;p<o;++p)for(var m=d+p*u*i,v=0;v<u;++v){var y=m+v*i,g=(h*o+p)*u+v,b=Math.floor(y/8),w=y%8;if(w+i<=8)l[g]=s.getUint8(b)>>8-i-w&c;else if(w+i<=16)l[g]=s.getUint16(b)>>16-i-w&c;else if(w+i<=24){var _=s.getUint16(b)<<8|s.getUint8(b+2);l[g]=_>>24-i-w&c}else l[g]=s.getUint32(b)>>32-i-w&c}}return l.buffer}Ce([void 0,1],(function(){return Promise.all([r.e(351),r.e(429)]).then(r.bind(r,1429)).then((function(e){return e.default}))})),Ce(5,(function(){return Promise.all([r.e(351),r.e(255)]).then(r.bind(r,8255)).then((function(e){return e.default}))})),Ce(6,(function(){throw new Error("old style JPEG compression is not supported.")})),Ce(7,(function(){return Promise.all([r.e(351),r.e(580)]).then(r.bind(r,8580)).then((function(e){return e.default}))})),Ce([8,32946],(function(){return Promise.all([r.e(655),r.e(351),r.e(301)]).then(r.bind(r,7301)).then((function(e){return e.default}))})),Ce(32773,(function(){return Promise.all([r.e(351),r.e(61)]).then(r.bind(r,4061)).then((function(e){return e.default}))})),Ce(34887,(function(){return Promise.all([r.e(655),r.e(351),r.e(733)]).then(r.bind(r,8733)).then((function(e){return e.default}))}));var Ve=function(){function e(t,r,n,i,o,a){(0,m.Z)(this,e),this.fileDirectory=t,this.geoKeys=r,this.dataView=n,this.littleEndian=i,this.tiles=o?{}:null,this.isTiled=!t.StripOffsets;var s=t.PlanarConfiguration;if(this.planarConfiguration=void 0===s?1:s,1!==this.planarConfiguration&&2!==this.planarConfiguration)throw new Error("Invalid planar configuration.");this.source=a}var t,r,n,i;return(0,p.Z)(e,[{key:"getFileDirectory",value:function(){return this.fileDirectory}},{key:"getGeoKeys",value:function(){return this.geoKeys}},{key:"getWidth",value:function(){return this.fileDirectory.ImageWidth}},{key:"getHeight",value:function(){return this.fileDirectory.ImageLength}},{key:"getSamplesPerPixel",value:function(){return void 0!==this.fileDirectory.SamplesPerPixel?this.fileDirectory.SamplesPerPixel:1}},{key:"getTileWidth",value:function(){return this.isTiled?this.fileDirectory.TileWidth:this.getWidth()}},{key:"getTileHeight",value:function(){return this.isTiled?this.fileDirectory.TileLength:void 0!==this.fileDirectory.RowsPerStrip?Math.min(this.fileDirectory.RowsPerStrip,this.getHeight()):this.getHeight()}},{key:"getBlockWidth",value:function(){return this.getTileWidth()}},{key:"getBlockHeight",value:function(e){return this.isTiled||(e+1)*this.getTileHeight()<=this.getHeight()?this.getTileHeight():this.getHeight()-e*this.getTileHeight()}},{key:"getBytesPerPixel",value:function(){for(var e=0,t=0;t<this.fileDirectory.BitsPerSample.length;++t)e+=this.getSampleByteSize(t);return e}},{key:"getSampleByteSize",value:function(e){if(e>=this.fileDirectory.BitsPerSample.length)throw new RangeError("Sample index ".concat(e," is out of range."));return Math.ceil(this.fileDirectory.BitsPerSample[e]/8)}},{key:"getReaderForSample",value:function(e){var t=this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[e]:1,r=this.fileDirectory.BitsPerSample[e];switch(t){case 1:if(r<=8)return DataView.prototype.getUint8;if(r<=16)return DataView.prototype.getUint16;if(r<=32)return DataView.prototype.getUint32;break;case 2:if(r<=8)return DataView.prototype.getInt8;if(r<=16)return DataView.prototype.getInt16;if(r<=32)return DataView.prototype.getInt32;break;case 3:switch(r){case 16:return function(e,t){return ve(this,e,t)};case 32:return DataView.prototype.getFloat32;case 64:return DataView.prototype.getFloat64}}throw Error("Unsupported data format/bitsPerSample")}},{key:"getSampleFormat",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[e]:1}},{key:"getBitsPerSample",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.fileDirectory.BitsPerSample[e]}},{key:"getArrayForSample",value:function(e,t){return Be(this.getSampleFormat(e),this.getBitsPerSample(e),t)}},{key:"getTileOrStrip",value:(i=(0,a.Z)(y().mark((function e(t,r,n,i,o){var s,u,l,c,f,h,d,p,m=this;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=Math.ceil(this.getWidth()/this.getTileWidth()),u=Math.ceil(this.getHeight()/this.getTileHeight()),c=this.tiles,1===this.planarConfiguration?l=r*s+t:2===this.planarConfiguration&&(l=n*s*u+r*s+t),this.isTiled?(f=this.fileDirectory.TileOffsets[l],h=this.fileDirectory.TileByteCounts[l]):(f=this.fileDirectory.StripOffsets[l],h=this.fileDirectory.StripByteCounts[l]),e.next=7,this.source.fetch([{offset:f,length:h}],o);case 7:return d=e.sent[0],null!==c&&c[l]?p=c[l]:(p=(0,a.Z)(y().mark((function e(){var t,n,o;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.decode(m.fileDirectory,d);case 2:return t=e.sent,n=m.getSampleFormat(),o=m.getBitsPerSample(),Ne(n,o)&&(t=ze(t,n,m.planarConfiguration,m.getSamplesPerPixel(),o,m.getTileWidth(),m.getBlockHeight(r))),e.abrupt("return",t);case 7:case"end":return e.stop()}}),e)})))(),null!==c&&(c[l]=p)),e.t0=t,e.t1=r,e.t2=n,e.next=14,p;case 14:return e.t3=e.sent,e.abrupt("return",{x:e.t0,y:e.t1,sample:e.t2,data:e.t3});case 16:case"end":return e.stop()}}),e,this)}))),function(e,t,r,n,o){return i.apply(this,arguments)})},{key:"_readRaster",value:(n=(0,a.Z)(y().mark((function e(t,r,n,i,o,a,s,u,l){var c,f,h,d,p,m,v,g,b,w,_,x,T,E,k,S,A,R,C,P,D=this;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(c=this.getTileWidth(),f=this.getTileHeight(),h=this.getWidth(),d=this.getHeight(),p=Math.max(Math.floor(t[0]/c),0),m=Math.min(Math.ceil(t[2]/c),Math.ceil(h/c)),v=Math.max(Math.floor(t[1]/f),0),g=Math.min(Math.ceil(t[3]/f),Math.ceil(d/f)),b=t[2]-t[0],w=this.getBytesPerPixel(),_=[],x=[],T=0;T<r.length;++T)1===this.planarConfiguration?_.push(je(this.fileDirectory.BitsPerSample,0,r[T])/8):_.push(0),x.push(this.getReaderForSample(r[T]));for(E=[],k=this.littleEndian,S=v;S<g;++S)for(A=p;A<m;++A)for(R=function(e){var a=e,s=r[e];2===D.planarConfiguration&&(w=D.getSampleByteSize(e));var u=D.getTileOrStrip(A,S,s,o,l);E.push(u),u.then((function(e){for(var o=e.data,s=new DataView(o),u=D.getBlockHeight(e.y),l=e.y*f,p=e.x*c,m=l+u,v=(e.x+1)*c,y=x[a],g=Math.min(u,u-(m-t[3]),d-l),T=Math.min(c,c-(v-t[2]),h-p),E=Math.max(0,t[1]-l);E<g;++E)for(var S=Math.max(0,t[0]-p);S<T;++S){var A=(E*c+S)*w,R=y.call(s,A+_[a],k),C=void 0;i?(C=(E+l-t[1])*b*r.length+(S+p-t[0])*r.length+a,n[C]=R):(C=(E+l-t[1])*b+S+p-t[0],n[a][C]=R)}}))},C=0;C<r.length;++C)R(C);return e.next=18,Promise.all(E);case 18:if(!(a&&t[2]-t[0]!==a||s&&t[3]-t[1]!==s)){e.next=23;break}return(P=i?Ge(n,t[2]-t[0],t[3]-t[1],a,s,r.length,u):Ze(n,t[2]-t[0],t[3]-t[1],a,s,u)).width=a,P.height=s,e.abrupt("return",P);case 23:return n.width=a||t[2]-t[0],n.height=s||t[3]-t[1],e.abrupt("return",n);case 26:case"end":return e.stop()}}),e,this)}))),function(e,t,r,i,o,a,s,u,l){return n.apply(this,arguments)})},{key:"readRasters",value:(r=(0,a.Z)(y().mark((function e(){var t,r,n,i,o,a,s,u,l,c,f,h,d,p,m,v,g,b,w,_,x,T,E,k,S,A,R=arguments;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=R.length>0&&void 0!==R[0]?R[0]:{},r=t.window,n=t.samples,i=void 0===n?[]:n,o=t.interleave,a=t.pool,s=void 0===a?null:a,u=t.width,l=t.height,c=t.resampleMethod,f=t.fillValue,h=t.signal,!((d=r||[0,0,this.getWidth(),this.getHeight()])[0]>d[2]||d[1]>d[3])){e.next=4;break}throw new Error("Invalid subsets");case 4:if(p=d[2]-d[0],m=d[3]-d[1],v=p*m,g=this.getSamplesPerPixel(),i&&i.length){e.next=12;break}for(b=0;b<g;++b)i.push(b);e.next=19;break;case 12:w=0;case 13:if(!(w<i.length)){e.next=19;break}if(!(i[w]>=g)){e.next=16;break}return e.abrupt("return",Promise.reject(new RangeError("Invalid sample index '".concat(i[w],"'."))));case 16:++w,e.next=13;break;case 19:if(o)x=this.fileDirectory.SampleFormat?Math.max.apply(null,this.fileDirectory.SampleFormat):1,T=Math.max.apply(null,this.fileDirectory.BitsPerSample),_=Be(x,T,v*i.length),f&&_.fill(f);else for(_=[],E=0;E<i.length;++E)k=this.getArrayForSample(i[E],v),Array.isArray(f)&&E<f.length?k.fill(f[E]):f&&!Array.isArray(f)&&k.fill(f),_.push(k);if(e.t0=s,e.t0){e.next=25;break}return e.next=24,Pe(this.fileDirectory);case 24:e.t0=e.sent;case 25:return S=e.t0,e.next=28,this._readRaster(d,i,_,o,S,u,l,c,h);case 28:return A=e.sent,e.abrupt("return",A);case 30:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"readRGB",value:(t=(0,a.Z)(y().mark((function e(){var t,r,n,i,o,a,s,u,l,c,f,h,d,p,m,v,g,b,w,_,x,T,E,k,S,A,R,C=arguments;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=C.length>0&&void 0!==C[0]?C[0]:{},r=t.window,n=t.interleave,i=void 0===n||n,o=t.pool,a=void 0===o?null:o,s=t.width,u=t.height,l=t.resampleMethod,c=t.enableAlpha,f=void 0!==c&&c,h=t.signal,!((d=r||[0,0,this.getWidth(),this.getHeight()])[0]>d[2]||d[1]>d[3])){e.next=4;break}throw new Error("Invalid subsets");case 4:if((p=this.fileDirectory.PhotometricInterpretation)!==_e.photometricInterpretations.RGB){e.next=9;break}if(m=[0,1,2],this.fileDirectory.ExtraSamples!==_e.ExtraSamplesValues.Unspecified&&f)for(m=[],v=0;v<this.fileDirectory.BitsPerSample.length;v+=1)m.push(v);return e.abrupt("return",this.readRasters({window:r,interleave:i,samples:m,pool:a,width:s,height:u,resampleMethod:l,signal:h}));case 9:e.t0=p,e.next=e.t0===_e.photometricInterpretations.WhiteIsZero||e.t0===_e.photometricInterpretations.BlackIsZero||e.t0===_e.photometricInterpretations.Palette?12:e.t0===_e.photometricInterpretations.CMYK?14:e.t0===_e.photometricInterpretations.YCbCr||e.t0===_e.photometricInterpretations.CIELab?16:18;break;case 12:return g=[0],e.abrupt("break",19);case 14:return g=[0,1,2,3],e.abrupt("break",19);case 16:return g=[0,1,2],e.abrupt("break",19);case 18:throw new Error("Invalid or unsupported photometric interpretation.");case 19:return b={window:d,interleave:!0,samples:g,pool:a,width:s,height:u,resampleMethod:l,signal:h},w=this.fileDirectory,e.next=23,this.readRasters(b);case 23:_=e.sent,x=Math.pow(2,this.fileDirectory.BitsPerSample[0]),e.t1=p,e.next=e.t1===_e.photometricInterpretations.WhiteIsZero?28:e.t1===_e.photometricInterpretations.BlackIsZero?30:e.t1===_e.photometricInterpretations.Palette?32:e.t1===_e.photometricInterpretations.CMYK?34:e.t1===_e.photometricInterpretations.YCbCr?36:e.t1===_e.photometricInterpretations.CIELab?38:40;break;case 28:return T=xe(_,x),e.abrupt("break",41);case 30:return T=Te(_,x),e.abrupt("break",41);case 32:return T=Ee(_,w.ColorMap),e.abrupt("break",41);case 34:return T=ke(_),e.abrupt("break",41);case 36:return T=Se(_),e.abrupt("break",41);case 38:return T=Ae(_),e.abrupt("break",41);case 40:throw new Error("Unsupported photometric interpretation.");case 41:if(!i){for(E=new Uint8Array(T.length/3),k=new Uint8Array(T.length/3),S=new Uint8Array(T.length/3),A=0,R=0;A<T.length;A+=3,++R)E[R]=T[A],k[R]=T[A+1],S[R]=T[A+2];T=[E,k,S]}return T.width=_.width,T.height=_.height,e.abrupt("return",T);case 45:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"getTiePoints",value:function(){if(!this.fileDirectory.ModelTiepoint)return[];for(var e=[],t=0;t<this.fileDirectory.ModelTiepoint.length;t+=6)e.push({i:this.fileDirectory.ModelTiepoint[t],j:this.fileDirectory.ModelTiepoint[t+1],k:this.fileDirectory.ModelTiepoint[t+2],x:this.fileDirectory.ModelTiepoint[t+3],y:this.fileDirectory.ModelTiepoint[t+4],z:this.fileDirectory.ModelTiepoint[t+5]});return e}},{key:"getGDALMetadata",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t={};if(!this.fileDirectory.GDAL_METADATA)return null;var r=this.fileDirectory.GDAL_METADATA,n=we()(r,"Item");null!==e&&(n=n.filter((function(t){return Number(ge()(t,"sample"))===e})));for(var i=0;i<n.length;++i){var o=n[i];t[ge()(o,"name")]=o.inner}return t}},{key:"getGDALNoData",value:function(){if(!this.fileDirectory.GDAL_NODATA)return null;var e=this.fileDirectory.GDAL_NODATA;return Number(e.substring(0,e.length-1))}},{key:"getOrigin",value:function(){var e=this.fileDirectory.ModelTiepoint,t=this.fileDirectory.ModelTransformation;if(e&&6===e.length)return[e[3],e[4],e[5]];if(t)return[t[3],t[7],t[11]];throw new Error("The image does not have an affine transformation.")}},{key:"getResolution",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.fileDirectory.ModelPixelScale,r=this.fileDirectory.ModelTransformation;if(t)return[t[0],-t[1],t[2]];if(r)return[r[0],r[5],r[10]];if(e){var n=e.getResolution(),i=(0,o.Z)(n,3),a=i[0],s=i[1],u=i[2];return[a*e.getWidth()/this.getWidth(),s*e.getHeight()/this.getHeight(),u*e.getWidth()/this.getWidth()]}throw new Error("The image does not have an affine transformation.")}},{key:"pixelIsArea",value:function(){return 1===this.geoKeys.GTRasterTypeGeoKey}},{key:"getBoundingBox",value:function(){var e=this.getOrigin(),t=this.getResolution(),r=e[0],n=e[1],i=r+t[0]*this.getWidth(),o=n+t[1]*this.getHeight();return[Math.min(r,i),Math.min(n,o),Math.max(r,i),Math.max(n,o)]}}]),e}(),$e=Ve,Ke=function(){function e(t){(0,m.Z)(this,e),this._dataView=new DataView(t)}return(0,p.Z)(e,[{key:"buffer",get:function(){return this._dataView.buffer}},{key:"getUint64",value:function(e,t){var r,n=this.getUint32(e,t),i=this.getUint32(e+4,t);if(t){if(r=n+Math.pow(2,32)*i,!Number.isSafeInteger(r))throw new Error("".concat(r," exceeds MAX_SAFE_INTEGER. ")+"Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues");return r}if(r=Math.pow(2,32)*n+i,!Number.isSafeInteger(r))throw new Error("".concat(r," exceeds MAX_SAFE_INTEGER. ")+"Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues");return r}},{key:"getInt64",value:function(e,t){for(var r=0,n=(128&this._dataView.getUint8(e+(t?7:0)))>0,i=!0,o=0;o<8;o++){var a=this._dataView.getUint8(e+(t?o:7-o));n&&(i?0!==a&&(a=255&~(a-1),i=!1):a=255&~a),r+=a*Math.pow(256,o)}return n&&(r=-r),r}},{key:"getUint8",value:function(e,t){return this._dataView.getUint8(e,t)}},{key:"getInt8",value:function(e,t){return this._dataView.getInt8(e,t)}},{key:"getUint16",value:function(e,t){return this._dataView.getUint16(e,t)}},{key:"getInt16",value:function(e,t){return this._dataView.getInt16(e,t)}},{key:"getUint32",value:function(e,t){return this._dataView.getUint32(e,t)}},{key:"getInt32",value:function(e,t){return this._dataView.getInt32(e,t)}},{key:"getFloat16",value:function(e,t){return ve(this._dataView,e,t)}},{key:"getFloat32",value:function(e,t){return this._dataView.getFloat32(e,t)}},{key:"getFloat64",value:function(e,t){return this._dataView.getFloat64(e,t)}}]),e}(),We=function(){function e(t,r,n,i){(0,m.Z)(this,e),this._dataView=new DataView(t),this._sliceOffset=r,this._littleEndian=n,this._bigTiff=i}return(0,p.Z)(e,[{key:"sliceOffset",get:function(){return this._sliceOffset}},{key:"sliceTop",get:function(){return this._sliceOffset+this.buffer.byteLength}},{key:"littleEndian",get:function(){return this._littleEndian}},{key:"bigTiff",get:function(){return this._bigTiff}},{key:"buffer",get:function(){return this._dataView.buffer}},{key:"covers",value:function(e,t){return this.sliceOffset<=e&&this.sliceTop>=e+t}},{key:"readUint8",value:function(e){return this._dataView.getUint8(e-this._sliceOffset,this._littleEndian)}},{key:"readInt8",value:function(e){return this._dataView.getInt8(e-this._sliceOffset,this._littleEndian)}},{key:"readUint16",value:function(e){return this._dataView.getUint16(e-this._sliceOffset,this._littleEndian)}},{key:"readInt16",value:function(e){return this._dataView.getInt16(e-this._sliceOffset,this._littleEndian)}},{key:"readUint32",value:function(e){return this._dataView.getUint32(e-this._sliceOffset,this._littleEndian)}},{key:"readInt32",value:function(e){return this._dataView.getInt32(e-this._sliceOffset,this._littleEndian)}},{key:"readFloat32",value:function(e){return this._dataView.getFloat32(e-this._sliceOffset,this._littleEndian)}},{key:"readFloat64",value:function(e){return this._dataView.getFloat64(e-this._sliceOffset,this._littleEndian)}},{key:"readUint64",value:function(e){var t,r=this.readUint32(e),n=this.readUint32(e+4);if(this._littleEndian){if(t=r+Math.pow(2,32)*n,!Number.isSafeInteger(t))throw new Error("".concat(t," exceeds MAX_SAFE_INTEGER. ")+"Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues");return t}if(t=Math.pow(2,32)*r+n,!Number.isSafeInteger(t))throw new Error("".concat(t," exceeds MAX_SAFE_INTEGER. ")+"Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues");return t}},{key:"readInt64",value:function(e){for(var t=0,r=(128&this._dataView.getUint8(e+(this._littleEndian?7:0)))>0,n=!0,i=0;i<8;i++){var o=this._dataView.getUint8(e+(this._littleEndian?i:7-i));r&&(n?0!==o&&(o=255&~(o-1),n=!1):o=255&~o),t+=o*Math.pow(256,i)}return r&&(t=-t),t}},{key:"readOffset",value:function(e){return this._bigTiff?this.readUint64(e):this.readUint32(e)}}]),e}(),He=r(5626),qe=r.n(He),Xe=(qe().registerSerializer,qe().spawn),Ye=(qe().BlobWorker,qe().DefaultSerializer,qe().Pool),Qe=(qe().Thread,qe().Transfer),Je=qe().Worker,et="undefined"!=typeof navigator?navigator.hardwareConcurrency:null,tt=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:et,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Je("./decoder.worker.js");(0,m.Z)(this,e),this.pool=Ye((function(){return Xe(r)}),t)}var t;return(0,p.Z)(e,[{key:"decode",value:(t=(0,a.Z)(y().mark((function e(t,r){var n=this;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,i){n.pool.queue(function(){var n=(0,a.Z)(y().mark((function n(o){var a;return y().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,o(t,Qe(r));case 3:a=n.sent,e(a),n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),i(n.t0);case 10:case"end":return n.stop()}}),n,null,[[0,7]])})));return function(e){return n.apply(this,arguments)}}())})));case 1:case"end":return e.stop()}}),e)}))),function(e,r){return t.apply(this,arguments)})},{key:"destroy",value:function(){this.pool.terminate(!0)}}]),e}(),rt=tt,nt=r(3366);function it(e,t){if(null==e)return{};var r,n,i=(0,nt.Z)(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}var ot=r(3878),at=r(9199),st=r(181),ut=r(5267);r(8559);function lt(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return ct(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ct(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function ct(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var ft="\r\n\r\n";function ht(e){if(void 0!==Object.fromEntries)return Object.fromEntries(e);var t,r={},n=lt(e);try{for(n.s();!(t=n.n()).done;){var i=(0,o.Z)(t.value,2),a=i[0],s=i[1];r[a.toLowerCase()]=s}}catch(u){n.e(u)}finally{n.f()}return r}function dt(e){return ht(e.split("\r\n").map((function(e){var t=e.split(":").map((function(e){return e.trim()}));return t[0]=t[0].toLowerCase(),t})))}function pt(e){var t,r=e.split(";").map((function(e){return e.trim()})),n=(t=r,(0,ot.Z)(t)||(0,at.Z)(t)||(0,st.Z)(t)||(0,ut.Z)());return{type:n[0],params:ht(n.slice(1).map((function(e){return e.split("=")})))}}function mt(e){var t,r,n;if(e){var i=e.match(/bytes (\d+)-(\d+)\/(\d+)/),a=(0,o.Z)(i,4);t=a[1],r=a[2],n=a[3],t=parseInt(t,10),r=parseInt(r,10),n=parseInt(n,10)}return{start:t,end:r,total:n}}function vt(e,t){for(var r=null,n=new TextDecoder("ascii"),i=[],o="--".concat(t),a="".concat(o,"--"),s=0;s<10;++s){n.decode(new Uint8Array(e,s,o.length))===o&&(r=s)}if(null===r)throw new Error("Could not find initial boundary");for(;r<e.byteLength;){var u=n.decode(new Uint8Array(e,r,Math.min(o.length+1024,e.byteLength-r)));if(0===u.length||u.startsWith(a))break;if(!u.startsWith(o))throw new Error("Part does not start with boundary");var l=u.substr(o.length+2);if(0===l.length)break;var c=l.indexOf(ft),f=dt(l.substr(0,c)),h=mt(f["content-range"]),d=h.start,p=h.end,m=h.total,v=r+o.length+c+ft.length,y=parseInt(p,10)+1-parseInt(d,10);i.push({headers:f,data:e.slice(v,v+y),offset:d,length:y,fileSize:m}),r=v+y+4}return i}var yt=function(){function e(){(0,m.Z)(this,e)}var t,r,n;return(0,p.Z)(e,[{key:"fetch",value:(n=(0,a.Z)(y().mark((function e(t){var r,n=this,i=arguments;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>1&&void 0!==i[1]?i[1]:void 0,e.abrupt("return",Promise.all(t.map((function(e){return n.fetchSlice(e,r)}))));case 2:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})},{key:"fetchSlice",value:(r=(0,a.Z)(y().mark((function e(t){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("fetching of slice ".concat(t," not possible, not implemented"));case 1:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"fileSize",get:function(){return null}},{key:"close",value:(t=(0,a.Z)(y().mark((function e(){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})}]),e}(),gt=(r(7314),r(5660)),bt=r.n(gt),wt=r(7326);function _t(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(ie){return!1}}();return function(){var r,n=(0,l.Z)(e);if(t){var i=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,u.Z)(this,r)}}function xt(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])}function Tt(e,t){return!(e.length<t.length)&&e.substr(e.length-t.length)===t}function Et(e){var t={};for(var r in e){if(e.hasOwnProperty(r))t[e[r]]=r}return t}function kt(e,t){for(var r=[],n=0;n<e;n++)r.push(t(n));return r}function St(e){return At.apply(this,arguments)}function At(){return(At=(0,a.Z)(y().mark((function e(t){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){return setTimeout(e,t)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Rt(e,t){var r=Array.isArray(e)?e:Array.from(e),n=Array.isArray(t)?t:Array.from(t);return r.map((function(e,t){return[e,n[t]]}))}var Ct=function(e){(0,s.Z)(r,e);var t=_t(r);function r(e){var n;return(0,m.Z)(this,r),n=t.call(this,e),Error.captureStackTrace&&Error.captureStackTrace((0,wt.Z)(n),r),n.name="AbortError",n}return(0,p.Z)(r)}(d(Error)),Pt=function(e){(0,s.Z)(r,e);var t=_t(r);function r(e,n){var i;return(0,m.Z)(this,r),(i=t.call(this,n)).errors=e,i.message=n,i.name="AggregateError",i}return(0,p.Z)(r)}(d(Error));function Dt(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return Ot(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ot(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function Ot(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Mt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(ie){return!1}}();return function(){var r,n=(0,l.Z)(e);if(t){var i=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,u.Z)(this,r)}}var It=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;(0,m.Z)(this,e),this.offset=t,this.length=r,this.data=n}return(0,p.Z)(e,[{key:"top",get:function(){return this.offset+this.length}}]),e}(),Lt=(0,p.Z)((function e(t,r,n){(0,m.Z)(this,e),this.offset=t,this.length=r,this.blockIds=n})),Zt=function(e){(0,s.Z)(n,e);var t,r=Mt(n);function n(e){var t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=i.blockSize,a=void 0===o?65536:o,s=i.cacheSize,u=void 0===s?100:s;return(0,m.Z)(this,n),(t=r.call(this)).source=e,t.blockSize=a,t.blockCache=new(bt())({max:u}),t.blockRequests=new Map,t.blockIdsToFetch=new Set,t}return(0,p.Z)(n,[{key:"fileSize",get:function(){return this.source.fileSize}},{key:"fetch",value:(t=(0,a.Z)(y().mark((function e(t,r){var n,i,a,s,u,l,c,f,h,d,p,m,v,g,b,w,_,x,T,E,k,S,A,R,C,P,D,O,M,I,L,Z,U,F,G,j,B,N;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=new Map,i=new Map,a=new Set,s=Dt(t);try{for(s.s();!(u=s.n()).done;)for(l=u.value,c=l.offset,f=l.length,h=c+f,null!==(d=this.fileSize)&&(h=Math.min(h,d)),p=Math.floor(c/this.blockSize)*this.blockSize,m=p;m<h;m+=this.blockSize)v=Math.floor(m/this.blockSize),this.blockCache.has(v)?n.set(v,this.blockCache.get(v)):this.blockRequests.has(v)?i.set(v,this.blockRequests.get(v)):(this.blockIdsToFetch.has(v)||this.blockIdsToFetch.add(v),a.add(v))}catch(y){s.e(y)}finally{s.f()}return e.next=7,St();case 7:this.fetchBlocks(r),g=Dt(a),e.prev=9,g.s();case 11:if((b=g.n()).done){e.next=26;break}if(w=b.value,_=this.blockRequests.get(w),x=this.blockCache.get(w),!_){e.next=19;break}i.set(w,_),e.next=24;break;case 19:if(!x){e.next=23;break}n.set(w,x),e.next=24;break;case 23:throw new Error("Block ".concat(w," is not in the block requests"));case 24:e.next=11;break;case 26:e.next=31;break;case 28:e.prev=28,e.t0=e.catch(9),g.e(e.t0);case 31:return e.prev=31,g.f(),e.finish(31);case 34:return e.next=36,Promise.allSettled(Array.from(i.values()));case 36:if(!(T=e.sent).some((function(e){return"rejected"===e.status}))){e.next=65;break}E=new Set,k=Dt(Rt(i.keys(),T));try{for(k.s();!(S=k.n()).done;)A=(0,o.Z)(S.value,2),R=A[0],C=A[1],P=C.rejected,D=C.reason,P&&"AbortError"===D.name&&D.signal!==r&&(this.blockIdsToFetch.add(R),E.add(R))}catch(y){k.e(y)}finally{k.f()}if(!(this.blockIdsToFetch.length>0)){e.next=65;break}this.fetchBlocks(r),O=Dt(E),e.prev=44,O.s();case 46:if((M=O.n()).done){e.next=54;break}if(I=M.value,L=this.blockRequests.get(I)){e.next=51;break}throw new Error("Block ".concat(I," is not in the block requests"));case 51:i.set(I,L);case 52:e.next=46;break;case 54:e.next=59;break;case 56:e.prev=56,e.t1=e.catch(44),O.e(e.t1);case 59:return e.prev=59,O.f(),e.finish(59);case 62:return e.next=64,Promise.allSettled(Array.from(i.values()));case 64:T=e.sent;case 65:if(!T.some((function(e){return"rejected"===e.status}))){e.next=69;break}if(!r||!r.aborted){e.next=68;break}throw new Ct("Request was aborted");case 68:throw new Pt(T.filter((function(e){return"rejected"===e.status})).map((function(e){return e.reason})),"Request failed");case 69:Z=T.map((function(e){return e.value})),U=new Map(Rt(Array.from(i.keys()),Z)),F=Dt(n);try{for(F.s();!(G=F.n()).done;)j=(0,o.Z)(G.value,2),B=j[0],N=j[1],U.set(B,N)}catch(y){F.e(y)}finally{F.f()}return e.abrupt("return",this.readSliceData(t,U));case 74:case"end":return e.stop()}}),e,this,[[9,28,31,34],[44,56,59,62]])}))),function(e,r){return t.apply(this,arguments)})},{key:"fetchBlocks",value:function(e){var t=this;this.blockIdsToFetch.size>0&&function(){for(var r=t.groupBlocks(t.blockIdsToFetch),n=t.source.fetch(r,e),i=function(i){var o,s=Dt(r[i].blockIds);try{var u=function(){var r=o.value,s=(0,a.Z)(y().mark((function o(){var a,s,u,l,c,f;return y().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,n;case 3:return o.t0=i,a=o.sent[o.t0],s=r*t.blockSize,u=s-a.offset,l=Math.min(u+t.blockSize,a.data.byteLength),c=a.data.slice(u,l),f=new It(s,c.byteLength,c),t.blockCache.set(r,f),o.abrupt("return",f);case 14:throw o.prev=14,o.t1=o.catch(0),"AbortError"===o.t1.name&&(o.t1.signal=e),o.t1;case 18:return o.prev=18,t.blockRequests.delete(r),o.finish(18);case 21:case"end":return o.stop()}}),o,null,[[0,14,18,21]])})))();t.blockRequests.set(r,s)};for(s.s();!(o=s.n()).done;)u()}catch(l){s.e(l)}finally{s.f()}},o=0;o<r.length;++o)i(o);t.blockIdsToFetch.clear()}()}},{key:"groupBlocks",value:function(e){var t=Array.from(e).sort((function(e,t){return e-t}));if(0===t.length)return[];var r,n=[],i=null,o=[],a=Dt(t);try{for(a.s();!(r=a.n()).done;){var s=r.value;null===i||i+1===s?(n.push(s),i=s):(o.push(new Lt(n[0]*this.blockSize,n.length*this.blockSize,n)),n=[s],i=s)}}catch(u){a.e(u)}finally{a.f()}return o.push(new Lt(n[0]*this.blockSize,n.length*this.blockSize,n)),o}},{key:"readSliceData",value:function(e,t){var r=this;return e.map((function(e){for(var n=e.offset+e.length,i=Math.floor(e.offset/r.blockSize),o=Math.floor((e.offset+e.length)/r.blockSize),a=new ArrayBuffer(e.length),s=new Uint8Array(a),u=i;u<=o;++u){var l=t.get(u),c=l.offset-e.offset,f=0,h=0,d=void 0;c<0?f=-c:c>0&&(h=c),d=l.top-n<0?l.length-f:n-l.offset-f;var p=new Uint8Array(l.data,f,d);s.set(p,h)}return a}))}}]),n}(yt),Ut=function(){function e(){(0,m.Z)(this,e)}var t;return(0,p.Z)(e,[{key:"ok",get:function(){return this.status>=200&&this.status<=299}},{key:"status",get:function(){throw new Error("not implemented")}},{key:"getHeader",value:function(e){throw new Error("not implemented")}},{key:"getData",value:(t=(0,a.Z)(y().mark((function e(){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("not implemented");case 1:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})}]),e}(),Ft=function(){function e(t){(0,m.Z)(this,e),this.url=t}var t;return(0,p.Z)(e,[{key:"request",value:(t=(0,a.Z)(y().mark((function e(){var t,r=arguments;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw(t=r.length>0&&void 0!==r[0]?r[0]:{}).headers,t.credentials,t.signal,new Error("request is not implemented");case 2:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})}]),e}();function Gt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(ie){return!1}}();return function(){var r,n=(0,l.Z)(e);if(t){var i=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,u.Z)(this,r)}}var jt=function(e){(0,s.Z)(n,e);var t,r=Gt(n);function n(e){var t;return(0,m.Z)(this,n),(t=r.call(this)).response=e,t}return(0,p.Z)(n,[{key:"status",get:function(){return this.response.status}},{key:"getHeader",value:function(e){return this.response.headers.get(e)}},{key:"getData",value:(t=(0,a.Z)(y().mark((function e(){var t;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.response.arrayBuffer){e.next=6;break}return e.next=3,this.response.arrayBuffer();case 3:e.t0=e.sent,e.next=9;break;case 6:return e.next=8,this.response.buffer();case 8:e.t0=e.sent.buffer;case 9:return t=e.t0,e.abrupt("return",t);case 11:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),n}(Ut),Bt=function(e){(0,s.Z)(n,e);var t,r=Gt(n);function n(e,t){var i;return(0,m.Z)(this,n),(i=r.call(this,e)).credentials=t,i}return(0,p.Z)(n,[{key:"request",value:(t=(0,a.Z)(y().mark((function e(){var t,r,n,i,o,a=arguments;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:{},r=t.headers,n=t.credentials,i=t.signal,e.next=3,fetch(this.url,{headers:r,credentials:n,signal:i});case 3:return o=e.sent,e.abrupt("return",new jt(o));case 5:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),n}(Ft);function Nt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(ie){return!1}}();return function(){var r,n=(0,l.Z)(e);if(t){var i=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,u.Z)(this,r)}}var zt=function(e){(0,s.Z)(n,e);var t,r=Nt(n);function n(e,t){var i;return(0,m.Z)(this,n),(i=r.call(this)).xhr=e,i.data=t,i}return(0,p.Z)(n,[{key:"status",get:function(){return this.xhr.status}},{key:"getHeader",value:function(e){return this.xhr.getResponseHeader(e)}},{key:"getData",value:(t=(0,a.Z)(y().mark((function e(){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.data);case 1:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),n}(Ut),Vt=function(e){(0,s.Z)(n,e);var t,r=Nt(n);function n(){return(0,m.Z)(this,n),r.apply(this,arguments)}return(0,p.Z)(n,[{key:"constructRequest",value:function(e,t){var r=this;return new Promise((function(n,i){var a=new XMLHttpRequest;a.open("GET",r.url),a.responseType="arraybuffer";for(var s=0,u=Object.entries(e);s<u.length;s++){var l=(0,o.Z)(u[s],2),c=l[0],f=l[1];a.setRequestHeader(c,f)}a.onload=function(){var e=a.response;n(new zt(a,e))},a.onerror=i,a.onabort=function(){return i(new Ct("Request aborted"))},a.send(),t&&(t.aborted&&a.abort(),t.addEventListener("abort",(function(){return a.abort()})))}))}},{key:"request",value:(t=(0,a.Z)(y().mark((function e(){var t,r,n,i,o=arguments;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:{},r=t.headers,n=t.signal,e.next=3,this.constructRequest(r,n);case 3:return i=e.sent,e.abrupt("return",i);case 5:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),n}(Ft),$t=r(1555),Kt=r.n($t),Wt=r(2913),Ht=r.n(Wt),qt=r(8419),Xt=r.n(qt);function Yt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Qt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Yt(Object(r),!0).forEach((function(t){(0,i.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Yt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Jt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(ie){return!1}}();return function(){var r,n=(0,l.Z)(e);if(t){var i=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,u.Z)(this,r)}}var er=function(e){(0,s.Z)(n,e);var t,r=Jt(n);function n(e,t){var i;return(0,m.Z)(this,n),(i=r.call(this)).response=e,i.dataPromise=t,i}return(0,p.Z)(n,[{key:"status",get:function(){return this.response.statusCode}},{key:"getHeader",value:function(e){return this.response.headers[e]}},{key:"getData",value:(t=(0,a.Z)(y().mark((function e(){var t;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.dataPromise;case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),n}(Ut),tr=function(e){(0,s.Z)(n,e);var t,r=Jt(n);function n(e){var t;return(0,m.Z)(this,n),(t=r.call(this,e)).parsedUrl=Xt().parse(t.url),t.httpApi="http:"===t.parsedUrl.protocol?Kt():Ht(),t}return(0,p.Z)(n,[{key:"constructRequest",value:function(e,t){var r=this;return new Promise((function(n,i){var o=r.httpApi.get(Qt(Qt({},r.parsedUrl),{},{headers:e}),(function(e){var t=new Promise((function(t){var r=[];e.on("data",(function(e){r.push(e)})),e.on("end",(function(){var e=Buffer.concat(r).buffer;t(e)})),e.on("error",i)}));n(new er(e,t))}));o.on("error",i),t&&(t.aborted&&o.destroy(new Ct("Request aborted")),t.addEventListener("abort",(function(){return o.destroy(new Ct("Request aborted"))})))}))}},{key:"request",value:(t=(0,a.Z)(y().mark((function e(){var t,r,n,i,o=arguments;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:{},r=t.headers,n=t.signal,e.next=3,this.constructRequest(r,n);case 3:return i=e.sent,e.abrupt("return",i);case 5:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),n}(Ft),rr=["headers","credentials","maxRanges","allowFullFile"],nr=["headers","maxRanges","allowFullFile"],ir=["headers","maxRanges","allowFullFile"],or=["forceXHR"];function ar(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function sr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ar(Object(r),!0).forEach((function(t){(0,i.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ar(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ur(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(ie){return!1}}();return function(){var r,n=(0,l.Z)(e);if(t){var i=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,u.Z)(this,r)}}var lr=function(e){(0,s.Z)(o,e);var t,r,n,i=ur(o);function o(e,t,r,n){var a;return(0,m.Z)(this,o),(a=i.call(this)).client=e,a.headers=t,a.maxRanges=r,a.allowFullFile=n,a._fileSize=null,a}return(0,p.Z)(o,[{key:"fetch",value:(n=(0,a.Z)(y().mark((function e(t,r){var n=this;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.maxRanges>=t.length)){e.next=4;break}return e.abrupt("return",this.fetchSlices(t,r));case 4:this.maxRanges>0&&t.length;case 5:return e.abrupt("return",Promise.all(t.map((function(e){return n.fetchSlice(e,r)}))));case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"fetchSlices",value:(r=(0,a.Z)(y().mark((function e(t,r){var n,i,o,a,s,u,l,c,f,h,d,p,m,v=this;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.client.request({headers:sr(sr({},this.headers),{},{Range:"bytes=".concat(t.map((function(e){var t=e.offset,r=e.length;return"".concat(t,"-").concat(t+r)})).join(","))}),signal:r});case 2:if((n=e.sent).ok){e.next=7;break}throw new Error("Error fetching data.");case 7:if(206!==n.status){e.next=32;break}if(i=pt(n.getHeader("content-type")),o=i.type,a=i.params,"multipart/byteranges"!==o){e.next=18;break}return e.t0=vt,e.next=13,n.getData();case 13:return e.t1=e.sent,e.t2=a.boundary,s=(0,e.t0)(e.t1,e.t2),this._fileSize=s[0].fileSize||null,e.abrupt("return",s);case 18:return e.next=20,n.getData();case 20:if(u=e.sent,l=mt(n.getHeader("content-range")),c=l.start,f=l.end,h=l.total,this._fileSize=h||null,d=[{data:u,offset:c,length:f-c}],!(t.length>1)){e.next=29;break}return e.next=27,Promise.all(t.slice(1).map((function(e){return v.fetchSlice(e,r)})));case 27:return p=e.sent,e.abrupt("return",d.concat(p));case 29:return e.abrupt("return",d);case 32:if(this.allowFullFile){e.next=34;break}throw new Error("Server responded with full file");case 34:return e.next=36,n.getData();case 36:return m=e.sent,this._fileSize=m.byteLength,e.abrupt("return",[{data:m,offset:0,length:m.byteLength}]);case 39:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"fetchSlice",value:(t=(0,a.Z)(y().mark((function e(t,r){var n,i,o,a,s,u,l;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.offset,i=t.length,e.next=3,this.client.request({headers:sr(sr({},this.headers),{},{Range:"bytes=".concat(n,"-").concat(n+i)}),signal:r});case 3:if((o=e.sent).ok){e.next=8;break}throw new Error("Error fetching data.");case 8:if(206!==o.status){e.next=17;break}return e.next=11,o.getData();case 11:return a=e.sent,s=mt(o.getHeader("content-range")),u=s.total,this._fileSize=u||null,e.abrupt("return",{data:a,offset:n,length:i});case 17:if(this.allowFullFile){e.next=19;break}throw new Error("Server responded with full file");case 19:return e.next=21,o.getData();case 21:return l=e.sent,this._fileSize=l.byteLength,e.abrupt("return",{data:l,offset:0,length:l.byteLength});case 24:case"end":return e.stop()}}),e,this)}))),function(e,r){return t.apply(this,arguments)})},{key:"fileSize",get:function(){return this._fileSize}}]),o}(yt);function cr(e,t){var r=t.blockSize,n=t.cacheSize;return null===r?e:new Zt(e,r,n)}function fr(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.headers,n=void 0===r?{}:r,i=t.credentials,o=t.maxRanges,a=void 0===o?0:o,s=t.allowFullFile,u=void 0!==s&&s,l=it(t,rr),c=new Bt(e,i),f=new lr(c,n,a,u);return cr(f,l)}function hr(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.headers,n=void 0===r?{}:r,i=t.maxRanges,o=void 0===i?0:i,a=t.allowFullFile,s=void 0!==a&&a,u=it(t,nr),l=new Vt(e),c=new lr(l,n,o,s);return cr(c,u)}function dr(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.headers,n=void 0===r?{}:r,i=t.maxRanges,o=void 0===i?0:i,a=t.allowFullFile,s=void 0!==a&&a,u=it(t,ir),l=new tr(e),c=new lr(l,n,o,s);return cr(c,u)}function pr(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.forceXHR,n=void 0!==r&&r,i=it(t,or);return"function"!=typeof fetch||n?"undefined"!=typeof XMLHttpRequest?hr(e,i):dr(e,i):fr(e,i)}function mr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(ie){return!1}}();return function(){var r,n=(0,l.Z)(e);if(t){var i=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,u.Z)(this,r)}}var vr=function(e){(0,s.Z)(r,e);var t=mr(r);function r(e){var n;return(0,m.Z)(this,r),(n=t.call(this)).arrayBuffer=e,n}return(0,p.Z)(r,[{key:"fetchSlice",value:function(e,t){if(t&&t.aborted)throw new Ct("Request aborted");return this.arrayBuffer.slice(e.offset,e.offset+e.length)}}]),r}(yt);function yr(e){return new vr(e)}function gr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(ie){return!1}}();return function(){var r,n=(0,l.Z)(e);if(t){var i=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,u.Z)(this,r)}}var br=function(e){(0,s.Z)(n,e);var t,r=gr(n);function n(e){var t;return(0,m.Z)(this,n),(t=r.call(this)).file=e,t}return(0,p.Z)(n,[{key:"fetchSlice",value:(t=(0,a.Z)(y().mark((function e(t,r){var n=this;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,i){var o=n.file.slice(t.offset,t.offset+t.length),a=new FileReader;a.onload=function(t){return e(t.target.result)},a.onerror=i,a.onabort=i,a.readAsArrayBuffer(o),r&&r.addEventListener("abort",(function(){return a.abort()}))})));case 1:case"end":return e.stop()}}),e)}))),function(e,r){return t.apply(this,arguments)})}]),n}(yt);function wr(e){return new br(e)}var _r=r(713),xr=r.n(_r);function Tr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(ie){return!1}}();return function(){var r,n=(0,l.Z)(e);if(t){var i=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,u.Z)(this,r)}}function Er(e){return new Promise((function(t,r){xr().close(e,(function(e){e?r(e):t()}))}))}function kr(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new Promise((function(e,r){xr().read.apply(xr(),t.concat([function(t,n,i){t?r(t):e({bytesRead:n,buffer:i})}]))}))}var Sr=function(e){(0,s.Z)(i,e);var t,r,n=Tr(i);function i(e){var t;return(0,m.Z)(this,i),(t=n.call(this)).path=e,t.openRequest=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;return new Promise((function(n,i){xr().open(e,t,r,(function(e,t){e?i(e):n(t)}))}))}(e,"r"),t}return(0,p.Z)(i,[{key:"fetchSlice",value:(r=(0,a.Z)(y().mark((function e(t){var r,n,i;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.openRequest;case 2:return r=e.sent,e.next=5,kr(r,Buffer.alloc(t.length),0,t.length,t.offset);case 5:return n=e.sent,i=n.buffer,e.abrupt("return",i.buffer);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"close",value:(t=(0,a.Z)(y().mark((function e(){var t;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.openRequest;case 2:return t=e.sent,e.next=5,Er(t);case 5:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),i}(yt);function Ar(e){return new Sr(e)}function Rr(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return Cr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Cr(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function Cr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Pr=Et(_e.fieldTagNames),Dr=Et(_e.geoKeyNames),Or={};xt(Or,Pr),xt(Or,Dr);var Mr=Et(_e.fieldTypeNames),Ir=1e3,Lr={nextZero:function(e,t){for(var r=t;0!==e[r];)r++;return r},readUshort:function(e,t){return e[t]<<8|e[t+1]},readShort:function(e,t){var r=Lr.ui8;return r[0]=e[t+1],r[1]=e[t+0],Lr.i16[0]},readInt:function(e,t){var r=Lr.ui8;return r[0]=e[t+3],r[1]=e[t+2],r[2]=e[t+1],r[3]=e[t+0],Lr.i32[0]},readUint:function(e,t){var r=Lr.ui8;return r[0]=e[t+3],r[1]=e[t+2],r[2]=e[t+1],r[3]=e[t+0],Lr.ui32[0]},readASCII:function(e,t,r){return r.map((function(r){return String.fromCharCode(e[t+r])})).join("")},readFloat:function(e,t){var r=Lr.ui8;return kt(4,(function(n){r[n]=e[t+3-n]})),Lr.fl32[0]},readDouble:function(e,t){var r=Lr.ui8;return kt(8,(function(n){r[n]=e[t+7-n]})),Lr.fl64[0]},writeUshort:function(e,t,r){e[t]=r>>8&255,e[t+1]=255&r},writeUint:function(e,t,r){e[t]=r>>24&255,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=r>>0&255},writeASCII:function(e,t,r){kt(r.length,(function(n){e[t+n]=r.charCodeAt(n)}))},ui8:new Uint8Array(8)};Lr.fl64=new Float64Array(Lr.ui8.buffer),Lr.writeDouble=function(e,t,r){Lr.fl64[0]=r,kt(8,(function(r){e[t+r]=Lr.ui8[7-r]}))};var Zr=function(e){var t=new Uint8Array(Ir),r=4,n=Lr;t[0]=77,t[1]=77,t[3]=42;var i=8;if(n.writeUint(t,r,i),r+=4,e.forEach((function(r,o){var a=function(e,t,r,n){var i=r,o=Object.keys(n).filter((function(e){return null!=e&&"undefined"!==e}));e.writeUshort(t,i,o.length);var a,s=(i+=2)+12*o.length+4,u=Rr(o);try{var l=function(){var r=a.value,o=null;"number"==typeof r?o=r:"string"==typeof r&&(o=parseInt(r,10));var u=_e.fieldTagTypes[o],l=Mr[u];if(null==u||void 0===u||void 0===u)throw new Error("unknown type of tag: ".concat(o));var c=n[r];if(void 0===c)throw new Error("failed to get value for key ".concat(r));"ASCII"===u&&"string"==typeof c&&!1===Tt(c,"\0")&&(c+="\0");var f=c.length;e.writeUshort(t,i,o),i+=2,e.writeUshort(t,i,l),i+=2,e.writeUint(t,i,f);var h=[-1,1,1,2,4,8,0,0,0,0,0,0,8][l]*f,d=i+=4;h>4&&(e.writeUint(t,i,s),d=s),"ASCII"===u?e.writeASCII(t,d,c):"SHORT"===u?kt(f,(function(r){e.writeUshort(t,d+2*r,c[r])})):"LONG"===u?kt(f,(function(r){e.writeUint(t,d+4*r,c[r])})):"RATIONAL"===u?kt(f,(function(r){e.writeUint(t,d+8*r,Math.round(1e4*c[r])),e.writeUint(t,d+8*r+4,1e4)})):"DOUBLE"===u&&kt(f,(function(r){e.writeDouble(t,d+8*r,c[r])})),h>4&&(s+=h+=1&h),i+=4};for(u.s();!(a=u.n()).done;)l()}catch(c){u.e(c)}finally{u.f()}return[i,s]}(n,t,i,r);i=a[1],o<e.length-1&&n.writeUint(t,a[0],i)})),t.slice)return t.slice(0,i).buffer;for(var o=new Uint8Array(i),a=0;a<i;a++)o[a]=t[a];return o.buffer},Ur=[["Compression",1],["PlanarConfiguration",1],["ExtraSamples",0]];function Fr(e,t){var r,n,i,o;"number"==typeof e[0]?(r=t.height||t.ImageLength,i=t.width||t.ImageWidth,n=e.length/(r*i),o=e):(n=e.length,r=e[0].length,i=e[0][0].length,o=[],kt(r,(function(t){kt(i,(function(r){kt(n,(function(n){o.push(e[n][t][r])}))}))}))),t.ImageLength=r,delete t.height,t.ImageWidth=i,delete t.width,t.BitsPerSample||(t.BitsPerSample=kt(n,(function(){return 8}))),Ur.forEach((function(e){var r=e[0];if(!t[r]){var n=e[1];t[r]=n}})),t.PhotometricInterpretation||(t.PhotometricInterpretation=3===t.BitsPerSample.length?2:1),t.SamplesPerPixel||(t.SamplesPerPixel=[n]),t.StripByteCounts||(t.StripByteCounts=[n*r*i]),t.ModelPixelScale||(t.ModelPixelScale=[360/i,180/r,0]),t.SampleFormat||(t.SampleFormat=kt(n,(function(){return 1}))),t.hasOwnProperty("GeographicTypeGeoKey")||t.hasOwnProperty("ProjectedCSTypeGeoKey")||(t.GeographicTypeGeoKey=4326,t.ModelTiepoint=[0,0,0,-180,90,0],t.GeogCitationGeoKey="WGS 84",t.GTModelTypeGeoKey=2);var a=Object.keys(t).filter((function(e){return Tt(e,"GeoKey")})).sort((function(e,t){return Or[e]-Or[t]}));if(!t.GeoAsciiParams){var s="";a.forEach((function(e){var r=Number(Or[e]);"ASCII"===_e.fieldTagTypes[r]&&(s+="".concat(t[e].toString(),"\0"))})),s.length>0&&(t.GeoAsciiParams=s)}if(!t.GeoKeyDirectory){var u=[1,1,0,a.length];a.forEach((function(e){var r,n,i,o=Number(Or[e]);u.push(o),"SHORT"===_e.fieldTagTypes[o]?(r=1,n=0,i=t[e]):"GeogCitationGeoKey"===e?(r=t.GeoAsciiParams.length,n=Number(Or.GeoAsciiParams),i=0):console.log("[geotiff.js] couldn't get TIFFTagLocation for ".concat(e)),u.push(n),u.push(r),u.push(i)})),t.GeoKeyDirectory=u}for(var l in a)a.hasOwnProperty(l)&&delete t[l];["Compression","ExtraSamples","GeographicTypeGeoKey","GTModelTypeGeoKey","GTRasterTypeGeoKey","ImageLength","ImageWidth","Orientation","PhotometricInterpretation","ProjectedCSTypeGeoKey","PlanarConfiguration","ResolutionUnit","SamplesPerPixel","XPosition","YPosition"].forEach((function(e){var r;t[e]&&(t[e]=(r=t[e],Array.isArray(r)?r:[r]))}));var c=function(e){var t={};for(var r in e)"StripOffsets"!==r&&(Or[r]||console.error(r,"not in name2code:",Object.keys(Or)),t[Or[r]]=e[r]);return t}(t),f=function(e,t,r,n){if(null==r)throw new Error("you passed into encodeImage a width of type ".concat(r));if(null==t)throw new Error("you passed into encodeImage a width of type ".concat(t));var i={256:[t],257:[r],273:[Ir],278:[r],305:"geotiff.js"};if(n)for(var o in n)n.hasOwnProperty(o)&&(i[o]=n[o]);var a=new Uint8Array(Zr([i])),s=new Uint8Array(e),u=i[277],l=new Uint8Array(Ir+t*r*u);return kt(a.length,(function(e){l[e]=a[e]})),function(e,t){for(var r=e.length,n=0;n<r;n++)t(e[n],n)}(s,(function(e,t){l[Ir+t]=e})),l.buffer}(o,i,r,c);return f}var Gr=function(){function e(){(0,m.Z)(this,e)}return(0,p.Z)(e,[{key:"log",value:function(){}},{key:"debug",value:function(){}},{key:"info",value:function(){}},{key:"warn",value:function(){}},{key:"error",value:function(){}},{key:"time",value:function(){}},{key:"timeEnd",value:function(){}}]),e}();new Gr;function jr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Gr;e}function Br(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Nr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Br(Object(r),!0).forEach((function(t){(0,i.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Br(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function zr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(ie){return!1}}();return function(){var r,n=(0,l.Z)(e);if(t){var i=(0,l.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,u.Z)(this,r)}}function Vr(e){switch(e){case _e.fieldTypes.BYTE:case _e.fieldTypes.ASCII:case _e.fieldTypes.SBYTE:case _e.fieldTypes.UNDEFINED:return 1;case _e.fieldTypes.SHORT:case _e.fieldTypes.SSHORT:return 2;case _e.fieldTypes.LONG:case _e.fieldTypes.SLONG:case _e.fieldTypes.FLOAT:case _e.fieldTypes.IFD:return 4;case _e.fieldTypes.RATIONAL:case _e.fieldTypes.SRATIONAL:case _e.fieldTypes.DOUBLE:case _e.fieldTypes.LONG8:case _e.fieldTypes.SLONG8:case _e.fieldTypes.IFD8:return 8;default:throw new RangeError("Invalid field type: ".concat(e))}}function $r(e){var t=e.GeoKeyDirectory;if(!t)return null;for(var r={},n=4;n<=4*t[3];n+=4){var i=_e.geoKeyNames[t[n]],o=t[n+1]?_e.fieldTagNames[t[n+1]]:null,a=t[n+2],s=t[n+3],u=null;if(o){if(null==(u=e[o]))throw new Error("Could not get value of geoKey '".concat(i,"'."));"string"==typeof u?u=u.substring(s,s+a-1):u.subarray&&(u=u.subarray(s,s+a),1===a&&(u=u[0]))}else u=s;r[i]=u}return r}function Kr(e,t,r,n){var i=null,o=null,a=Vr(t);switch(t){case _e.fieldTypes.BYTE:case _e.fieldTypes.ASCII:case _e.fieldTypes.UNDEFINED:i=new Uint8Array(r),o=e.readUint8;break;case _e.fieldTypes.SBYTE:i=new Int8Array(r),o=e.readInt8;break;case _e.fieldTypes.SHORT:i=new Uint16Array(r),o=e.readUint16;break;case _e.fieldTypes.SSHORT:i=new Int16Array(r),o=e.readInt16;break;case _e.fieldTypes.LONG:case _e.fieldTypes.IFD:i=new Uint32Array(r),o=e.readUint32;break;case _e.fieldTypes.SLONG:i=new Int32Array(r),o=e.readInt32;break;case _e.fieldTypes.LONG8:case _e.fieldTypes.IFD8:i=new Array(r),o=e.readUint64;break;case _e.fieldTypes.SLONG8:i=new Array(r),o=e.readInt64;break;case _e.fieldTypes.RATIONAL:i=new Uint32Array(2*r),o=e.readUint32;break;case _e.fieldTypes.SRATIONAL:i=new Int32Array(2*r),o=e.readInt32;break;case _e.fieldTypes.FLOAT:i=new Float32Array(r),o=e.readFloat32;break;case _e.fieldTypes.DOUBLE:i=new Float64Array(r),o=e.readFloat64;break;default:throw new RangeError("Invalid field type: ".concat(t))}if(t!==_e.fieldTypes.RATIONAL&&t!==_e.fieldTypes.SRATIONAL)for(var s=0;s<r;++s)i[s]=o.call(e,n+s*a);else for(var u=0;u<r;u+=2)i[u]=o.call(e,n+u*a),i[u+1]=o.call(e,n+(u*a+4));return t===_e.fieldTypes.ASCII?new TextDecoder("utf-8").decode(i):i}var Wr=(0,p.Z)((function e(t,r,n){(0,m.Z)(this,e),this.fileDirectory=t,this.geoKeyDirectory=r,this.nextIFDByteOffset=n})),Hr=function(e){(0,s.Z)(r,e);var t=zr(r);function r(e){var n;return(0,m.Z)(this,r),(n=t.call(this,"No image at index ".concat(e))).index=e,n}return(0,p.Z)(r)}(d(Error)),qr=function(){function e(){(0,m.Z)(this,e)}var t;return(0,p.Z)(e,[{key:"readRasters",value:(t=(0,a.Z)(y().mark((function e(){var t,r,n,i,a,s,u,l,c,f,h,d,p,m,v,g,b,w,_,x,T,E,k,S,A,R,C,P,D,O,M,I,L,Z,U,F,G,j,B,N=arguments;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=N.length>0&&void 0!==N[0]?N[0]:{},r=t.window,n=t.width,i=t.height,a=t.resX,s=t.resY,u=t.bbox,e.next=5,this.getImage();case 5:return l=e.sent,c=l,e.next=9,this.getImageCount();case 9:if(f=e.sent,h=l.getBoundingBox(),!r||!u){e.next=13;break}throw new Error('Both "bbox" and "window" passed.');case 13:if(!n&&!i){e.next=24;break}if(r&&(d=l.getOrigin(),p=(0,o.Z)(d,2),m=p[0],v=p[1],g=l.getResolution(),b=(0,o.Z)(g,2),w=b[0],_=b[1],u=[m+r[0]*w,v+r[1]*_,m+r[2]*w,v+r[3]*_]),x=u||h,!n){e.next=20;break}if(!a){e.next=19;break}throw new Error("Both width and resX passed");case 19:a=(x[2]-x[0])/n;case 20:if(!i){e.next=24;break}if(!s){e.next=23;break}throw new Error("Both width and resY passed");case 23:s=(x[3]-x[1])/i;case 24:if(!a&&!s){e.next=48;break}T=[],E=0;case 27:if(!(E<f)){e.next=36;break}return e.next=30,this.getImage(E);case 30:k=e.sent,S=k.fileDirectory,A=S.SubfileType,R=S.NewSubfileType,(0===E||2===A||1&R)&&T.push(k);case 33:++E,e.next=27;break;case 36:T.sort((function(e,t){return e.getWidth()-t.getWidth()})),C=0;case 38:if(!(C<T.length)){e.next=48;break}if(P=T[C],D=(h[2]-h[0])/P.getWidth(),O=(h[3]-h[1])/P.getHeight(),c=P,!(a&&a>D||s&&s>O)){e.next=45;break}return e.abrupt("break",48);case 45:++C,e.next=38;break;case 48:return M=r,u&&(I=l.getOrigin(),L=(0,o.Z)(I,2),Z=L[0],U=L[1],F=c.getResolution(l),G=(0,o.Z)(F,2),j=G[0],B=G[1],M=[Math.round((u[0]-Z)/j),Math.round((u[1]-U)/B),Math.round((u[2]-Z)/j),Math.round((u[3]-U)/B)],M=[Math.min(M[0],M[2]),Math.min(M[1],M[3]),Math.max(M[0],M[2]),Math.max(M[1],M[3])]),e.abrupt("return",c.readRasters(Nr(Nr({},t),{},{window:M})));case 51:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),Xr=function(e){(0,s.Z)(h,e);var t,r,n,i,u,l,c,f=zr(h);function h(e,t,r,n){var i,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return(0,m.Z)(this,h),(i=f.call(this)).source=e,i.littleEndian=t,i.bigTiff=r,i.firstIFDOffset=n,i.cache=o.cache||!1,i.ifdRequests=[],i.ghostValues=null,i}return(0,p.Z)(h,[{key:"getSlice",value:(c=(0,a.Z)(y().mark((function e(t,r){var n;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.bigTiff?4048:1024,e.t0=We,e.next=4,this.source.fetch([{offset:t,length:void 0!==r?r:n}]);case 4:return e.t1=e.sent[0],e.t2=t,e.t3=this.littleEndian,e.t4=this.bigTiff,e.abrupt("return",new e.t0(e.t1,e.t2,e.t3,e.t4));case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return c.apply(this,arguments)})},{key:"parseFileDirectoryAt",value:(l=(0,a.Z)(y().mark((function e(t){var r,n,i,o,a,s,u,l,c,f,h,d,p,m,v,g,b,w,_,x;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.bigTiff?20:12,n=this.bigTiff?8:2,e.next=4,this.getSlice(t);case 4:if(i=e.sent,o=this.bigTiff?i.readUint64(t):i.readUint16(t),a=o*r+(this.bigTiff?16:6),i.covers(t,a)){e.next=11;break}return e.next=10,this.getSlice(t,a);case 10:i=e.sent;case 11:s={},u=t+(this.bigTiff?8:2),l=0;case 14:if(!(l<o)){e.next=41;break}if(c=i.readUint16(u),f=i.readUint16(u+2),h=this.bigTiff?i.readUint64(u+4):i.readUint32(u+4),d=void 0,p=void 0,m=Vr(f),v=u+(this.bigTiff?12:8),!(m*h<=(this.bigTiff?8:4))){e.next=26;break}d=Kr(i,f,h,v),e.next=36;break;case 26:if(g=i.readOffset(v),b=Vr(f)*h,!i.covers(g,b)){e.next=32;break}d=Kr(i,f,h,g),e.next=36;break;case 32:return e.next=34,this.getSlice(g,b);case 34:w=e.sent,d=Kr(w,f,h,g);case 36:p=1===h&&-1===_e.arrayFields.indexOf(c)&&f!==_e.fieldTypes.RATIONAL&&f!==_e.fieldTypes.SRATIONAL?d[0]:d,s[_e.fieldTagNames[c]]=p;case 38:u+=r,++l,e.next=14;break;case 41:return _=$r(s),x=i.readOffset(t+n+r*o),e.abrupt("return",new Wr(s,_,x));case 44:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"requestIFD",value:(u=(0,a.Z)(y().mark((function e(t){var r=this;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.ifdRequests[t]){e.next=4;break}return e.abrupt("return",this.ifdRequests[t]);case 4:if(0!==t){e.next=9;break}return this.ifdRequests[t]=this.parseFileDirectoryAt(this.firstIFDOffset),e.abrupt("return",this.ifdRequests[t]);case 9:if(this.ifdRequests[t-1]){e.next=19;break}e.prev=10,this.ifdRequests[t-1]=this.requestIFD(t-1),e.next=19;break;case 14:if(e.prev=14,e.t0=e.catch(10),!(e.t0 instanceof Hr)){e.next=18;break}throw new Hr(t);case 18:throw e.t0;case 19:return this.ifdRequests[t]=(0,a.Z)(y().mark((function e(){var n;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.ifdRequests[t-1];case 2:if(0!==(n=e.sent).nextIFDByteOffset){e.next=5;break}throw new Hr(t);case 5:return e.abrupt("return",r.parseFileDirectoryAt(n.nextIFDByteOffset));case 6:case"end":return e.stop()}}),e)})))(),e.abrupt("return",this.ifdRequests[t]);case 21:case"end":return e.stop()}}),e,this,[[10,14]])}))),function(e){return u.apply(this,arguments)})},{key:"getImage",value:(i=(0,a.Z)(y().mark((function e(){var t,r,n=arguments;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:0,e.next=3,this.requestIFD(t);case 3:return r=e.sent,e.abrupt("return",new $e(r.fileDirectory,r.geoKeyDirectory,this.dataView,this.littleEndian,this.cache,this.source));case 5:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"getImageCount",value:(n=(0,a.Z)(y().mark((function e(){var t,r;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=0,r=!0;case 2:if(!r){e.next=18;break}return e.prev=3,e.next=6,this.requestIFD(t);case 6:++t,e.next=16;break;case 9:if(e.prev=9,e.t0=e.catch(3),!(e.t0 instanceof Hr)){e.next=15;break}r=!1,e.next=16;break;case 15:throw e.t0;case 16:e.next=2;break;case 18:return e.abrupt("return",t);case 19:case"end":return e.stop()}}),e,this,[[3,9]])}))),function(){return n.apply(this,arguments)})},{key:"getGhostValues",value:(r=(0,a.Z)(y().mark((function e(){var t,r,n,i,a,s,u,l,c=this;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.bigTiff?16:8,!this.ghostValues){e.next=3;break}return e.abrupt("return",this.ghostValues);case 3:return n=(r="GDAL_STRUCTURAL_METADATA_SIZE=").length+100,e.next=7,this.getSlice(t,n);case 7:if(i=e.sent,r!==Kr(i,_e.fieldTypes.ASCII,r.length,t)){e.next=19;break}if(a=Kr(i,_e.fieldTypes.ASCII,n,t),s=a.split("\n")[0],!((u=Number(s.split("=")[1].split(" ")[0])+s.length)>n)){e.next=16;break}return e.next=15,this.getSlice(t,u);case 15:i=e.sent;case 16:l=Kr(i,_e.fieldTypes.ASCII,u,t),this.ghostValues={},l.split("\n").filter((function(e){return e.length>0})).map((function(e){return e.split("=")})).forEach((function(e){var t=(0,o.Z)(e,2),r=t[0],n=t[1];c.ghostValues[r]=n}));case 19:return e.abrupt("return",this.ghostValues);case 20:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"close",value:function(){return"function"==typeof this.source.close&&this.source.close()}}],[{key:"fromSource",value:(t=(0,a.Z)(y().mark((function e(t,r,n){var i,o,a,s,u,l,c;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.fetch([{offset:0,length:1024}],n);case 2:if(i=e.sent[0],o=new Ke(i),18761!==(a=o.getUint16(0,0))){e.next=9;break}s=!0,e.next=14;break;case 9:if(19789!==a){e.next=13;break}s=!1,e.next=14;break;case 13:throw new TypeError("Invalid byte order value.");case 14:if(42!==(u=o.getUint16(2,s))){e.next=19;break}l=!1,e.next=27;break;case 19:if(43!==u){e.next=26;break}if(l=!0,8===o.getUint16(4,s)){e.next=24;break}throw new Error("Unsupported offset byte-size.");case 24:e.next=27;break;case 26:throw new TypeError("Invalid magic number.");case 27:return c=l?o.getUint64(8,s):o.getUint32(4,s),e.abrupt("return",new h(t,s,l,c,r));case 29:case"end":return e.stop()}}),e)}))),function(e,r,n){return t.apply(this,arguments)})}]),h}(qr),Yr=Xr,Qr=function(e){(0,s.Z)(o,e);var t,r,n,i=zr(o);function o(e,t){var r;return(0,m.Z)(this,o),(r=i.call(this)).mainFile=e,r.overviewFiles=t,r.imageFiles=[e].concat(t),r.fileDirectoriesPerFile=null,r.fileDirectoriesPerFileParsing=null,r.imageCount=null,r}return(0,p.Z)(o,[{key:"parseFileDirectoriesPerFile",value:(n=(0,a.Z)(y().mark((function e(){var t;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[this.mainFile.parseFileDirectoryAt(this.mainFile.firstIFDOffset)].concat(this.overviewFiles.map((function(e){return e.parseFileDirectoryAt(e.firstIFDOffset)}))),e.next=3,Promise.all(t);case 3:return this.fileDirectoriesPerFile=e.sent,e.abrupt("return",this.fileDirectoriesPerFile);case 5:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"getImage",value:(r=(0,a.Z)(y().mark((function e(){var t,r,n,i,o,a,s,u=arguments;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:0,e.next=3,this.getImageCount();case 3:return e.next=5,this.parseFileDirectoriesPerFile();case 5:r=0,n=0,i=0;case 8:if(!(i<this.imageFiles.length)){e.next=26;break}o=this.imageFiles[i],a=0;case 11:if(!(a<this.imageCounts[i])){e.next=22;break}if(t!==r){e.next=17;break}return e.next=15,o.requestIFD(n);case 15:return s=e.sent,e.abrupt("return",new $e(s.fileDirectory,s.geoKeyDirectory,o.dataView,o.littleEndian,o.cache,o.source));case 17:r++,n++;case 19:a++,e.next=11;break;case 22:n=0;case 23:i++,e.next=8;break;case 26:throw new RangeError("Invalid image index");case 27:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"getImageCount",value:(t=(0,a.Z)(y().mark((function e(){var t;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===this.imageCount){e.next=2;break}return e.abrupt("return",this.imageCount);case 2:return t=[this.mainFile.getImageCount()].concat(this.overviewFiles.map((function(e){return e.getImageCount()}))),e.next=5,Promise.all(t);case 5:return this.imageCounts=e.sent,this.imageCount=this.imageCounts.reduce((function(e,t){return e+t}),0),e.abrupt("return",this.imageCount);case 8:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),o}(qr);function Jr(e){return en.apply(this,arguments)}function en(){return en=(0,a.Z)(y().mark((function e(t){var r,n,i=arguments;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>1&&void 0!==i[1]?i[1]:{},n=i.length>2?i[2]:void 0,e.abrupt("return",Xr.fromSource(pr(t,r),n));case 3:case"end":return e.stop()}}),e)}))),en.apply(this,arguments)}function tn(e,t){return rn.apply(this,arguments)}function rn(){return(rn=(0,a.Z)(y().mark((function e(t,r){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Xr.fromSource(yr(t),r));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function nn(e,t){return on.apply(this,arguments)}function on(){return(on=(0,a.Z)(y().mark((function e(t,r){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Xr.fromSource(Ar(t),r));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function an(e,t){return sn.apply(this,arguments)}function sn(){return(sn=(0,a.Z)(y().mark((function e(t,r){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Xr.fromSource(wr(t),r));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function un(e){return ln.apply(this,arguments)}function ln(){return ln=(0,a.Z)(y().mark((function e(t){var r,n,i,o,a,s=arguments;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>1&&void 0!==s[1]?s[1]:[],n=s.length>2&&void 0!==s[2]?s[2]:{},i=s.length>3?s[3]:void 0,e.next=5,Xr.fromSource(pr(t,n),i);case 5:return o=e.sent,e.next=8,Promise.all(r.map((function(e){return Xr.fromSource(pr(e,n))})));case 8:return a=e.sent,e.abrupt("return",new Qr(o,a));case 10:case"end":return e.stop()}}),e)}))),ln.apply(this,arguments)}function cn(e,t){return fn.apply(this,arguments)}function fn(){return(fn=(0,a.Z)(y().mark((function e(t,r){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Fr(t,r));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},5383:function(e,t,r){"use strict";r.r(t),r.d(t,{fieldTagNames:function(){return n},fieldTags:function(){return i},fieldTagTypes:function(){return a},arrayFields:function(){return s},fieldTypeNames:function(){return u},fieldTypes:function(){return l},photometricInterpretations:function(){return f},ExtraSamplesValues:function(){return h},LercParameters:function(){return d},LercAddCompression:function(){return p},geoKeyNames:function(){return m},geoKeys:function(){return v}});var n={315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",259:"Compression",33432:"Copyright",306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",273:"StripOffsets",255:"SubfileType",263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",322:"TileWidth",301:"TransferFunction",318:"WhitePoint",344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",37510:"UserComment",33723:"IPTC",34675:"ICC Profile",700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop",33550:"ModelPixelScale",33922:"ModelTiepoint",34264:"ModelTransformation",34735:"GeoKeyDirectory",34736:"GeoDoubleParams",34737:"GeoAsciiParams",50674:"LercParameters"},i={};for(var o in n)n.hasOwnProperty(o)&&(i[n[o]]=parseInt(o,10));var a={256:"SHORT",257:"SHORT",258:"SHORT",259:"SHORT",262:"SHORT",273:"LONG",274:"SHORT",277:"SHORT",278:"LONG",279:"LONG",282:"RATIONAL",283:"RATIONAL",284:"SHORT",286:"SHORT",287:"RATIONAL",296:"SHORT",297:"SHORT",305:"ASCII",306:"ASCII",338:"SHORT",339:"SHORT",513:"LONG",514:"LONG",1024:"SHORT",1025:"SHORT",2048:"SHORT",2049:"ASCII",3072:"SHORT",3073:"ASCII",33550:"DOUBLE",33922:"DOUBLE",34665:"LONG",34735:"SHORT",34737:"ASCII",42113:"ASCII"},s=[i.BitsPerSample,i.ExtraSamples,i.SampleFormat,i.StripByteCounts,i.StripOffsets,i.StripRowCounts,i.TileByteCounts,i.TileOffsets,i.SubIFDs],u={1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",10:"SRATIONAL",11:"FLOAT",12:"DOUBLE",13:"IFD",16:"LONG8",17:"SLONG8",18:"IFD8"},l={};for(var c in u)u.hasOwnProperty(c)&&(l[u[c]]=parseInt(c,10));var f={WhiteIsZero:0,BlackIsZero:1,RGB:2,Palette:3,TransparencyMask:4,CMYK:5,YCbCr:6,CIELab:8,ICCLab:9},h={Unspecified:0,Assocalpha:1,Unassalpha:2},d={Version:0,AddCompression:1},p={None:0,Deflate:1},m={1024:"GTModelTypeGeoKey",1025:"GTRasterTypeGeoKey",1026:"GTCitationGeoKey",2048:"GeographicTypeGeoKey",2049:"GeogCitationGeoKey",2050:"GeogGeodeticDatumGeoKey",2051:"GeogPrimeMeridianGeoKey",2052:"GeogLinearUnitsGeoKey",2053:"GeogLinearUnitSizeGeoKey",2054:"GeogAngularUnitsGeoKey",2055:"GeogAngularUnitSizeGeoKey",2056:"GeogEllipsoidGeoKey",2057:"GeogSemiMajorAxisGeoKey",2058:"GeogSemiMinorAxisGeoKey",2059:"GeogInvFlatteningGeoKey",2060:"GeogAzimuthUnitsGeoKey",2061:"GeogPrimeMeridianLongGeoKey",2062:"GeogTOWGS84GeoKey",3072:"ProjectedCSTypeGeoKey",3073:"PCSCitationGeoKey",3074:"ProjectionGeoKey",3075:"ProjCoordTransGeoKey",3076:"ProjLinearUnitsGeoKey",3077:"ProjLinearUnitSizeGeoKey",3078:"ProjStdParallel1GeoKey",3079:"ProjStdParallel2GeoKey",3080:"ProjNatOriginLongGeoKey",3081:"ProjNatOriginLatGeoKey",3082:"ProjFalseEastingGeoKey",3083:"ProjFalseNorthingGeoKey",3084:"ProjFalseOriginLongGeoKey",3085:"ProjFalseOriginLatGeoKey",3086:"ProjFalseOriginEastingGeoKey",3087:"ProjFalseOriginNorthingGeoKey",3088:"ProjCenterLongGeoKey",3089:"ProjCenterLatGeoKey",3090:"ProjCenterEastingGeoKey",3091:"ProjCenterNorthingGeoKey",3092:"ProjScaleAtNatOriginGeoKey",3093:"ProjScaleAtCenterGeoKey",3094:"ProjAzimuthAngleGeoKey",3095:"ProjStraightVertPoleLongGeoKey",3096:"ProjRectifiedGridAngleGeoKey",4096:"VerticalCSTypeGeoKey",4097:"VerticalCitationGeoKey",4098:"VerticalDatumGeoKey",4099:"VerticalUnitsGeoKey"},v={};for(var y in m)m.hasOwnProperty(y)&&(v[m[y]]=parseInt(y,10))},6528:function(e){"use strict";e.exports=function(e){return!!e&&("symbol"==typeof Symbol.observable&&"function"==typeof e[Symbol.observable]?e===e[Symbol.observable]():"function"==typeof e["@@observable"]&&e===e["@@observable"]())}},5660:function(e,t,r){"use strict";var n=r(4575),i=r(3913),o=r(6793),a=Symbol("max"),s=Symbol("length"),u=Symbol("lengthCalculator"),l=Symbol("allowStale"),c=Symbol("maxAge"),f=Symbol("dispose"),h=Symbol("noDisposeOnSet"),d=Symbol("lruList"),p=Symbol("cache"),m=Symbol("updateAgeOnGet"),v=function(){return 1},y=function(){function e(t){if(n(this,e),"number"==typeof t&&(t={max:t}),t||(t={}),t.max&&("number"!=typeof t.max||t.max<0))throw new TypeError("max must be a non-negative number");this[a]=t.max||1/0;var r=t.length||v;if(this[u]="function"!=typeof r?v:r,this[l]=t.stale||!1,t.maxAge&&"number"!=typeof t.maxAge)throw new TypeError("maxAge must be a number");this[c]=t.maxAge||0,this[f]=t.dispose,this[h]=t.noDisposeOnSet||!1,this[m]=t.updateAgeOnGet||!1,this.reset()}return i(e,[{key:"max",get:function(){return this[a]},set:function(e){if("number"!=typeof e||e<0)throw new TypeError("max must be a non-negative number");this[a]=e||1/0,w(this)}},{key:"allowStale",get:function(){return this[l]},set:function(e){this[l]=!!e}},{key:"maxAge",get:function(){return this[c]},set:function(e){if("number"!=typeof e)throw new TypeError("maxAge must be a non-negative number");this[c]=e,w(this)}},{key:"lengthCalculator",get:function(){return this[u]},set:function(e){var t=this;"function"!=typeof e&&(e=v),e!==this[u]&&(this[u]=e,this[s]=0,this[d].forEach((function(e){e.length=t[u](e.value,e.key),t[s]+=e.length}))),w(this)}},{key:"length",get:function(){return this[s]}},{key:"itemCount",get:function(){return this[d].length}},{key:"rforEach",value:function(e,t){t=t||this;for(var r=this[d].tail;null!==r;){var n=r.prev;T(this,e,r,t),r=n}}},{key:"forEach",value:function(e,t){t=t||this;for(var r=this[d].head;null!==r;){var n=r.next;T(this,e,r,t),r=n}}},{key:"keys",value:function(){return this[d].toArray().map((function(e){return e.key}))}},{key:"values",value:function(){return this[d].toArray().map((function(e){return e.value}))}},{key:"reset",value:function(){var e=this;this[f]&&this[d]&&this[d].length&&this[d].forEach((function(t){return e[f](t.key,t.value)})),this[p]=new Map,this[d]=new o,this[s]=0}},{key:"dump",value:function(){var e=this;return this[d].map((function(t){return!b(e,t)&&{k:t.key,v:t.value,e:t.now+(t.maxAge||0)}})).toArray().filter((function(e){return e}))}},{key:"dumpLru",value:function(){return this[d]}},{key:"set",value:function(e,t,r){if((r=r||this[c])&&"number"!=typeof r)throw new TypeError("maxAge must be a number");var n=r?Date.now():0,i=this[u](t,e);if(this[p].has(e)){if(i>this[a])return _(this,this[p].get(e)),!1;var o=this[p].get(e).value;return this[f]&&(this[h]||this[f](e,o.value)),o.now=n,o.maxAge=r,o.value=t,this[s]+=i-o.length,o.length=i,this.get(e),w(this),!0}var l=new x(e,t,i,n,r);return l.length>this[a]?(this[f]&&this[f](e,t),!1):(this[s]+=l.length,this[d].unshift(l),this[p].set(e,this[d].head),w(this),!0)}},{key:"has",value:function(e){if(!this[p].has(e))return!1;var t=this[p].get(e).value;return!b(this,t)}},{key:"get",value:function(e){return g(this,e,!0)}},{key:"peek",value:function(e){return g(this,e,!1)}},{key:"pop",value:function(){var e=this[d].tail;return e?(_(this,e),e.value):null}},{key:"del",value:function(e){_(this,this[p].get(e))}},{key:"load",value:function(e){this.reset();for(var t=Date.now(),r=e.length-1;r>=0;r--){var n=e[r],i=n.e||0;if(0===i)this.set(n.k,n.v);else{var o=i-t;o>0&&this.set(n.k,n.v,o)}}}},{key:"prune",value:function(){var e=this;this[p].forEach((function(t,r){return g(e,r,!1)}))}}]),e}(),g=function(e,t,r){var n=e[p].get(t);if(n){var i=n.value;if(b(e,i)){if(_(e,n),!e[l])return}else r&&(e[m]&&(n.value.now=Date.now()),e[d].unshiftNode(n));return i.value}},b=function(e,t){if(!t||!t.maxAge&&!e[c])return!1;var r=Date.now()-t.now;return t.maxAge?r>t.maxAge:e[c]&&r>e[c]},w=function(e){if(e[s]>e[a])for(var t=e[d].tail;e[s]>e[a]&&null!==t;){var r=t.prev;_(e,t),t=r}},_=function(e,t){if(t){var r=t.value;e[f]&&e[f](r.key,r.value),e[s]-=r.length,e[p].delete(r.key),e[d].removeNode(t)}},x=i((function e(t,r,i,o,a){n(this,e),this.key=t,this.value=r,this.length=i,this.now=o,this.maxAge=a||0})),T=function(e,t,r,n){var i=r.value;b(e,i)&&(_(e,r),e[l]||(i=void 0)),i&&t.call(n,i.value,i.key,e)};e.exports=y},3363:function(e,t,r){"use strict";var n=r(7757);e.exports=function(e){e.prototype[Symbol.iterator]=n.mark((function e(){var t;return n.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.head;case 1:if(!t){e.next=7;break}return e.next=4,t.value;case 4:t=t.next,e.next=1;break;case 7:case"end":return e.stop()}}),e,this)}))}},6793:function(e,t,r){"use strict";function n(e){var t=this;if(t instanceof n||(t=new n),t.tail=null,t.head=null,t.length=0,e&&"function"==typeof e.forEach)e.forEach((function(e){t.push(e)}));else if(arguments.length>0)for(var r=0,i=arguments.length;r<i;r++)t.push(arguments[r]);return t}function i(e,t,r){var n=t===e.head?new s(r,null,t,e):new s(r,t,t.next,e);return null===n.next&&(e.tail=n),null===n.prev&&(e.head=n),e.length++,n}function o(e,t){e.tail=new s(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function a(e,t){e.head=new s(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function s(e,t,r,n){if(!(this instanceof s))return new s(e,t,r,n);this.list=n,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,r?(r.prev=this,this.next=r):this.next=null}e.exports=n,n.Node=s,n.create=n,n.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,r=e.prev;return t&&(t.prev=r),r&&(r.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=r),e.list.length--,e.next=null,e.prev=null,e.list=null,t},n.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},n.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},n.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)o(this,arguments[e]);return this.length},n.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)a(this,arguments[e]);return this.length},n.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},n.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},n.prototype.forEach=function(e,t){t=t||this;for(var r=this.head,n=0;null!==r;n++)e.call(t,r.value,n,this),r=r.next},n.prototype.forEachReverse=function(e,t){t=t||this;for(var r=this.tail,n=this.length-1;null!==r;n--)e.call(t,r.value,n,this),r=r.prev},n.prototype.get=function(e){for(var t=0,r=this.head;null!==r&&t<e;t++)r=r.next;if(t===e&&null!==r)return r.value},n.prototype.getReverse=function(e){for(var t=0,r=this.tail;null!==r&&t<e;t++)r=r.prev;if(t===e&&null!==r)return r.value},n.prototype.map=function(e,t){t=t||this;for(var r=new n,i=this.head;null!==i;)r.push(e.call(t,i.value,this)),i=i.next;return r},n.prototype.mapReverse=function(e,t){t=t||this;for(var r=new n,i=this.tail;null!==i;)r.push(e.call(t,i.value,this)),i=i.prev;return r},n.prototype.reduce=function(e,t){var r,n=this.head;if(arguments.length>1)r=t;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");n=this.head.next,r=this.head.value}for(var i=0;null!==n;i++)r=e(r,n.value,i),n=n.next;return r},n.prototype.reduceReverse=function(e,t){var r,n=this.tail;if(arguments.length>1)r=t;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");n=this.tail.prev,r=this.tail.value}for(var i=this.length-1;null!==n;i--)r=e(r,n.value,i),n=n.prev;return r},n.prototype.toArray=function(){for(var e=new Array(this.length),t=0,r=this.head;null!==r;t++)e[t]=r.value,r=r.next;return e},n.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,r=this.tail;null!==r;t++)e[t]=r.value,r=r.prev;return e},n.prototype.slice=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var r=new n;if(t<e||t<0)return r;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=0,o=this.head;null!==o&&i<e;i++)o=o.next;for(;null!==o&&i<t;i++,o=o.next)r.push(o.value);return r},n.prototype.sliceReverse=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var r=new n;if(t<e||t<0)return r;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=this.length,o=this.tail;null!==o&&i>t;i--)o=o.prev;for(;null!==o&&i>e;i--,o=o.prev)r.push(o.value);return r},n.prototype.splice=function(e,t){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var r=0,n=this.head;null!==n&&r<e;r++)n=n.next;var o=[];for(r=0;n&&r<t;r++)o.push(n.value),n=this.removeNode(n);null===n&&(n=this.tail),n!==this.head&&n!==this.tail&&(n=n.prev);for(r=0;r<(arguments.length<=2?0:arguments.length-2);r++)n=i(this,n,r+2<2||arguments.length<=r+2?void 0:arguments[r+2]);return o},n.prototype.reverse=function(){for(var e=this.head,t=this.tail,r=e;null!==r;r=r.prev){var n=r.prev;r.prev=r.next,r.next=n}return this.head=t,this.tail=e,this};try{r(3363)(n)}catch(u){}},2801:function(e,t,r){"use strict";r.r(t),r.d(t,{Observable:function(){return D},Subject:function(){return q},filter:function(){return I},flatMap:function(){return F},interval:function(){return G},map:function(){return B},merge:function(){return N},multicast:function(){return X},scan:function(){return Q},unsubscribe:function(){return O}});var n=r(7757),i=r.n(n),o=r(5671),a=r(3144);function s(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return u(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return u(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var l=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(t){o(t)}}function s(e){try{u(n.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))},c=function(){function e(t){(0,o.Z)(this,e),this._baseObserver=t,this._pendingPromises=new Set}return(0,a.Z)(e,[{key:"complete",value:function(){var e=this;Promise.all(this._pendingPromises).then((function(){return e._baseObserver.complete()})).catch((function(t){return e._baseObserver.error(t)}))}},{key:"error",value:function(e){this._baseObserver.error(e)}},{key:"schedule",value:function(e){var t=this,r=Promise.all(this._pendingPromises),n=[],o=function(e){return n.push(e)},a=Promise.resolve().then((function(){return l(t,void 0,void 0,i().mark((function t(){var u,l,c;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r;case 2:return t.next=4,e(o);case 4:this._pendingPromises.delete(a),u=s(n);try{for(u.s();!(l=u.n()).done;)c=l.value,this._baseObserver.next(c)}catch(i){u.e(i)}finally{u.f()}case 7:case"end":return t.stop()}}),t,this)})))})).catch((function(e){t._pendingPromises.delete(a),t._baseObserver.error(e)}));this._pendingPromises.add(a)}}]),e}(),f=function(){return"function"==typeof Symbol},h=function(e){return f()&&Boolean(Symbol[e])},d=function(e){return h(e)?Symbol[e]:"@@"+e};function p(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return m(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return m(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}h("asyncIterator")||(Symbol.asyncIterator=Symbol.asyncIterator||Symbol.for("Symbol.asyncIterator"));var v=d("iterator"),y=d("observable"),g=d("species");function b(e,t){var r=e[t];if(null!=r){if("function"!=typeof r)throw new TypeError(r+" is not a function");return r}}function w(e){var t=e.constructor;return void 0!==t&&null===(t=t[g])&&(t=void 0),void 0!==t?t:P}function _(e){return e instanceof P}function x(e){x.log?x.log(e):setTimeout((function(){throw e}),0)}function T(e){Promise.resolve().then((function(){try{e()}catch(t){x(t)}}))}function E(e){var t=e._cleanup;if(void 0!==t&&(e._cleanup=void 0,t))try{if("function"==typeof t)t();else{var r=b(t,"unsubscribe");r&&r.call(t)}}catch(n){x(n)}}function k(e){e._observer=void 0,e._queue=void 0,e._state="closed"}function S(e,t,r){e._state="running";var n=e._observer;try{var i=n?b(n,t):void 0;switch(t){case"next":i&&i.call(n,r);break;case"error":if(k(e),!i)throw r;i.call(n,r);break;case"complete":k(e),i&&i.call(n)}}catch(o){x(o)}"closed"===e._state?E(e):"running"===e._state&&(e._state="ready")}function A(e,t,r){if("closed"!==e._state)return"buffering"===e._state?(e._queue=e._queue||[],void e._queue.push({type:t,value:r})):"ready"!==e._state?(e._state="buffering",e._queue=[{type:t,value:r}],void T((function(){return function(e){var t=e._queue;if(t){e._queue=void 0,e._state="ready";var r,n=p(t);try{for(n.s();!(r=n.n()).done;){var i=r.value;if(S(e,i.type,i.value),"closed"===e._state)break}}catch(o){n.e(o)}finally{n.f()}}}(e)}))):void S(e,t,r)}var R=function(){function e(t,r){(0,o.Z)(this,e),this._cleanup=void 0,this._observer=t,this._queue=void 0,this._state="initializing";var n=new C(this);try{this._cleanup=r.call(void 0,n)}catch(i){n.error(i)}"initializing"===this._state&&(this._state="ready")}return(0,a.Z)(e,[{key:"closed",get:function(){return"closed"===this._state}},{key:"unsubscribe",value:function(){"closed"!==this._state&&(k(this),E(this))}}]),e}(),C=function(){function e(t){(0,o.Z)(this,e),this._subscription=t}return(0,a.Z)(e,[{key:"closed",get:function(){return"closed"===this._subscription._state}},{key:"next",value:function(e){A(this._subscription,"next",e)}},{key:"error",value:function(e){A(this._subscription,"error",e)}},{key:"complete",value:function(){A(this._subscription,"complete")}}]),e}(),P=function(e){function t(e){if((0,o.Z)(this,t),!(this instanceof t))throw new TypeError("Observable cannot be called as a function");if("function"!=typeof e)throw new TypeError("Observable initializer must be a function");this._subscriber=e}return(0,a.Z)(t,[{key:"subscribe",value:function(e,t,r){return"object"==typeof e&&null!==e||(e={next:e,error:t,complete:r}),new R(e,this._subscriber)}},{key:"pipe",value:function(e){for(var t=this,r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];for(var o=0,a=[e].concat(n);o<a.length;o++){var s=a[o];t=s(t)}return t}},{key:"tap",value:function(e,r,n){var i=this,o="object"!=typeof e||null===e?{next:e,error:r,complete:n}:e;return new t((function(e){return i.subscribe({next:function(t){o.next&&o.next(t),e.next(t)},error:function(t){o.error&&o.error(t),e.error(t)},complete:function(){o.complete&&o.complete(),e.complete()},start:function(e){o.start&&o.start(e)}})}))}},{key:"forEach",value:function(e){var t=this;return new Promise((function(r,n){if("function"==typeof e)var i=t.subscribe({next:function(t){try{e(t,o)}catch(r){n(r),i.unsubscribe()}},error:function(e){n(e)},complete:function(){r(void 0)}});else n(new TypeError(e+" is not a function"));function o(){i.unsubscribe(),r(void 0)}}))}},{key:"map",value:function(e){var t=this;if("function"!=typeof e)throw new TypeError(e+" is not a function");return new(w(this))((function(r){return t.subscribe({next:function(t){var n=t;try{n=e(t)}catch(i){return r.error(i)}r.next(n)},error:function(e){r.error(e)},complete:function(){r.complete()}})}))}},{key:"filter",value:function(e){var t=this;if("function"!=typeof e)throw new TypeError(e+" is not a function");return new(w(this))((function(r){return t.subscribe({next:function(t){try{if(!e(t))return}catch(n){return r.error(n)}r.next(t)},error:function(e){r.error(e)},complete:function(){r.complete()}})}))}},{key:"reduce",value:function(e,t){var r=this;if("function"!=typeof e)throw new TypeError(e+" is not a function");var n=w(this),i=arguments.length>1,o=!1,a=t;return new n((function(t){return r.subscribe({next:function(r){var n=!o;if(o=!0,!n||i)try{a=e(a,r)}catch(s){return t.error(s)}else a=r},error:function(e){t.error(e)},complete:function(){if(!o&&!i)return t.error(new TypeError("Cannot reduce an empty sequence"));t.next(a),t.complete()}})}))}},{key:"concat",value:function(){for(var e=this,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var i=w(this);return new i((function(t){var n,o=0;return function e(a){n=a.subscribe({next:function(e){t.next(e)},error:function(e){t.error(e)},complete:function(){o===r.length?(n=void 0,t.complete()):e(i.from(r[o++]))}})}(e),function(){n&&(n.unsubscribe(),n=void 0)}}))}},{key:"flatMap",value:function(e){var t=this;if("function"!=typeof e)throw new TypeError(e+" is not a function");var r=w(this);return new r((function(n){var i=[],o=t.subscribe({next:function(t){var o;if(e)try{o=e(t)}catch(u){return n.error(u)}else o=t;var s=r.from(o).subscribe({next:function(e){n.next(e)},error:function(e){n.error(e)},complete:function(){var e=i.indexOf(s);e>=0&&i.splice(e,1),a()}});i.push(s)},error:function(e){n.error(e)},complete:function(){a()}});function a(){o.closed&&0===i.length&&n.complete()}return function(){i.forEach((function(e){return e.unsubscribe()})),o.unsubscribe()}}))}},{key:e,value:function(){return this}}],[{key:"from",value:function(e){var r="function"==typeof this?this:t;if(null==e)throw new TypeError(e+" is not an object");var n=b(e,y);if(n){var i=n.call(e);if(Object(i)!==i)throw new TypeError(i+" is not an object");return _(i)&&i.constructor===r?i:new r((function(e){return i.subscribe(e)}))}if(h("iterator")){var o=b(e,v);if(o)return new r((function(t){T((function(){if(!t.closed){var r,n=p(o.call(e));try{for(n.s();!(r=n.n()).done;){var i=r.value;if(t.next(i),t.closed)return}}catch(a){n.e(a)}finally{n.f()}t.complete()}}))}))}if(Array.isArray(e))return new r((function(t){T((function(){if(!t.closed){var r,n=p(e);try{for(n.s();!(r=n.n()).done;){var i=r.value;if(t.next(i),t.closed)return}}catch(o){n.e(o)}finally{n.f()}t.complete()}}))}));throw new TypeError(e+" is not observable")}},{key:"of",value:function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];var i="function"==typeof this?this:t;return new i((function(e){T((function(){if(!e.closed){var t,n=p(r);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(e.next(i),e.closed)return}}catch(o){n.e(o)}finally{n.f()}e.complete()}}))}))}},{key:g,get:function(){return this}}]),t}((Symbol.observable,y));f()&&Object.defineProperty(P,Symbol("extensions"),{value:{symbol:y,hostReportError:x},configurable:!0});var D=P;var O=function(e){"function"==typeof e?e():e&&"function"==typeof e.unsubscribe&&e.unsubscribe()},M=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(t){o(t)}}function s(e){try{u(n.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))};var I=function(e){return function(t){return new D((function(r){var n=new c(r),o=t.subscribe({complete:function(){n.complete()},error:function(e){n.error(e)},next:function(t){var r=this;n.schedule((function(n){return M(r,void 0,void 0,i().mark((function r(){return i().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e(t);case 2:if(!r.sent){r.next=4;break}n(t);case 4:case"end":return r.stop()}}),r)})))}))}});return function(){return O(o)}}))}};function L(e){return e&&h("asyncIterator")&&e[Symbol.asyncIterator]}var Z=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(t){o(t)}}function s(e){try{u(n.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))},U=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,i){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,i,(t=e[r](t)).done,t.value)}))}}};var F=function(e){return function(t){return new D((function(r){var n=new c(r),o=t.subscribe({complete:function(){n.complete()},error:function(e){n.error(e)},next:function(t){var r=this;n.schedule((function(n){return Z(r,void 0,void 0,i().mark((function r(){var o,a,s,u,l,c;return i().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e(t);case 2:if(s=r.sent,!((i=s)&&h("iterator")&&i[Symbol.iterator]||L(s))){r.next=31;break}r.prev=4,u=U(s);case 6:return r.next=8,u.next();case 8:if((l=r.sent).done){r.next=14;break}c=l.value,n(c);case 12:r.next=6;break;case 14:r.next=19;break;case 16:r.prev=16,r.t0=r.catch(4),o={error:r.t0};case 19:if(r.prev=19,r.prev=20,!l||l.done||!(a=u.return)){r.next=24;break}return r.next=24,a.call(u);case 24:if(r.prev=24,!o){r.next=27;break}throw o.error;case 27:return r.finish(24);case 28:return r.finish(19);case 29:r.next=32;break;case 31:s.map((function(e){return n(e)}));case 32:case"end":return r.stop()}var i}),r,null,[[4,16,19,29],[20,,24,28]])})))}))}});return function(){return O(o)}}))}};function G(e){return new P((function(t){var r=0,n=setInterval((function(){t.next(r++)}),e);return function(){return clearInterval(n)}}))}var j=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(t){o(t)}}function s(e){try{u(n.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))};var B=function(e){return function(t){return new D((function(r){var n=new c(r),o=t.subscribe({complete:function(){n.complete()},error:function(e){n.error(e)},next:function(t){var r=this;n.schedule((function(n){return j(r,void 0,void 0,i().mark((function r(){var o;return i().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e(t);case 2:o=r.sent,n(o);case 4:case"end":return r.stop()}}),r)})))}))}});return function(){return O(o)}}))}};var N=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return 0===t.length?P.from([]):new P((function(e){var r=0,n=t.map((function(n){return n.subscribe({error:function(t){e.error(t),i()},next:function(t){e.next(t)},complete:function(){++r===t.length&&(e.complete(),i())}})})),i=function(){n.forEach((function(e){return O(e)}))};return i}))},z=r(136),V=r(6215),$=r(1120);function K(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return W(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return W(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function W(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function H(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,$.Z)(e);if(t){var i=(0,$.Z)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,V.Z)(this,r)}}var q=function(e){(0,z.Z)(r,e);var t=H(r);function r(){var e;return(0,o.Z)(this,r),(e=t.call(this,(function(t){return e._observers.add(t),function(){return e._observers.delete(t)}})))._observers=new Set,e}return(0,a.Z)(r,[{key:"next",value:function(e){var t,r=K(this._observers);try{for(r.s();!(t=r.n()).done;){t.value.next(e)}}catch(n){r.e(n)}finally{r.f()}}},{key:"error",value:function(e){var t,r=K(this._observers);try{for(r.s();!(t=r.n()).done;){t.value.error(e)}}catch(n){r.e(n)}finally{r.f()}}},{key:"complete",value:function(){var e,t=K(this._observers);try{for(t.s();!(e=t.n()).done;){e.value.complete()}}catch(r){t.e(r)}finally{t.f()}}}]),r}(D);var X=function(e){var t,r=new q,n=0;return new D((function(i){t||(t=e.subscribe(r));var o=r.subscribe(i);return n++,function(){n--,o.unsubscribe(),0===n&&(O(t),t=void 0)}}))},Y=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(t){o(t)}}function s(e){try{u(n.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))};var Q=function(e,t){return function(r){return new D((function(n){var o,a=0,s=new c(n),u=r.subscribe({complete:function(){s.complete()},error:function(e){s.error(e)},next:function(r){var n=this;s.schedule((function(s){return Y(n,void 0,void 0,i().mark((function n(){var u;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return u=0===a?void 0===t?r:t:o,n.next=3,e(u,r,a++);case 3:o=n.sent,s(o);case 5:case"end":return n.stop()}}),n)})))}))}});return function(){return O(u)}}))}}},4919:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.serialize=t.deserialize=t.registerSerializer=void 0;var n=r(327),i=n.DefaultSerializer;t.registerSerializer=function(e){i=n.extendSerializer(i,e)},t.deserialize=function(e){return i.deserialize(e)},t.serialize=function(e){return i.serialize(e)}},5626:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.Transfer=t.DefaultSerializer=t.expose=t.registerSerializer=void 0;var o=r(4919);Object.defineProperty(t,"registerSerializer",{enumerable:!0,get:function(){return o.registerSerializer}}),i(r(7864),t);var a=r(771);Object.defineProperty(t,"expose",{enumerable:!0,get:function(){return a.expose}});var s=r(327);Object.defineProperty(t,"DefaultSerializer",{enumerable:!0,get:function(){return s.DefaultSerializer}});var u=r(5314);Object.defineProperty(t,"Transfer",{enumerable:!0,get:function(){return u.Transfer}})},3592:function(e,t){"use strict";var r;function n(e){return(""+e).replace(/^((?:https?|file|ftp|chrome-extension|moz-extension):\/\/.+)?\/[^/]+(?:\?.*)?$/,"$1")+"/"}Object.defineProperty(t,"__esModule",{value:!0}),t.getBundleURL=t.getBaseURL=void 0,t.getBundleURL=function(){return r||(r=function(){try{throw new Error}catch(t){var e=(""+t.stack).match(/(https?|file|ftp|chrome-extension|moz-extension):\/\/[^)\n]+/g);if(e)return n(e[0])}return"/"}()),r},t.getBaseURL=n},736:function(e,t,r){"use strict";var n=r(2205),i=r(8585),o=r(9754),a=r(5957),s=r(3913),u=r(4575);function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=o(e);if(t){var a=o(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return i(this,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.isWorkerRuntime=t.getWorkerImplementation=t.defaultPoolSize=void 0;var c=r(3592);t.defaultPoolSize="undefined"!=typeof navigator&&navigator.hardwareConcurrency?navigator.hardwareConcurrency:4;var f,h=function(e){return/^[a-zA-Z][a-zA-Z\d+\-.]*:/.test(e)};function d(e){var t=new Blob([e],{type:"application/javascript"});return URL.createObjectURL(t)}t.getWorkerImplementation=function(){return f||(f=function(){if("undefined"==typeof Worker)return s((function e(){throw u(this,e),Error("No web worker implementation available. You might have tried to spawn a worker within a worker in a browser that doesn't support workers in workers.")}));var e=function(e){n(r,e);var t=l(r);function r(e,n){var i,o;return u(this,r),"string"==typeof e&&n&&n._baseURL?e=new URL(e,n._baseURL):"string"==typeof e&&!h(e)&&c.getBundleURL().match(/^file:\/\//i)&&(e=new URL(e,c.getBundleURL().replace(/\/[^\/]+$/,"/")),(null===(i=null==n?void 0:n.CORSWorkaround)||void 0===i||i)&&(e=d("importScripts(".concat(JSON.stringify(e),");")))),"string"==typeof e&&h(e)&&(null===(o=null==n?void 0:n.CORSWorkaround)||void 0===o||o)&&(e=d("importScripts(".concat(JSON.stringify(e),");"))),t.call(this,e,n)}return s(r)}(a(Worker));return{blob:function(e){n(r,e);var t=l(r);function r(e,n){u(this,r);var i=window.URL.createObjectURL(e);return t.call(this,i,n)}return s(r,null,[{key:"fromText",value:function(e,t){return new r(new window.Blob([e],{type:"text/javascript"}),t)}}]),r}(e),default:e}}()),f},t.isWorkerRuntime=function(){var e="undefined"!=typeof self&&"undefined"!=typeof Window&&self instanceof Window;return!("undefined"==typeof self||!self.postMessage||e)}},7864:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Worker=t.BlobWorker=t.isWorkerRuntime=t.Thread=t.spawn=t.Pool=void 0;var n=r(736);Object.defineProperty(t,"isWorkerRuntime",{enumerable:!0,get:function(){return n.isWorkerRuntime}});var i=r(289);Object.defineProperty(t,"Pool",{enumerable:!0,get:function(){return i.Pool}});var o=r(7365);Object.defineProperty(t,"spawn",{enumerable:!0,get:function(){return o.spawn}});var a=r(5897);Object.defineProperty(t,"Thread",{enumerable:!0,get:function(){return a.Thread}}),t.BlobWorker=n.getWorkerImplementation().blob,t.Worker=n.getWorkerImplementation().default},6177:function(e,t,r){"use strict";var n=r(319);function i(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(u)throw a}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.createProxyModule=t.createProxyFunction=void 0;var s=a(r(6157)),u=r(2801),l=r(4919),c=r(684),f=r(5314),h=r(3226),d=s.default("threads:master:messages"),p=1;function m(e,t){return new u.Observable((function(r){var n,i=function i(o){var a;if(d("Message from worker:",o.data),o.data&&o.data.uid===t)if((a=o.data)&&a.type===h.WorkerMessageType.running)n=o.data.resultType;else if(function(e){return e&&e.type===h.WorkerMessageType.result}(o.data))"promise"===n?(void 0!==o.data.payload&&r.next(l.deserialize(o.data.payload)),r.complete(),e.removeEventListener("message",i)):(o.data.payload&&r.next(l.deserialize(o.data.payload)),o.data.complete&&(r.complete(),e.removeEventListener("message",i)));else if(function(e){return e&&e.type===h.WorkerMessageType.error}(o.data)){var s=l.deserialize(o.data.error);r.error(s),e.removeEventListener("message",i)}};return e.addEventListener("message",i),function(){if("observable"===n||!n){var r={type:h.MasterMessageType.cancel,uid:t};e.postMessage(r)}e.removeEventListener("message",i)}}))}function v(e){if(0===e.length)return{args:[],transferables:[]};var t,r,o=[],a=[],s=i(e);try{for(s.s();!(t=s.n()).done;){var u=t.value;f.isTransferDescriptor(u)?(o.push(l.serialize(u.send)),a.push.apply(a,n(u.transferables))):o.push(l.serialize(u))}}catch(c){s.e(c)}finally{s.f()}return{args:o,transferables:0===a.length?a:(r=a,Array.from(new Set(r)))}}function y(e,t){return function(){for(var r=p++,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];var a=v(i),s=a.args,l=a.transferables,f={type:h.MasterMessageType.run,uid:r,method:t,args:s};d("Sending command to run function to worker:",f);try{e.postMessage(f,l)}catch(y){return c.ObservablePromise.from(Promise.reject(y))}return c.ObservablePromise.from(u.multicast(m(e,r)))}}t.createProxyFunction=y,t.createProxyModule=function(e,t){var r,n={},o=i(t);try{for(o.s();!(r=o.n()).done;){var a=r.value;n[a]=y(e,a)}}catch(s){o.e(s)}finally{o.f()}return n}},6552:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PoolEventType=void 0,function(e){e.initialized="initialized",e.taskCanceled="taskCanceled",e.taskCompleted="taskCompleted",e.taskFailed="taskFailed",e.taskQueued="taskQueued",e.taskQueueDrained="taskQueueDrained",e.taskStart="taskStart",e.terminated="terminated"}(t.PoolEventType||(t.PoolEventType={}))},289:function(e,t,r){"use strict";var n=r(7757),i=r(4575),o=r(3913),a=r(319),s=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(t){o(t)}}function s(e){try{u(n.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Pool=t.Thread=t.PoolEventType=void 0;var l=u(r(6157)),c=r(2801),f=r(9579),h=r(736),d=r(6552);Object.defineProperty(t,"PoolEventType",{enumerable:!0,get:function(){return d.PoolEventType}});var p=r(5897);Object.defineProperty(t,"Thread",{enumerable:!0,get:function(){return p.Thread}});var m=1;function v(e){return new Promise((function(t){return setTimeout(t,e)}))}function y(e,t){return e.reduce((function(e,r){return[].concat(a(e),a(t(r)))}),[])}var g=function(){function e(t,r){var n=this;i(this,e),this.eventSubject=new c.Subject,this.initErrors=[],this.isClosing=!1,this.nextTaskID=1,this.taskQueue=[];var o="number"==typeof r?{size:r}:r||{},a=o.size,s=void 0===a?h.defaultPoolSize:a;this.debug=l.default("threads:pool:".concat((o.name||String(m++)).replace(/\W/g," ").trim().replace(/\s+/g,"-"))),this.options=o,this.workers=function(e,t){return function(e){for(var t=[],r=0;r<e;r++)t.push(r);return t}(t).map((function(){return{init:e(),runningTasks:[]}}))}(t,s),this.eventObservable=c.multicast(c.Observable.from(this.eventSubject)),Promise.all(this.workers.map((function(e){return e.init}))).then((function(){return n.eventSubject.next({type:d.PoolEventType.initialized,size:n.workers.length})}),(function(e){n.debug("Error while initializing pool worker:",e),n.eventSubject.error(e),n.initErrors.push(e)}))}return o(e,[{key:"findIdlingWorker",value:function(){var e=this.options.concurrency,t=void 0===e?1:e;return this.workers.find((function(e){return e.runningTasks.length<t}))}},{key:"runPoolTask",value:function(e,t){return s(this,void 0,void 0,n.mark((function r(){var i,o;return n.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return i=this.workers.indexOf(e)+1,this.debug("Running task #".concat(t.id," on worker #").concat(i,"...")),this.eventSubject.next({type:d.PoolEventType.taskStart,taskID:t.id,workerID:i}),r.prev=3,r.t0=t,r.next=7,e.init;case 7:return r.t1=r.sent,r.next=10,r.t0.run.call(r.t0,r.t1);case 10:o=r.sent,this.debug("Task #".concat(t.id," completed successfully")),this.eventSubject.next({type:d.PoolEventType.taskCompleted,returnValue:o,taskID:t.id,workerID:i}),r.next=19;break;case 15:r.prev=15,r.t2=r.catch(3),this.debug("Task #".concat(t.id," failed")),this.eventSubject.next({type:d.PoolEventType.taskFailed,taskID:t.id,error:r.t2,workerID:i});case 19:case"end":return r.stop()}}),r,this,[[3,15]])})))}},{key:"run",value:function(e,t){return s(this,void 0,void 0,n.mark((function r(){var i,o=this;return n.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:i=s(o,void 0,void 0,n.mark((function r(){var o;return n.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o=function(){e.runningTasks=e.runningTasks.filter((function(e){return e!==i}))},r.next=3,v(0);case 3:return r.prev=3,r.next=6,this.runPoolTask(e,t);case 6:return r.prev=6,o(),this.isClosing||this.scheduleWork(),r.finish(6);case 10:case"end":return r.stop()}}),r,this,[[3,,6,10]])}))),e.runningTasks.push(i);case 2:case"end":return r.stop()}}),r)})))}},{key:"scheduleWork",value:function(){this.debug("Attempt de-queueing a task in order to run it...");var e=this.findIdlingWorker();if(e){var t=this.taskQueue.shift();if(!t)return this.debug("Task queue is empty"),void this.eventSubject.next({type:d.PoolEventType.taskQueueDrained});this.run(e,t)}}},{key:"taskCompletion",value:function(e){var t=this;return new Promise((function(r,n){var i=t.events().subscribe((function(t){t.type===d.PoolEventType.taskCompleted&&t.taskID===e?(i.unsubscribe(),r(t.returnValue)):t.type===d.PoolEventType.taskFailed&&t.taskID===e?(i.unsubscribe(),n(t.error)):t.type===d.PoolEventType.terminated&&(i.unsubscribe(),n(Error("Pool has been terminated before task was run.")))}))}))}},{key:"settled",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return s(this,void 0,void 0,n.mark((function t(){var r,i,o,a=this;return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=function(){return y(a.workers,(function(e){return e.runningTasks}))},i=[],o=this.eventObservable.subscribe((function(e){e.type===d.PoolEventType.taskFailed&&i.push(e.error)})),!(this.initErrors.length>0)){t.next=5;break}return t.abrupt("return",Promise.reject(this.initErrors[0]));case 5:if(!e||0!==this.taskQueue.length){t.next=9;break}return t.next=8,f.allSettled(r());case 8:return t.abrupt("return",i);case 9:return t.next=11,new Promise((function(e,t){var r=a.eventObservable.subscribe({next:function(t){t.type===d.PoolEventType.taskQueueDrained&&(r.unsubscribe(),e(void 0))},error:t})}));case 11:return t.next=13,f.allSettled(r());case 13:return o.unsubscribe(),t.abrupt("return",i);case 15:case"end":return t.stop()}}),t,this)})))}},{key:"completed",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return s(this,void 0,void 0,n.mark((function t(){var r,i,o,a=this;return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.settled(e),i=new Promise((function(e,t){var n=a.eventObservable.subscribe({next:function(i){i.type===d.PoolEventType.taskQueueDrained?(n.unsubscribe(),e(r)):i.type===d.PoolEventType.taskFailed&&(n.unsubscribe(),t(i.error))},error:t})})),t.next=4,Promise.race([r,i]);case 4:if(!((o=t.sent).length>0)){t.next=7;break}throw o[0];case 7:case"end":return t.stop()}}),t,this)})))}},{key:"events",value:function(){return this.eventObservable}},{key:"queue",value:function(e){var t=this,r=this.options.maxQueuedJobs,n=void 0===r?1/0:r;if(this.isClosing)throw Error("Cannot schedule pool tasks after terminate() has been called.");if(this.initErrors.length>0)throw this.initErrors[0];var i=this.nextTaskID++,o=this.taskCompletion(i);o.catch((function(e){t.debug("Task #".concat(i," errored:"),e)}));var a={id:i,run:e,cancel:function(){-1!==t.taskQueue.indexOf(a)&&(t.taskQueue=t.taskQueue.filter((function(e){return e!==a})),t.eventSubject.next({type:d.PoolEventType.taskCanceled,taskID:a.id}))},then:o.then.bind(o)};if(this.taskQueue.length>=n)throw Error("Maximum number of pool tasks queued. Refusing to queue another one.\nThis usually happens for one of two reasons: We are either at peak workload right now or some tasks just won't finish, thus blocking the pool.");return this.debug("Queueing task #".concat(a.id,"...")),this.taskQueue.push(a),this.eventSubject.next({type:d.PoolEventType.taskQueued,taskID:a.id}),this.scheduleWork(),a}},{key:"terminate",value:function(e){return s(this,void 0,void 0,n.mark((function t(){var r=this;return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.isClosing=!0,e){t.next=4;break}return t.next=4,this.completed(!0);case 4:return this.eventSubject.next({type:d.PoolEventType.terminated,remainingQueue:a(this.taskQueue)}),this.eventSubject.complete(),t.next=8,Promise.all(this.workers.map((function(e){return s(r,void 0,void 0,n.mark((function t(){return n.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=p.Thread,t.next=3,e.init;case 3:return t.t1=t.sent,t.abrupt("return",t.t0.terminate.call(t.t0,t.t1));case 5:case"end":return t.stop()}}),t)})))})));case 8:case"end":return t.stop()}}),t,this)})))}}]),e}();function b(e,t){return new g(e,t)}g.EventType=d.PoolEventType,b.EventType=d.PoolEventType,t.Pool=b},7365:function(e,t,r){"use strict";var n=r(9713),i=r(3038),o=r(7757),a=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(t){o(t)}}function s(e){try{u(n.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.spawn=void 0;var u=s(r(6157)),l=r(2801),c=r(4919),f=r(4127),h=r(8628),d=r(7541),p=r(6177),m=u.default("threads:master:messages"),v=u.default("threads:master:spawn"),y=u.default("threads:master:thread-utils"),g="undefined"!=typeof process&&{}.THREADS_WORKER_INIT_TIMEOUT?Number.parseInt({}.THREADS_WORKER_INIT_TIMEOUT,10):1e4;function b(e,t,r){return a(this,void 0,void 0,o.mark((function n(){var i,a,s;return o.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=new Promise((function(e,n){i=setTimeout((function(){return n(Error(r))}),t)})),n.next=3,Promise.race([e,a]);case 3:return s=n.sent,clearTimeout(i),n.abrupt("return",s);case 6:case"end":return n.stop()}}),n)})))}function w(e){return new Promise((function(t,r){e.addEventListener("message",(function n(i){var o;m("Message from worker before finishing initialization:",i.data),(o=i.data)&&"init"===o.type?(e.removeEventListener("message",n),t(i.data)):function(e){return e&&"uncaughtError"===e.type}(i.data)&&(e.removeEventListener("message",n),r(c.deserialize(i.data.error)))}))}))}function _(e,t){return new l.Observable((function(r){var n=function(e){var t={type:d.WorkerEventType.message,data:e.data};r.next(t)},i=function(e){y("Unhandled promise rejection event in thread:",e);var t={type:d.WorkerEventType.internalError,error:Error(e.reason)};r.next(t)};e.addEventListener("message",n),e.addEventListener("unhandledrejection",i),t.then((function(){var t={type:d.WorkerEventType.termination};e.removeEventListener("message",n),e.removeEventListener("unhandledrejection",i),r.next(t),r.complete()}))}))}function x(e){var t=this,r=f.createPromiseWithResolver(),n=i(r,2),s=n[0],u=n[1];return{terminate:function(){return a(t,void 0,void 0,o.mark((function t(){return o.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return y("Terminating worker"),t.next=3,e.terminate();case 3:u();case 4:case"end":return t.stop()}}),t)})))},termination:s}}function T(e,t,r,i){var o,a=r.filter((function(e){return e.type===d.WorkerEventType.internalError})).map((function(e){return e.error}));return Object.assign(e,(n(o={},h.$errors,a),n(o,h.$events,r),n(o,h.$terminate,i),n(o,h.$worker,t),o))}t.spawn=function(e,t){return a(this,void 0,void 0,o.mark((function r(){var n,i,a,s,u,l,c,f,h,d;return o.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return v("Initializing new thread"),n=t&&t.timeout?t.timeout:g,r.next=4,b(w(e),n,"Timeout: Did not receive an init message from worker after ".concat(n,"ms. Make sure the worker calls expose()."));case 4:if(i=r.sent,a=i.exposed,s=x(e),u=s.termination,l=s.terminate,c=_(e,u),"function"!==a.type){r.next=13;break}return f=p.createProxyFunction(e),r.abrupt("return",T(f,e,c,l));case 13:if("module"!==a.type){r.next=18;break}return h=p.createProxyModule(e,a.methods),r.abrupt("return",T(h,e,c,l));case 18:throw d=a.type,Error("Worker init message states unexpected type of expose(): ".concat(d));case 20:case"end":return r.stop()}}),r)})))}},5897:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Thread=void 0;var n=r(8628);function i(e){throw Error(e)}t.Thread={errors:function(e){return e[n.$errors]||i("Error observable not found. Make sure to pass a thread instance as returned by the spawn() promise.")},events:function(e){return e[n.$events]||i("Events observable not found. Make sure to pass a thread instance as returned by the spawn() promise.")},terminate:function(e){return e[n.$terminate]()}}},684:function(e,t,r){"use strict";var n=r(4575),i=r(3913),o=r(1506),a=r(6525),s=r(2205),u=r(8585),l=r(9754);function c(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return f(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return f(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=l(e);if(t){var i=l(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return u(this,r)}}Object.defineProperty(t,"__esModule",{value:!0}),t.ObservablePromise=void 0;var d=r(2801),p=function(){},m=function(e){return e},v=function(e){return Promise.resolve().then(e)};function y(e){throw e}var g=function(e){s(r,e);var t=h(r);function r(e){var i;return n(this,r),(i=t.call(this,(function(t){var r=o(i),n=Object.assign(Object.assign({},t),{complete:function(){t.complete(),r.onCompletion()},error:function(e){t.error(e),r.onError(e)},next:function(e){t.next(e),r.onNext(e)}});try{return i.initHasRun=!0,e(n)}catch(a){n.error(a)}}))).initHasRun=!1,i.fulfillmentCallbacks=[],i.rejectionCallbacks=[],i.firstValueSet=!1,i.state="pending",i}return i(r,[{key:"onNext",value:function(e){this.firstValueSet||(this.firstValue=e,this.firstValueSet=!0)}},{key:"onError",value:function(e){this.state="rejected",this.rejection=e;var t,r=c(this.rejectionCallbacks);try{var n=function(){var r=t.value;v((function(){return r(e)}))};for(r.s();!(t=r.n()).done;)n()}catch(i){r.e(i)}finally{r.f()}}},{key:"onCompletion",value:function(){var e=this;this.state="fulfilled";var t,r=c(this.fulfillmentCallbacks);try{var n=function(){var r=t.value;v((function(){return r(e.firstValue)}))};for(r.s();!(t=r.n()).done;)n()}catch(i){r.e(i)}finally{r.f()}}},{key:"then",value:function(e,t){var r=this,n=e||m,i=t||y,o=!1;return new Promise((function(e,t){var a=function(r){if(!o){o=!0;try{e(i(r))}catch(n){t(n)}}};return r.initHasRun||r.subscribe({error:a}),"fulfilled"===r.state?e(n(r.firstValue)):"rejected"===r.state?(o=!0,e(i(r.rejection))):(r.fulfillmentCallbacks.push((function(t){try{e(n(t))}catch(r){a(r)}})),void r.rejectionCallbacks.push(a))}))}},{key:"catch",value:function(e){return this.then(void 0,e)}},{key:"finally",value:function(e){var t=e||p;return this.then((function(e){return t(),e}),(function(){return t()}))}}],[{key:"from",value:function(e){return function(e){return e&&"function"==typeof e.then}(e)?new r((function(t){e.then((function(e){t.next(e),t.complete()}),(function(e){t.error(e)}))})):a(l(r),"from",this).call(this,e)}}]),r}(d.Observable);t.ObservablePromise=g},9579:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.allSettled=void 0,t.allSettled=function(e){return Promise.all(e.map((function(e){var t=Promise.resolve(e);try{return t.then((function(e){return{status:"fulfilled",value:e}}),(function(e){return{status:"rejected",reason:e}}))}catch(r){return Promise.reject(r)}})))}},4127:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createPromiseWithResolver=void 0;var r=function(){};t.createPromiseWithResolver=function(){var e,t=!1,n=r;return[new Promise((function(r){t?r(e):n=r})),function(r){t=!0,n(e=r)}]}},327:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultSerializer=t.extendSerializer=void 0,t.extendSerializer=function(e,t){var r=e.deserialize.bind(e),n=e.serialize.bind(e);return{deserialize:function(e){return t.deserialize(e,r)},serialize:function(e){return t.serialize(e,n)}}};var r=function(e){return Object.assign(Error(e.message),{name:e.name,stack:e.stack})},n=function(e){return{__error_marker:"$$error",message:e.message,name:e.name,stack:e.stack}};t.DefaultSerializer={deserialize:function(e){return(t=e)&&"object"==typeof t&&"__error_marker"in t&&"$$error"===t.__error_marker?r(e):e;var t},serialize:function(e){return e instanceof Error?n(e):e}}},8628:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.$worker=t.$transferable=t.$terminate=t.$events=t.$errors=void 0,t.$errors=Symbol("thread.errors"),t.$events=Symbol("thread.events"),t.$terminate=Symbol("thread.terminate"),t.$transferable=Symbol("thread.transferable"),t.$worker=Symbol("thread.worker")},5314:function(e,t,r){"use strict";var n=r(9713);Object.defineProperty(t,"__esModule",{value:!0}),t.Transfer=t.isTransferDescriptor=void 0;var i=r(8628);t.isTransferDescriptor=function(e){return e&&"object"==typeof e&&e[i.$transferable]},t.Transfer=function(e,t){var r,o;if(!t){if(!(o=e)||"object"!=typeof o)throw Error();t=[e]}return n(r={},i.$transferable,!0),n(r,"send",e),n(r,"transferables",t),r}},7541:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WorkerEventType=void 0;r(8628);!function(e){e.internalError="internalError",e.message="message",e.termination="termination"}(t.WorkerEventType||(t.WorkerEventType={}))},3226:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WorkerMessageType=t.MasterMessageType=void 0,function(e){e.cancel="cancel",e.run="run"}(t.MasterMessageType||(t.MasterMessageType={})),function(e){e.error="error",e.init="init",e.result="result",e.running="running",e.uncaughtError="uncaughtError"}(t.WorkerMessageType||(t.WorkerMessageType={}))},2642:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={isWorkerRuntime:function(){var e="undefined"!=typeof self&&"undefined"!=typeof Window&&self instanceof Window;return!("undefined"==typeof self||!self.postMessage||e)},postMessageToMaster:function(e,t){self.postMessage(e,t)},subscribeToMasterMessages:function(e){var t=function(t){e(t.data)};return self.addEventListener("message",t),function(){self.removeEventListener("message",t)}}}},771:function(e,t,r){"use strict";var n=r(7757),i=r(319),o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(t){o(t)}}function s(e){try{u(n.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.expose=t.isWorkerRuntime=t.Transfer=t.registerSerializer=void 0;var s=a(r(6528)),u=r(4919),l=r(5314),c=r(3226),f=a(r(2642)),h=r(4919);Object.defineProperty(t,"registerSerializer",{enumerable:!0,get:function(){return h.registerSerializer}});var d=r(5314);Object.defineProperty(t,"Transfer",{enumerable:!0,get:function(){return d.Transfer}}),t.isWorkerRuntime=f.default.isWorkerRuntime;var p=!1,m=new Map,v=function(e){return e&&e.type===c.MasterMessageType.run},y=function(e){return s.default(e)||function(e){return e&&"object"==typeof e&&"function"==typeof e.subscribe}(e)};function g(e){return l.isTransferDescriptor(e)?{payload:e.send,transferables:e.transferables}:{payload:e,transferables:void 0}}function b(e,t){var r=g(t),n=r.payload,i=r.transferables,o={type:c.WorkerMessageType.error,uid:e,error:u.serialize(n)};f.default.postMessageToMaster(o,i)}function w(e,t,r){var n=g(r),i=n.payload,o=n.transferables,a={type:c.WorkerMessageType.result,uid:e,complete:!!t||void 0,payload:i};f.default.postMessageToMaster(a,o)}function _(e,t){var r={type:c.WorkerMessageType.running,uid:e,resultType:t};f.default.postMessageToMaster(r)}function x(e){try{var t={type:c.WorkerMessageType.uncaughtError,error:u.serialize(e)};f.default.postMessageToMaster(t)}catch(r){console.error("Not reporting uncaught error back to master thread as it occured while reporting an uncaught error already.\nLatest error:",r,"\nOriginal error:",e)}}function T(e,t,r){return o(this,void 0,void 0,n.mark((function o(){var a,s,l,c;return n.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:n.prev=0,a=t.apply(void 0,i(r)),n.next=7;break;case 4:return n.prev=4,n.t0=n.catch(0),n.abrupt("return",b(e,n.t0));case 7:if(s=y(a)?"observable":"promise",_(e,s),!y(a)){n.next=14;break}l=a.subscribe((function(t){return w(e,!1,u.serialize(t))}),(function(t){b(e,u.serialize(t)),m.delete(e)}),(function(){w(e,!0),m.delete(e)})),m.set(e,l),n.next=24;break;case 14:return n.prev=14,n.next=17,a;case 17:c=n.sent,w(e,!0,u.serialize(c)),n.next=24;break;case 21:n.prev=21,n.t1=n.catch(14),b(e,u.serialize(n.t1));case 24:case"end":return n.stop()}}),o,null,[[0,4],[14,21]])})))}t.expose=function(e){if(!f.default.isWorkerRuntime())throw Error("expose() called in the master thread.");if(p)throw Error("expose() called more than once. This is not possible. Pass an object to expose() if you want to expose multiple functions.");if(p=!0,"function"==typeof e)f.default.subscribeToMasterMessages((function(t){v(t)&&!t.method&&T(t.uid,e,t.args.map(u.deserialize))})),t={type:c.WorkerMessageType.init,exposed:{type:"function"}},f.default.postMessageToMaster(t);else{if("object"!=typeof e||!e)throw Error("Invalid argument passed to expose(). Expected a function or an object, got: ".concat(e));f.default.subscribeToMasterMessages((function(t){v(t)&&t.method&&T(t.uid,e[t.method],t.args.map(u.deserialize))})),function(e){var t={type:c.WorkerMessageType.init,exposed:{type:"module",methods:e}};f.default.postMessageToMaster(t)}(Object.keys(e).filter((function(t){return"function"==typeof e[t]})))}var t;f.default.subscribeToMasterMessages((function(e){if((n=e)&&n.type===c.MasterMessageType.cancel){var t=e.uid,r=m.get(t);r&&(r.unsubscribe(),m.delete(t))}var n}))},"undefined"!=typeof self&&"function"==typeof self.addEventListener&&f.default.isWorkerRuntime()&&(self.addEventListener("error",(function(e){setTimeout((function(){return x(e.error||e)}),250)})),self.addEventListener("unhandledrejection",(function(e){var t=e.reason;t&&"string"==typeof t.message&&setTimeout((function(){return x(t)}),250)}))),"undefined"!=typeof process&&"function"==typeof process.on&&f.default.isWorkerRuntime()&&(process.on("uncaughtException",(function(e){setTimeout((function(){return x(e)}),250)})),process.on("unhandledRejection",(function(e){e&&"string"==typeof e.message&&setTimeout((function(){return x(e)}),250)})))},2634:function(e,t,r){var n=r(7631);e.exports=function(e,t,r){var i=r&&r.debug||!1,o=r&&r.startIndex||0;i&&console.log("starting findTagByName with",t," and ",r);var a=n(e,"<".concat(t,"[ >]"),o);if(i&&console.log("start:",a),-1!==a){var s=e.slice(a+t.length),u=n(s,"[ /]"+t+">",0),l=-1===u;l&&(u=n(s,"[ /]>",0));var c=a+t.length+u+1+(l?0:t.length)+1;if(i&&console.log("end:",c),-1!==c){var f=e.slice(a,c);return{inner:l?null:f.slice(f.indexOf(">")+1,f.lastIndexOf("<")),outer:f,start:a,end:c}}}}},7690:function(e,t,r){var n=r(2634);e.exports=function(e,t,r){for(var i,o=[],a=r&&r.debug||!1,s=r&&r.startIndex||0;i=n(e,t,{debug:a,startIndex:s});)s=i.end,o.push(i);return a&&console.log("findTagsByName found",o.length,"tags"),o}},3349:function(e){e.exports=function(e,t,r){var n=r&&r.debug||!1;n&&console.log("getting "+t+" in "+e);var i="object"==typeof e?e.outer:e,o="".concat(t,'\\="([^"]*)"');n&&console.log("pattern:",o);var a=new RegExp(o).exec(i);if(n&&console.log("match:",a),a)return a[1]}},7631:function(e){e.exports=function(e,t,r){var n=new RegExp(t).exec(e.slice(r));return n?r+n.index:-1}},648:function(e,t,r){var n=r(7854),i=r(1694),o=r(614),a=r(4326),s=r(5112)("toStringTag"),u=n.Object,l="Arguments"==a(function(){return arguments}());e.exports=i?a:function(e){var t,r,n;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(r){}}(t=u(e),s))?r:l?a(t):"Object"==(n=a(t))&&o(t.callee)?"Arguments":n}},6135:function(e,t,r){"use strict";var n=r(4948),i=r(3070),o=r(9114);e.exports=function(e,t,r){var a=n(t);a in e?i.f(e,a,o(0,r)):e[a]=r}},9974:function(e,t,r){var n=r(1702),i=r(9662),o=n(n.bind);e.exports=function(e,t){return i(e),void 0===t?e:o?o(e,t):function(){return e.apply(t,arguments)}}},1246:function(e,t,r){var n=r(648),i=r(8173),o=r(7497),a=r(5112)("iterator");e.exports=function(e){if(null!=e)return i(e,a)||i(e,"@@iterator")||o[n(e)]}},8554:function(e,t,r){var n=r(7854),i=r(6916),o=r(9662),a=r(9670),s=r(6330),u=r(1246),l=n.TypeError;e.exports=function(e,t){var r=arguments.length<2?u(e):t;if(o(r))return a(i(r,e));throw l(s(e)+" is not iterable")}},7659:function(e,t,r){var n=r(5112),i=r(7497),o=n("iterator"),a=Array.prototype;e.exports=function(e){return void 0!==e&&(i.Array===e||a[o]===e)}},408:function(e,t,r){var n=r(7854),i=r(9974),o=r(6916),a=r(9670),s=r(6330),u=r(7659),l=r(6244),c=r(7976),f=r(8554),h=r(1246),d=r(9212),p=n.TypeError,m=function(e,t){this.stopped=e,this.result=t},v=m.prototype;e.exports=function(e,t,r){var n,y,g,b,w,_,x,T=r&&r.that,E=!(!r||!r.AS_ENTRIES),k=!(!r||!r.IS_ITERATOR),S=!(!r||!r.INTERRUPTED),A=i(t,T),R=function(e){return n&&d(n,"normal",e),new m(!0,e)},C=function(e){return E?(a(e),S?A(e[0],e[1],R):A(e[0],e[1])):S?A(e,R):A(e)};if(k)n=e;else{if(!(y=h(e)))throw p(s(e)+" is not iterable");if(u(y)){for(g=0,b=l(e);b>g;g++)if((w=C(e[g]))&&c(v,w))return w;return new m(!1)}n=f(e,y)}for(_=n.next;!(x=o(_,n)).done;){try{w=C(x.value)}catch(P){d(n,"throw",P)}if("object"==typeof w&&w&&c(v,w))return w}return new m(!1)}},9212:function(e,t,r){var n=r(6916),i=r(9670),o=r(8173);e.exports=function(e,t,r){var a,s;i(e);try{if(!(a=o(e,"return"))){if("throw"===t)throw r;return r}a=n(a,e)}catch(u){s=!0,a=u}if("throw"===t)throw r;if(s)throw a;return i(a),r}},7497:function(e){e.exports={}},8523:function(e,t,r){"use strict";var n=r(9662),i=function(e){var t,r;this.promise=new e((function(e,n){if(void 0!==t||void 0!==r)throw TypeError("Bad Promise constructor");t=e,r=n})),this.resolve=n(t),this.reject=n(r)};e.exports.f=function(e){return new i(e)}},2534:function(e){e.exports=function(e){try{return{error:!1,value:e()}}catch(t){return{error:!0,value:t}}}},1694:function(e,t,r){var n={};n[r(5112)("toStringTag")]="z",e.exports="[object z]"===String(n)},8559:function(e,t,r){var n=r(2109),i=r(408),o=r(6135);n({target:"Object",stat:!0},{fromEntries:function(e){var t={};return i(e,(function(e,r){o(t,e,r)}),{AS_ENTRIES:!0}),t}})},7922:function(e,t,r){"use strict";var n=r(2109),i=r(6916),o=r(9662),a=r(8523),s=r(2534),u=r(408);n({target:"Promise",stat:!0},{allSettled:function(e){var t=this,r=a.f(t),n=r.resolve,l=r.reject,c=s((function(){var r=o(t.resolve),a=[],s=0,l=1;u(e,(function(e){var o=s++,u=!1;l++,i(r,t,e).then((function(e){u||(u=!0,a[o]={status:"fulfilled",value:e},--l||n(a))}),(function(e){u||(u=!0,a[o]={status:"rejected",reason:e},--l||n(a))}))})),--l||n(a)}));return c.error&&l(c.value),r.promise}})},7314:function(e,t,r){r(7922)},2874:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return Or}});var n=r(5861),i=r(3433),o=r(7757),a=r.n(o),s=r(7294),u=r(2055),l=r(8177),c=r(532),f=r(4942),h=r(3366),d=r(7462),p=r(5505),m=r(9408),v=r(7663),y=r(3656),g=r(7761),b=r(3679),w=r(9240),_=r(8416);function x(e){return(0,_.Z)("MuiIconButton",e)}var T=(0,r(2194).Z)("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge"]),E=r(5893),k=["edge","children","className","color","disabled","disableFocusRipple","size"],S=(0,y.ZP)(b.Z,{name:"MuiIconButton",slot:"Root",overridesResolver:function(e,t){var r=e.ownerState;return[t.root,"default"!==r.color&&t["color".concat((0,w.Z)(r.color))],r.edge&&t["edge".concat((0,w.Z)(r.edge))],t["size".concat((0,w.Z)(r.size))]]}})((function(e){var t=e.theme,r=e.ownerState;return(0,d.Z)({textAlign:"center",flex:"0 0 auto",fontSize:t.typography.pxToRem(24),padding:8,borderRadius:"50%",overflow:"visible",color:t.palette.action.active,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest})},!r.disableRipple&&{"&:hover":{backgroundColor:(0,v.Fq)(t.palette.action.active,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"start"===r.edge&&{marginLeft:"small"===r.size?-3:-12},"end"===r.edge&&{marginRight:"small"===r.size?-3:-12})}),(function(e){var t=e.theme,r=e.ownerState;return(0,d.Z)({},"inherit"===r.color&&{color:"inherit"},"inherit"!==r.color&&"default"!==r.color&&(0,d.Z)({color:t.palette[r.color].main},!r.disableRipple&&{"&:hover":{backgroundColor:(0,v.Fq)(t.palette[r.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}}),"small"===r.size&&{padding:5,fontSize:t.typography.pxToRem(18)},"large"===r.size&&{padding:12,fontSize:t.typography.pxToRem(28)},(0,f.Z)({},"&.".concat(T.disabled),{backgroundColor:"transparent",color:t.palette.action.disabled}))})),A=s.forwardRef((function(e,t){var r=(0,g.Z)({props:e,name:"MuiIconButton"}),n=r.edge,i=void 0!==n&&n,o=r.children,a=r.className,s=r.color,u=void 0===s?"default":s,l=r.disabled,c=void 0!==l&&l,f=r.disableFocusRipple,v=void 0!==f&&f,y=r.size,b=void 0===y?"medium":y,_=(0,h.Z)(r,k),T=(0,d.Z)({},r,{edge:i,color:u,disabled:c,disableFocusRipple:v,size:b}),A=function(e){var t=e.classes,r=e.disabled,n=e.color,i=e.edge,o=e.size,a={root:["root",r&&"disabled","default"!==n&&"color".concat((0,w.Z)(n)),i&&"edge".concat((0,w.Z)(i)),"size".concat((0,w.Z)(o))]};return(0,m.Z)(a,x,t)}(T);return(0,E.jsx)(S,(0,d.Z)({className:(0,p.Z)(A.root,a),centerRipple:!0,focusRipple:!v,disabled:c,ref:t,ownerState:T},_,{children:o}))})),R=r(9308),C=r(5616),P=r(4382),D=r(4320),O=r(26),M=r(6968),I=r(3827),L=r(4439),Z=r(1570),U=r(4682),F=r(2990),G=r(4649),j=r(1939),B=r(3015),N=r(4959),z=r(5338),V=r(5370),$=r(3286),K=r(4591),W=r(8737),H=r(6785),q=r(7059),X=r(1690),Y=r(8),Q=r(7037),J=r(9413),ee=r(2991),te=34962,re=34963,ne=35044,ie=["experimental-webgl","webgl","webkit-3d","moz-webgl"];function oe(e,t){for(var r=(0,ee.f0)({preserveDrawingBuffer:!0},t),n=ie.length,i=0;i<n;++i)try{var o=e.getContext(ie[i],r);if(o)return o}catch(a){}return null}var ae=r(4093),se=ne,ue=function(){function e(e,t){this.array=null,this.type=e,(0,ae.h)(e===te||e===re,62),this.usage=void 0!==t?t:se}return e.prototype.ofSize=function(e){this.array=new(le(this.type))(e)},e.prototype.fromArray=function(e){var t=le(this.type);this.array=t.from?t.from(e):new t(e)},e.prototype.fromArrayBuffer=function(e){this.array=new(le(this.type))(e)},e.prototype.getType=function(){return this.type},e.prototype.getArray=function(){return this.array},e.prototype.getUsage=function(){return this.usage},e.prototype.getSize=function(){return this.array?this.array.length:0},e}();function le(e){switch(e){case te:return Float32Array;case re:return Uint32Array;default:return Float32Array}}var ce,fe=ue,he=(ce=function(e,t){return ce=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},ce(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}ce(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function de(e,t,r){var n=r?e.LINEAR:e.NEAREST;e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,n)}function pe(e,t,r,n,i,o){var a=e.getGL();de(a,t,o);var s,u,l=r.byteLength/n[1],c=1;switch(l%8==0?c=8:l%4==0?c=4:l%2==0&&(c=2),i){case 1:s=a.LUMINANCE;break;case 2:s=a.LUMINANCE_ALPHA;break;case 3:s=a.RGB;break;case 4:s=a.RGBA;break;default:throw new Error("Unsupported number of bands: "+i)}r instanceof Float32Array?(u=a.FLOAT,e.getExtension("OES_texture_float"),e.getExtension("OES_texture_float_linear")):u=a.UNSIGNED_BYTE;var f=a.getParameter(a.UNPACK_ALIGNMENT);a.pixelStorei(a.UNPACK_ALIGNMENT,c),a.texImage2D(a.TEXTURE_2D,0,s,n[0],n[1],0,s,u,r),a.pixelStorei(a.UNPACK_ALIGNMENT,f)}var me=function(e){function t(t,r,n){var i=e.call(this)||this;i.tile,i.textures=[],i.handleTileChange_=i.handleTileChange_.bind(i),i.size=(0,z.Pq)(r.getTileSize(t.tileCoord[0])),i.bandCount=NaN,i.helper_=n;var o=new fe(te,ne);return o.fromArray([0,1,1,1,1,0,0,0]),n.flushBufferData(o),i.coords=o,i.setTile(t),i}return he(t,e),t.prototype.setTile=function(e){e!==this.tile&&(this.tile&&this.tile.removeEventListener(Y.Z.CHANGE,this.handleTileChange_),this.tile=e,this.textures.length=0,this.loaded=e.getState()===q.Z.LOADED,this.loaded?this.uploadTile_():e.addEventListener(Y.Z.CHANGE,this.handleTileChange_))},t.prototype.uploadTile_=function(){var e=this.helper_,t=e.getGL(),r=this.tile;if(r instanceof Q.Z||r instanceof J.Z){var n=t.createTexture();return this.textures.push(n),this.bandCount=4,void function(e,t,r,n){de(e,t,n),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r)}(t,n,r.getImage(),r.interpolate)}var i=r.getData(),o=i instanceof Float32Array,a=this.size[0]*this.size[1],s=o?Float32Array:Uint8Array,u=s.BYTES_PER_ELEMENT,l=i.byteLength/this.size[1];this.bandCount=Math.floor(l/u/this.size[0]);var c=Math.ceil(this.bandCount/4);if(1===c){n=t.createTexture();return this.textures.push(n),void pe(e,n,i,this.size,this.bandCount,r.interpolate)}for(var f=new Array(c),h=0;h<c;++h){n=t.createTexture();this.textures.push(n);var d=h<c-1?4:this.bandCount%4;f[h]=new s(a*d)}for(var p=0,m=0,v=this.size[0]*this.bandCount,y=0;y<this.size[1];++y){for(var g=0;g<v;++g){var b=i[m+g],w=Math.floor(p/this.bandCount),_=g%this.bandCount;(x=f[h=Math.floor(_/4)])[w*(d=x.length/a)+_%4]=b,++p}m+=l/u}for(h=0;h<c;++h){var x;n=this.textures[h],d=(x=f[h]).length/a;pe(e,n,x,this.size,d,r.interpolate)}},t.prototype.handleTileChange_=function(){this.tile.getState()===q.Z.LOADED&&(this.loaded=!0,this.uploadTile_(),this.dispatchEvent(Y.Z.CHANGE))},t.prototype.disposeInternal=function(){var e=this.helper_.getGL();this.helper_.deleteBuffer(this.coords);for(var t=0;t<this.textures.length;++t)e.deleteTexture(this.textures[t]);this.tile.removeEventListener(Y.Z.CHANGE,this.handleTileChange_)},t}(X.Z),ve=r(4237),ye=r(3343),ge=r(6239),be="webglcontextlost",we="webglcontextrestored",_e=r(5925),xe=r(399),Te=function(){function e(e){this.gl_=e.webGlContext;var t=this.gl_;this.scaleRatio_=e.scaleRatio||1,this.renderTargetTexture_=t.createTexture(),this.renderTargetTextureSize_=null,this.frameBuffer_=t.createFramebuffer();var r=t.createShader(t.VERTEX_SHADER);t.shaderSource(r,e.vertexShader||"\n  precision mediump float;\n  \n  attribute vec2 a_position;\n  varying vec2 v_texCoord;\n  varying vec2 v_screenCoord;\n  \n  uniform vec2 u_screenSize;\n   \n  void main() {\n    v_texCoord = a_position * 0.5 + 0.5;\n    v_screenCoord = v_texCoord * u_screenSize;\n    gl_Position = vec4(a_position, 0.0, 1.0);\n  }\n"),t.compileShader(r);var n=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(n,e.fragmentShader||"\n  precision mediump float;\n   \n  uniform sampler2D u_image;\n  uniform float u_opacity;\n   \n  varying vec2 v_texCoord;\n   \n  void main() {\n    gl_FragColor = texture2D(u_image, v_texCoord) * u_opacity;\n  }\n"),t.compileShader(n),this.renderTargetProgram_=t.createProgram(),t.attachShader(this.renderTargetProgram_,r),t.attachShader(this.renderTargetProgram_,n),t.linkProgram(this.renderTargetProgram_),this.renderTargetVerticesBuffer_=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),t.bufferData(t.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,1,-1,1,1,-1,1]),t.STATIC_DRAW),this.renderTargetAttribLocation_=t.getAttribLocation(this.renderTargetProgram_,"a_position"),this.renderTargetUniformLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_screenSize"),this.renderTargetOpacityLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_opacity"),this.renderTargetTextureLocation_=t.getUniformLocation(this.renderTargetProgram_,"u_image"),this.uniforms_=[],e.uniforms&&Object.keys(e.uniforms).forEach(function(r){this.uniforms_.push({value:e.uniforms[r],location:t.getUniformLocation(this.renderTargetProgram_,r)})}.bind(this))}return e.prototype.getGL=function(){return this.gl_},e.prototype.init=function(e){var t=this.getGL(),r=[t.drawingBufferWidth*this.scaleRatio_,t.drawingBufferHeight*this.scaleRatio_];if(t.bindFramebuffer(t.FRAMEBUFFER,this.getFrameBuffer()),t.viewport(0,0,r[0],r[1]),!this.renderTargetTextureSize_||this.renderTargetTextureSize_[0]!==r[0]||this.renderTargetTextureSize_[1]!==r[1]){this.renderTargetTextureSize_=r;var n=t.RGBA,i=t.RGBA,o=t.UNSIGNED_BYTE;t.bindTexture(t.TEXTURE_2D,this.renderTargetTexture_),t.texImage2D(t.TEXTURE_2D,0,n,r[0],r[1],0,i,o,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.renderTargetTexture_,0)}},e.prototype.apply=function(e,t,r,n){var i=this.getGL(),o=e.size;if(i.bindFramebuffer(i.FRAMEBUFFER,t?t.getFrameBuffer():null),i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,this.renderTargetTexture_),!t){var a=(0,xe.sq)(i.canvas);if(!e.renderTargets[a]){var s=i.getContextAttributes();s&&s.preserveDrawingBuffer&&(i.clearColor(0,0,0,0),i.clear(i.COLOR_BUFFER_BIT)),e.renderTargets[a]=!0}}i.enable(i.BLEND),i.blendFunc(i.ONE,i.ONE_MINUS_SRC_ALPHA),i.viewport(0,0,i.drawingBufferWidth,i.drawingBufferHeight),i.bindBuffer(i.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),i.useProgram(this.renderTargetProgram_),i.enableVertexAttribArray(this.renderTargetAttribLocation_),i.vertexAttribPointer(this.renderTargetAttribLocation_,2,i.FLOAT,!1,0,0),i.uniform2f(this.renderTargetUniformLocation_,o[0],o[1]),i.uniform1i(this.renderTargetTextureLocation_,0);var u=e.layerStatesArray[e.layerIndex].opacity;i.uniform1f(this.renderTargetOpacityLocation_,u),this.applyUniforms(e),r&&r(i,e),i.drawArrays(i.TRIANGLES,0,6),n&&n(i,e)},e.prototype.getFrameBuffer=function(){return this.frameBuffer_},e.prototype.applyUniforms=function(e){var t,r=this.getGL(),n=1;this.uniforms_.forEach((function(i){if((t="function"==typeof i.value?i.value(e):i.value)instanceof HTMLCanvasElement||t instanceof ImageData)i.texture||(i.texture=r.createTexture()),r.activeTexture(r["TEXTURE"+n]),r.bindTexture(r.TEXTURE_2D,i.texture),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),t instanceof ImageData?r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,t.width,t.height,0,r.UNSIGNED_BYTE,new Uint8Array(t.data)):r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,t),r.uniform1i(i.location,n++);else if(Array.isArray(t))switch(t.length){case 2:return void r.uniform2f(i.location,t[0],t[1]);case 3:return void r.uniform3f(i.location,t[0],t[1],t[2]);case 4:return void r.uniform4f(i.location,t[0],t[1],t[2],t[3]);default:return}else"number"==typeof t&&r.uniform1f(i.location,t)}))},e}(),Ee=r(7083);function ke(e,t){return e[0]=t[0],e[1]=t[1],e[4]=t[2],e[5]=t[3],e[12]=t[4],e[13]=t[5],e}var Se=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ae="u_offsetScaleMatrix",Re="u_offsetRotateMatrix",Ce="u_time",Pe="u_zoom",De="u_resolution",Oe=5121,Me=5123,Ie=5125,Le=5126,Ze={};function Ue(e){return"shared/"+e}var Fe=0;function Ge(e){switch(e){case Oe:return Uint8Array.BYTES_PER_ELEMENT;case Me:return Uint16Array.BYTES_PER_ELEMENT;case Ie:return Uint32Array.BYTES_PER_ELEMENT;default:return Float32Array.BYTES_PER_ELEMENT}}var je=function(e){function t(t){var r,n=e.call(this)||this,i=t||{};n.boundHandleWebGLContextLost_=n.handleWebGLContextLost.bind(n),n.boundHandleWebGLContextRestored_=n.handleWebGLContextRestored.bind(n),n.canvasCacheKey_=i.canvasCacheKey?Ue(i.canvasCacheKey):(r="unique/"+Fe,Fe+=1,r),n.canvas_=function(e){var t=Ze[e];if(!t){var r=document.createElement("canvas");r.style.position="absolute",r.style.left="0",t={users:0,canvas:r},Ze[e]=t}return t.users+=1,t.canvas}(n.canvasCacheKey_),n.gl_=oe(n.canvas_),n.bufferCache_={},n.extensionCache_={},n.currentProgram_=null,n.canvas_.addEventListener(be,n.boundHandleWebGLContextLost_),n.canvas_.addEventListener(we,n.boundHandleWebGLContextRestored_),n.offsetRotateMatrix_=(0,Ee.Ue)(),n.offsetScaleMatrix_=(0,Ee.Ue)(),n.tmpMat4_=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],n.uniformLocations_={},n.attribLocations_={},n.uniforms_=[],i.uniforms&&n.setUniforms(i.uniforms);var o=n.getGL();return n.postProcessPasses_=i.postProcesses?i.postProcesses.map((function(e){return new Te({webGlContext:o,scaleRatio:e.scaleRatio,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,uniforms:e.uniforms})})):[new Te({webGlContext:o})],n.shaderCompileErrors_=null,n.startTime_=Date.now(),n}return Se(t,e),t.prototype.setUniforms=function(e){for(var t in this.uniforms_=[],e)this.uniforms_.push({name:t,value:e[t]});this.uniformLocations_={}},t.prototype.canvasCacheKeyMatches=function(e){return this.canvasCacheKey_===Ue(e)},t.prototype.getExtension=function(e){if(e in this.extensionCache_)return this.extensionCache_[e];var t=this.gl_.getExtension(e);return this.extensionCache_[e]=t,t},t.prototype.bindBuffer=function(e){var t=this.getGL(),r=(0,xe.sq)(e),n=this.bufferCache_[r];n||(n={buffer:e,webGlBuffer:t.createBuffer()},this.bufferCache_[r]=n);t.bindBuffer(e.getType(),n.webGlBuffer)},t.prototype.flushBufferData=function(e){var t=this.getGL();this.bindBuffer(e),t.bufferData(e.getType(),e.getArray(),e.getUsage())},t.prototype.deleteBuffer=function(e){var t=this.getGL(),r=(0,xe.sq)(e),n=this.bufferCache_[r];n&&!t.isContextLost()&&t.deleteBuffer(n.webGlBuffer),delete this.bufferCache_[r]},t.prototype.disposeInternal=function(){this.canvas_.removeEventListener(be,this.boundHandleWebGLContextLost_),this.canvas_.removeEventListener(we,this.boundHandleWebGLContextRestored_),function(e){var t=Ze[e];if(t&&(t.users-=1,!(t.users>0))){var r=oe(t.canvas).getExtension("WEBGL_lose_context");r&&r.loseContext(),delete Ze[e]}}(this.canvasCacheKey_),delete this.gl_,delete this.canvas_},t.prototype.prepareDraw=function(e,t){var r=this.getGL(),n=this.getCanvas(),i=e.size,o=e.pixelRatio;n.width=i[0]*o,n.height=i[1]*o,n.style.width=i[0]+"px",n.style.height=i[1]+"px",r.useProgram(this.currentProgram_);for(var a=this.postProcessPasses_.length-1;a>=0;a--)this.postProcessPasses_[a].init(e);r.bindTexture(r.TEXTURE_2D,null),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT),r.enable(r.BLEND),r.blendFunc(r.ONE,t?r.ZERO:r.ONE_MINUS_SRC_ALPHA),r.useProgram(this.currentProgram_),this.applyFrameState(e),this.applyUniforms(e)},t.prototype.prepareDrawToRenderTarget=function(e,t,r){var n=this.getGL(),i=t.getSize();n.bindFramebuffer(n.FRAMEBUFFER,t.getFramebuffer()),n.viewport(0,0,i[0],i[1]),n.bindTexture(n.TEXTURE_2D,t.getTexture()),n.clearColor(0,0,0,0),n.clear(n.COLOR_BUFFER_BIT),n.enable(n.BLEND),n.blendFunc(n.ONE,r?n.ZERO:n.ONE_MINUS_SRC_ALPHA),n.useProgram(this.currentProgram_),this.applyFrameState(e),this.applyUniforms(e)},t.prototype.drawElements=function(e,t){var r=this.getGL();this.getExtension("OES_element_index_uint");var n=r.UNSIGNED_INT,i=t-e,o=4*e;r.drawElements(r.TRIANGLES,i,n,o)},t.prototype.finalizeDraw=function(e,t,r){for(var n=0,i=this.postProcessPasses_.length;n<i;n++)n===i-1?this.postProcessPasses_[n].apply(e,null,t,r):this.postProcessPasses_[n].apply(e,this.postProcessPasses_[n+1])},t.prototype.getCanvas=function(){return this.canvas_},t.prototype.getGL=function(){return this.gl_},t.prototype.applyFrameState=function(e){var t=e.size,r=e.viewState.rotation,n=(0,Ee.mc)(this.offsetScaleMatrix_);(0,Ee.bA)(n,2/t[0],2/t[1]);var i=(0,Ee.mc)(this.offsetRotateMatrix_);0!==r&&(0,Ee.U1)(i,-r),this.setUniformMatrixValue(Ae,ke(this.tmpMat4_,n)),this.setUniformMatrixValue(Re,ke(this.tmpMat4_,i)),this.setUniformFloatValue(Ce,.001*(Date.now()-this.startTime_)),this.setUniformFloatValue(Pe,e.viewState.zoom),this.setUniformFloatValue(De,e.viewState.resolution)},t.prototype.applyUniforms=function(e){var t,r=this.getGL(),n=0;this.uniforms_.forEach(function(i){if((t="function"==typeof i.value?i.value(e):i.value)instanceof HTMLCanvasElement||t instanceof HTMLImageElement||t instanceof ImageData)i.texture||(i.prevValue=void 0,i.texture=r.createTexture()),r.activeTexture(r["TEXTURE"+n]),r.bindTexture(r.TEXTURE_2D,i.texture),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),(!(t instanceof HTMLImageElement)||t.complete)&&i.prevValue!==t&&(i.prevValue=t,r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,t)),r.uniform1i(this.getUniformLocation(i.name),n++);else if(Array.isArray(t)&&6===t.length)this.setUniformMatrixValue(i.name,ke(this.tmpMat4_,t));else if(Array.isArray(t)&&t.length<=4)switch(t.length){case 2:return void r.uniform2f(this.getUniformLocation(i.name),t[0],t[1]);case 3:return void r.uniform3f(this.getUniformLocation(i.name),t[0],t[1],t[2]);case 4:return void r.uniform4f(this.getUniformLocation(i.name),t[0],t[1],t[2],t[3]);default:return}else"number"==typeof t&&r.uniform1f(this.getUniformLocation(i.name),t)}.bind(this))},t.prototype.useProgram=function(e){return e!=this.currentProgram_&&(this.getGL().useProgram(e),this.currentProgram_=e,this.uniformLocations_={},this.attribLocations_={},!0)},t.prototype.compileShader=function(e,t){var r=this.getGL(),n=r.createShader(t);return r.shaderSource(n,e),r.compileShader(n),n},t.prototype.getProgram=function(e,t){var r=this.getGL(),n=this.compileShader(e,r.FRAGMENT_SHADER),i=this.compileShader(t,r.VERTEX_SHADER),o=r.createProgram();if(r.attachShader(o,n),r.attachShader(o,i),r.linkProgram(o),!r.getShaderParameter(n,r.COMPILE_STATUS)){var a="Fragment shader compliation failed: "+r.getShaderInfoLog(n);throw new Error(a)}if(r.deleteShader(n),!r.getShaderParameter(i,r.COMPILE_STATUS)){a="Vertex shader compilation failed: "+r.getShaderInfoLog(i);throw new Error(a)}if(r.deleteShader(i),!r.getProgramParameter(o,r.LINK_STATUS)){a="GL program linking failed: "+r.getShaderInfoLog(i);throw new Error(a)}return o},t.prototype.getUniformLocation=function(e){return void 0===this.uniformLocations_[e]&&(this.uniformLocations_[e]=this.getGL().getUniformLocation(this.currentProgram_,e)),this.uniformLocations_[e]},t.prototype.getAttributeLocation=function(e){return void 0===this.attribLocations_[e]&&(this.attribLocations_[e]=this.getGL().getAttribLocation(this.currentProgram_,e)),this.attribLocations_[e]},t.prototype.makeProjectionTransform=function(e,t){var r=e.size,n=e.viewState.rotation,i=e.viewState.resolution,o=e.viewState.center;return(0,Ee.mc)(t),(0,Ee.qC)(t,0,0,2/(i*r[0]),2/(i*r[1]),-n,-o[0],-o[1]),t},t.prototype.setUniformFloatValue=function(e,t){this.getGL().uniform1f(this.getUniformLocation(e),t)},t.prototype.setUniformMatrixValue=function(e,t){this.getGL().uniformMatrix4fv(this.getUniformLocation(e),!1,t)},t.prototype.enableAttributeArray_=function(e,t,r,n,i){var o=this.getAttributeLocation(e);o<0||(this.getGL().enableVertexAttribArray(o),this.getGL().vertexAttribPointer(o,t,r,!1,n,i))},t.prototype.enableAttributes=function(e){for(var t=function(e){for(var t=0,r=0;r<e.length;r++){var n=e[r];t+=n.size*Ge(n.type)}return t}(e),r=0,n=0;n<e.length;n++){var i=e[n];this.enableAttributeArray_(i.name,i.size,i.type||5126,t,r),r+=i.size*Ge(i.type)}},t.prototype.handleWebGLContextLost=function(){(0,ee.ZH)(this.bufferCache_),this.currentProgram_=null},t.prototype.handleWebGLContextRestored=function(){},t.prototype.createTexture=function(e,t,r){var n=this.getGL(),i=r||n.createTexture(),o=n.RGBA,a=n.RGBA,s=n.UNSIGNED_BYTE;return n.bindTexture(n.TEXTURE_2D,i),t?n.texImage2D(n.TEXTURE_2D,0,o,a,s,t):n.texImage2D(n.TEXTURE_2D,0,o,e[0],e[1],0,a,s,null),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),i},t}(_e.Z),Be=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ne=function(e){function t(t,r){var n=e.call(this,t)||this,i=r||{};return n.inversePixelTransform_=(0,Ee.Ue)(),n.postProcesses_=i.postProcesses,n.uniforms_=i.uniforms,n.helper,t.addChangeListener($.Z.MAP,n.removeHelper_.bind(n)),n.dispatchPreComposeEvent=n.dispatchPreComposeEvent.bind(n),n.dispatchPostComposeEvent=n.dispatchPostComposeEvent.bind(n),n}return Be(t,e),t.prototype.dispatchPreComposeEvent=function(e,t){var r=this.getLayer();if(r.hasListener(ge.Z.PRECOMPOSE)){var n=new ye.Z(ge.Z.PRECOMPOSE,void 0,t,e);r.dispatchEvent(n)}},t.prototype.dispatchPostComposeEvent=function(e,t){var r=this.getLayer();if(r.hasListener(ge.Z.POSTCOMPOSE)){var n=new ye.Z(ge.Z.POSTCOMPOSE,void 0,t,e);r.dispatchEvent(n)}},t.prototype.reset=function(e){this.uniforms_=e.uniforms,this.helper&&this.helper.setUniforms(this.uniforms_)},t.prototype.removeHelper_=function(){this.helper&&(this.helper.dispose(),delete this.helper)},t.prototype.prepareFrame=function(e){if(this.getLayer().getSource()){for(var r=!0,n=-1,i=void 0,o=0,a=e.layerStatesArray.length;o<a;o++){var s=e.layerStatesArray[o].layer,u=s.getRenderer();if(u instanceof t){var l=s.getClassName();if((r||l!==i)&&(n+=1,r=!1),i=l,u===this)break}else r=!0}var c="map/"+e.mapId+"/group/"+n;this.helper&&this.helper.canvasCacheKeyMatches(c)||(this.helper&&this.helper.dispose(),this.helper=new je({postProcesses:this.postProcesses_,uniforms:this.uniforms_,canvasCacheKey:c}),i&&(this.helper.getCanvas().className=i),this.afterHelperCreated())}return this.prepareFrameInternal(e)},t.prototype.afterHelperCreated=function(){},t.prototype.prepareFrameInternal=function(e){return!0},t.prototype.disposeInternal=function(){this.removeHelper_(),e.prototype.disposeInternal.call(this)},t.prototype.dispatchRenderEvent_=function(e,t,r){var n=this.getLayer();if(n.hasListener(e)){(0,Ee.qC)(this.inversePixelTransform_,0,0,r.pixelRatio,-r.pixelRatio,0,0,-r.size[1]);var i=new ye.Z(e,this.inversePixelTransform_,r,t);n.dispatchEvent(i)}},t.prototype.preRender=function(e,t){this.dispatchRenderEvent_(ge.Z.PRERENDER,e,t)},t.prototype.postRender=function(e,t){this.dispatchRenderEvent_(ge.Z.POSTRENDER,e,t)},t}(ve.Z);var ze=Ne,Ve=r(9998),$e=r(7391),Ke=r(832),We=r(8312),He=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),qe="u_tileTextures",Xe="u_tileTransform",Ye="u_transitionAlpha",Qe="u_depth",Je="u_texturePixelWidth",et="u_texturePixelHeight",tt="u_resolution",rt="u_zoom",nt="a_textureCoord",it=[{name:nt,size:2,type:Le}],ot={};function at(e){return 2*(1-1/(e+1))-1}function st(e,t,r){r in e||(e[r]=[]),e[r].push(t)}function ut(e,t){var r=e.layerStatesArray[e.layerIndex];r.extent&&(t=(0,Ke.Ed)(t,(0,$e.dY)(r.extent,e.viewState.projection)));var n=r.layer.getSource();if(!n.getWrapX()){var i=n.tileGrid.getExtent();i&&(t=(0,Ke.Ed)(t,i))}return t}var lt=function(e){function t(t,r){var n=e.call(this,t,{uniforms:r.uniforms})||this;n.tileTransform_=(0,Ee.Ue)(),n.tempMat4_=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],n.tempTileRange_=new H.Z(0,0,0,0),n.tempTileCoord_=(0,Ve.T9)(0,0,0),n.tempSize_=[0,0],n.program_,n.vertexShader_=r.vertexShader,n.fragmentShader_=r.fragmentShader,n.indices_=new fe(re,ne),n.indices_.fromArray([0,1,3,1,2,3]);var i=void 0!==r.cacheSize?r.cacheSize:512;return n.tileTextureCache_=new K.Z(i),n.paletteTextures_=r.paletteTextures||[],n}return He(t,e),t.prototype.reset=function(t){e.prototype.reset.call(this,{uniforms:t.uniforms}),this.vertexShader_=t.vertexShader,this.fragmentShader_=t.fragmentShader,this.paletteTextures_=t.paletteTextures||[],this.helper&&(this.program_=this.helper.getProgram(this.fragmentShader_,this.vertexShader_))},t.prototype.afterHelperCreated=function(){this.program_=this.helper.getProgram(this.fragmentShader_,this.vertexShader_),this.helper.flushBufferData(this.indices_)},t.prototype.isDrawableTile_=function(e){var t=this.getLayer(),r=e.getState(),n=t.getUseInterimTilesOnError();return r==q.Z.LOADED||r==q.Z.EMPTY||r==q.Z.ERROR&&!n},t.prototype.prepareFrameInternal=function(e){var t=this.getLayer().getSource();return!!t&&(!(0,Ke.xb)(ut(e,e.extent))&&t.getState()===W.Z.READY)},t.prototype.enqueueTiles=function(e,t,r,n){var i=e.viewState,o=this.getLayer().getSource(),a=o.getTileGridForProjection(i.projection),s=this.tileTextureCache_,u=a.getTileRangeForExtentAndZ(t,r,this.tempTileRange_),l=(0,xe.sq)(o);l in e.wantedTiles||(e.wantedTiles[l]={});for(var c=e.wantedTiles[l],f=a.getResolution(r),h=u.minX;h<=u.maxX;++h)for(var d=u.minY;d<=u.maxY;++d){var p=(0,Ve.T9)(r,h,d,this.tempTileCoord_),m=(0,Ve.km)(p),v=void 0,y=void 0;if(s.containsKey(m)&&(y=(v=s.get(m)).tile),!v||v.tile.key!==o.getKey())if(y=o.getTile(r,h,d,e.pixelRatio,i.projection),v)if(this.isDrawableTile_(y))v.setTile(y);else{var g=y.getInterimTile();v.setTile(g)}else v=new me(y,a,this.helper),s.set(m,v);st(n,v,r);var b=y.getKey();c[b]=!0,y.getState()===q.Z.IDLE&&(e.tileQueue.isKeyQueued(b)||e.tileQueue.enqueue([y,l,a.getTileCoordCenter(p),f]))}},t.prototype.renderFrame=function(e){var t=this.helper.getGL();this.preRender(t,e);var r=e.viewState,n=this.getLayer().getSource(),i=n.getTileGridForProjection(r.projection),o=ut(e,e.extent),a=i.getZForResolution(r.resolution,n.zDirection),s={};if(e.nextExtent){var u=i.getZForResolution(r.nextResolution,n.zDirection),l=ut(e,e.nextExtent);this.enqueueTiles(e,l,u,s)}this.enqueueTiles(e,o,a,s);for(var c={},f=(0,xe.sq)(this),h=e.time,d=!1,p=s[a],m=0,v=p.length;m<v;++m){var y=(I=(H=p[m]).tile).tileCoord;if(H.loaded){if(1===(L=I.getAlpha(f,h))){I.endTransition(f);continue}d=!0,c[Z=(0,Ve.km)(y)]=L}if(!this.findAltTiles_(i,y,a+1,s))for(var g=i.getMinZoom(),b=a-1;b>=g;--b){if(this.findAltTiles_(i,y,b,s))break}}this.helper.useProgram(this.program_),this.helper.prepareDraw(e,!d);for(var w=Object.keys(s).map(Number).sort(We.kK),_=r.center[0],x=r.center[1],T=0,E=w.length;T<E;++T){var k=w[T],S=i.getResolution(k),A=(0,z.Pq)(i.getTileSize(k),this.tempSize_),R=i.getOrigin(k),C=(_-R[0])/(A[0]*S),P=(R[1]-x)/(A[1]*S),D=r.resolution/S,O=at(k),M=s[k];for(m=0,v=M.length;m<v;++m){if((H=M[m]).loaded){y=(I=H.tile).tileCoord;var I,L,Z=(0,Ve.km)(y),U=y[1],F=y[2];(0,Ee.qC)(this.tileTransform_,0,0,2/(e.size[0]*D/A[0]),-2/(e.size[1]*D/A[1]),r.rotation,-(C-U),-(P-F)),this.helper.setUniformMatrixValue(Xe,ke(this.tempMat4_,this.tileTransform_)),this.helper.bindBuffer(H.coords),this.helper.bindBuffer(this.indices_),this.helper.enableAttributes(it);for(var G=0;G<H.textures.length;){var j="TEXTURE"+G,B=qe+"["+G+"]";t.activeTexture(t[j]),t.bindTexture(t.TEXTURE_2D,H.textures[G]),t.uniform1i(this.helper.getUniformLocation(B),G),++G}for(var N=0;N<this.paletteTextures_.length;++N){var V=this.paletteTextures_[N];t.activeTexture(t["TEXTURE"+G]);var $=V.getTexture(t);t.bindTexture(t.TEXTURE_2D,$),t.uniform1i(this.helper.getUniformLocation(V.name),G),++G}(L=Z in c?c[Z]:1)<1&&(e.animate=!0),this.helper.setUniformFloatValue(Ye,L),this.helper.setUniformFloatValue(Qe,O),this.helper.setUniformFloatValue(Je,A[0]),this.helper.setUniformFloatValue(et,A[1]),this.helper.setUniformFloatValue(tt,r.resolution),this.helper.setUniformFloatValue(rt,r.zoom),this.helper.drawElements(0,this.indices_.getSize())}}}this.helper.finalizeDraw(e,this.dispatchPreComposeEvent,this.dispatchPostComposeEvent);for(var K=this.helper.getCanvas(),W=this.tileTextureCache_;W.canExpireCache();){var H;(H=W.pop()).dispose()}return e.postRenderFunctions.push((function(e,t){n.expireCache(t.viewState.projection,ot)})),this.postRender(t,e),K},t.prototype.findAltTiles_=function(e,t,r,n){var i=e.getTileRangeForTileCoordAndZ(t,r,this.tempTileRange_);if(!i)return!1;for(var o=!0,a=this.tileTextureCache_,s=i.minX;s<=i.maxX;++s)for(var u=i.minY;u<=i.maxY;++u){var l=(0,Ve.lg)(r,s,u),c=!1;if(a.containsKey(l)){var f=a.get(l);f.loaded&&(st(n,f,r),c=!0)}c||(o=!1)}return o},t.prototype.disposeInternal=function(){var t=this.helper,r=t.getGL();t.deleteBuffer(this.indices_),delete this.indices_,r.deleteProgram(this.program_),delete this.program_;var n=this.tileTextureCache_;n.forEach((function(e){e.dispose()})),n.clear(),delete this.tileTextureCache_,e.prototype.disposeInternal.call(this)},t}(ze);lt.prototype.getLayer;var ct=lt,ft=function(){function e(e,t){this.name=e,this.data=t,this.texture_=null}return e.prototype.getTexture=function(e){if(!this.texture_){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,this.data.length/4,1,0,e.RGBA,e.UNSIGNED_BYTE,this.data),this.texture_=t}return this.texture_},e}(),ht=r(5482),dt=r(125),pt=1,mt=2,vt=4,yt=8,gt=16,bt=31,wt=0,_t={};function xt(e){if("number"==typeof e)return pt;if("boolean"==typeof e)return yt;if("string"==typeof e)return(0,ht.e1)(e)?vt|mt:mt;if(!Array.isArray(e))throw new Error("Unhandled value type: "+JSON.stringify(e));var t=e;if(t.every((function(e){return"number"==typeof e})))return 3===t.length||4===t.length?vt|gt:gt;if("string"!=typeof t[0])throw new Error("Expected an expression operator but received: "+JSON.stringify(t));var r=_t[t[0]];if(void 0===r)throw new Error("Unrecognized expression operator: "+JSON.stringify(t));return r.getReturnType(t.slice(1))}function Tt(e){var t=e.toString();return-1===t.indexOf(".")?t+".0":t}function Et(e){if(e.length<2||e.length>4)throw new Error("`formatArray` can only output `vec2`, `vec3` or `vec4` arrays.");return"vec"+e.length+"("+e.map(Tt).join(", ")+")"}function kt(e,t){return void 0===e.stringLiteralsMap[t]&&(e.stringLiteralsMap[t]=Object.keys(e.stringLiteralsMap).length),e.stringLiteralsMap[t]}function St(e,t,r){if(Array.isArray(t)&&"string"==typeof t[0]){var n=_t[t[0]];if(void 0===n)throw new Error("Unrecognized expression operator: "+JSON.stringify(t));return n.toGlsl(e,t.slice(1),r)}var i=xt(t);if((i&pt)>0)return Tt(t);if((i&yt)>0)return t.toString();if((i&mt)>0&&(void 0===r||r==mt))return function(e,t){return Tt(kt(e,t))}(e,t.toString());if((i&vt)>0&&(void 0===r||r==vt))return function(e){var t=(0,ht._2)(e).slice();return t.length<4&&t.push(1),Et(t.map((function(e,t){return t<3?e/255:e})))}(t);if((i&gt)>0)return Et(t);throw new Error("Unexpected expression "+t+" (expected type "+r+")")}function At(e){if(!(xt(e)&pt))throw new Error("A numeric value was expected, got "+JSON.stringify(e)+" instead")}function Rt(e){for(var t=0;t<e.length;t++)At(e[t])}function Ct(e){if(!(xt(e)&mt))throw new Error("A string value was expected, got "+JSON.stringify(e)+" instead")}function Pt(e){if(!(xt(e)&yt))throw new Error("A boolean value was expected, got "+JSON.stringify(e)+" instead")}function Dt(e,t){if(e.length!==t)throw new Error("Exactly "+t+" arguments were expected, got "+e.length+" instead")}function Ot(e,t){if(e.length<t)throw new Error("At least "+t+" arguments were expected, got "+e.length+" instead")}function Mt(e,t){if(e.length>t)throw new Error("At most "+t+" arguments were expected, got "+e.length+" instead")}function It(e){if(e.length%2!=0)throw new Error("An even amount of arguments was expected, got "+e+" instead")}function Lt(e,t){if(r=t,(0,dt.k3)(r)%1!=0)throw new Error("Could not infer only one type from the following expression: "+JSON.stringify(e));var r}function Zt(e){return"u_var_"+e}_t.get={getReturnType:function(e){return bt},toGlsl:function(e,t){Dt(t,1),Ct(t[0]);var r=t[0].toString();return-1===e.attributes.indexOf(r)&&e.attributes.push(r),(e.inFragmentShader?"v_":"a_")+r}},_t.var={getReturnType:function(e){return bt},toGlsl:function(e,t){Dt(t,1),Ct(t[0]);var r=t[0].toString();return-1===e.variables.indexOf(r)&&e.variables.push(r),Zt(r)}};_t.palette={getReturnType:function(e){return vt},toGlsl:function(e,t){Dt(t,2),At(t[0]);var r=St(e,t[0]),n=t[1];if(!Array.isArray(n))throw new Error("The second argument of palette must be an array");for(var i=n.length,o=new Uint8Array(4*i),a=0;a<i;a++){var s=n[a],u=void 0;if("string"==typeof s)u=(0,ht.mL)(s);else{if(!Array.isArray(s))throw new Error("The second argument of palette must be an array of strings or colors");var l=s.length;if(4===l)u=s;else{if(3!==l)throw new Error("Expected palette color to have 3 or 4 values, got "+l);u=[s[0],s[1],s[2],1]}}var c=4*a;o[c]=u[0],o[c+1]=u[1],o[c+2]=u[2],o[c+3]=255*u[3]}e.paletteTextures||(e.paletteTextures=[]);var f="u_paletteTextures["+e.paletteTextures.length+"]",h=new ft(f,o);return e.paletteTextures.push(h),"texture2D("+f+", vec2(("+r+" + 0.5) / "+i+".0, 0.5))"}};var Ut="getBandValue";function Ft(e){return{getReturnType:function(e){return yt},toGlsl:function(t,r){Dt(r,2);for(var n=bt,i=0;i<r.length;i++)n&=xt(r[i]);if(n===wt)throw new Error("All arguments should be of compatible type, got "+JSON.stringify(r)+" instead");return n&=~vt,"("+St(t,r[0],n)+" "+e+" "+St(t,r[1],n)+")"}}}function Gt(e){return{getReturnType:function(e){return yt},toGlsl:function(t,r){Ot(r,2);for(var n=0;n<r.length;n++)Pt(r[n]);return"("+r.map((function(e){return St(t,e)})).join(" "+e+" ")+")"}}}_t.band={getReturnType:function(e){return pt},toGlsl:function(e,t){Ot(t,1),Mt(t,3);var r=t[0];if(!(Ut in e.functions)){for(var n="",i=e.bandCount||1,o=0;o<i;o++){var a=Math.floor(o/4),s=o%4;s===i-1&&1===s&&(s=3),n+="\n          if (band == "+(o+1)+".0) {\n            return texture2D("+(qe+"["+a+"]")+", v_textureCoord + vec2(dx, dy))["+s+"];\n          }\n        "}e.functions.getBandValue="\n        float getBandValue(float band, float xOffset, float yOffset) {\n          float dx = xOffset / "+Je+";\n          float dy = yOffset / "+et+";\n          "+n+"\n        }\n      "}return"getBandValue("+St(e,r)+", "+St(e,t[1]||0)+", "+St(e,t[2]||0)+")"}},_t.time={getReturnType:function(e){return pt},toGlsl:function(e,t){return Dt(t,0),"u_time"}},_t.zoom={getReturnType:function(e){return pt},toGlsl:function(e,t){return Dt(t,0),"u_zoom"}},_t.resolution={getReturnType:function(e){return pt},toGlsl:function(e,t){return Dt(t,0),"u_resolution"}},_t["*"]={getReturnType:function(e){return pt},toGlsl:function(e,t){return Dt(t,2),Rt(t),"("+St(e,t[0])+" * "+St(e,t[1])+")"}},_t["/"]={getReturnType:function(e){return pt},toGlsl:function(e,t){return Dt(t,2),Rt(t),"("+St(e,t[0])+" / "+St(e,t[1])+")"}},_t["+"]={getReturnType:function(e){return pt},toGlsl:function(e,t){return Dt(t,2),Rt(t),"("+St(e,t[0])+" + "+St(e,t[1])+")"}},_t["-"]={getReturnType:function(e){return pt},toGlsl:function(e,t){return Dt(t,2),Rt(t),"("+St(e,t[0])+" - "+St(e,t[1])+")"}},_t.clamp={getReturnType:function(e){return pt},toGlsl:function(e,t){Dt(t,3),Rt(t);var r=St(e,t[1]),n=St(e,t[2]);return"clamp("+St(e,t[0])+", "+r+", "+n+")"}},_t["%"]={getReturnType:function(e){return pt},toGlsl:function(e,t){return Dt(t,2),Rt(t),"mod("+St(e,t[0])+", "+St(e,t[1])+")"}},_t["^"]={getReturnType:function(e){return pt},toGlsl:function(e,t){return Dt(t,2),Rt(t),"pow("+St(e,t[0])+", "+St(e,t[1])+")"}},_t.abs={getReturnType:function(e){return pt},toGlsl:function(e,t){return Dt(t,1),Rt(t),"abs("+St(e,t[0])+")"}},_t.sin={getReturnType:function(e){return pt},toGlsl:function(e,t){return Dt(t,1),Rt(t),"sin("+St(e,t[0])+")"}},_t.cos={getReturnType:function(e){return pt},toGlsl:function(e,t){return Dt(t,1),Rt(t),"cos("+St(e,t[0])+")"}},_t.atan={getReturnType:function(e){return pt},toGlsl:function(e,t){return Ot(t,1),Mt(t,2),Rt(t),2===t.length?"atan("+St(e,t[0])+", "+St(e,t[1])+")":"atan("+St(e,t[0])+")"}},_t[">"]={getReturnType:function(e){return yt},toGlsl:function(e,t){return Dt(t,2),Rt(t),"("+St(e,t[0])+" > "+St(e,t[1])+")"}},_t[">="]={getReturnType:function(e){return yt},toGlsl:function(e,t){return Dt(t,2),Rt(t),"("+St(e,t[0])+" >= "+St(e,t[1])+")"}},_t["<"]={getReturnType:function(e){return yt},toGlsl:function(e,t){return Dt(t,2),Rt(t),"("+St(e,t[0])+" < "+St(e,t[1])+")"}},_t["<="]={getReturnType:function(e){return yt},toGlsl:function(e,t){return Dt(t,2),Rt(t),"("+St(e,t[0])+" <= "+St(e,t[1])+")"}},_t["=="]=Ft("=="),_t["!="]=Ft("!="),_t["!"]={getReturnType:function(e){return yt},toGlsl:function(e,t){return Dt(t,1),Pt(t[0]),"(!"+St(e,t[0])+")"}},_t.all=Gt("&&"),_t.any=Gt("||"),_t.between={getReturnType:function(e){return yt},toGlsl:function(e,t){Dt(t,3),Rt(t);var r=St(e,t[1]),n=St(e,t[2]),i=St(e,t[0]);return"("+i+" >= "+r+" && "+i+" <= "+n+")"}},_t.array={getReturnType:function(e){return gt},toGlsl:function(e,t){Ot(t,2),Mt(t,4),Rt(t);var r=t.map((function(t){return St(e,t,pt)}));return"vec"+t.length+"("+r.join(", ")+")"}},_t.color={getReturnType:function(e){return vt},toGlsl:function(e,t){Ot(t,3),Mt(t,4),Rt(t);var r=t;3===t.length&&r.push(1);var n=t.map((function(t,r){return St(e,t,pt)+(r<3?" / 255.0":"")}));return"vec"+t.length+"("+n.join(", ")+")"}},_t.interpolate={getReturnType:function(e){for(var t=vt|pt,r=3;r<e.length;r+=2)t&=xt(e[r]);return t},toGlsl:function(e,t,r){It(t),Ot(t,6);var n,i=t[0];switch(i[0]){case"linear":n=1;break;case"exponential":n=i[1];break;default:n=null}if(!n)throw new Error('Invalid interpolation type for "interpolate" operator, received: '+JSON.stringify(i));var o=void 0!==r?r:bt,a=_t.interpolate.getReturnType(t)&o;Lt(t,a);for(var s=St(e,t[1]),u=Tt(n),l="",c=2;c<t.length-2;c+=2){var f=St(e,t[c]),h=l||St(e,t[c+1],a),d=St(e,t[c+2]);l="mix("+h+", "+St(e,t[c+3],a)+", pow(clamp(("+s+" - "+f+") / ("+d+" - "+f+"), 0.0, 1.0), "+u+"))"}return l}},_t.match={getReturnType:function(e){for(var t=bt,r=2;r<e.length;r+=2)t&=xt(e[r]);return t&=xt(e[e.length-1])},toGlsl:function(e,t,r){It(t),Ot(t,4);var n=void 0!==r?r:bt,i=_t.match.getReturnType(t)&n;Lt(t,i);for(var o=St(e,t[0]),a=St(e,t[t.length-1],i),s=null,u=t.length-3;u>=1;u-=2){s="("+o+" == "+St(e,t[u])+" ? "+St(e,t[u+1],i)+" : "+(s||a)+")"}return s}},_t.case={getReturnType:function(e){for(var t=bt,r=1;r<e.length;r+=2)t&=xt(e[r]);return t&=xt(e[e.length-1])},toGlsl:function(e,t,r){!function(e){if(e.length%2==0)throw new Error("An odd amount of arguments was expected, got "+e+" instead")}(t),Ot(t,3);var n=void 0!==r?r:bt,i=_t.case.getReturnType(t)&n;Lt(t,i);for(var o=0;o<t.length-1;o+=2)Pt(t[o]);var a=St(e,t[t.length-1],i),s=null;for(o=t.length-3;o>=0;o-=2){s="("+St(e,t[o])+" ? "+St(e,t[o+1],i)+" : "+(s||a)+")"}return s}};var jt=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function Bt(e,t){var r="\n    attribute vec2 "+nt+";\n    uniform mat4 "+Xe+";\n    uniform float "+Qe+";\n\n    varying vec2 v_textureCoord;\n\n    void main() {\n      v_textureCoord = "+nt+";\n      gl_Position = "+Xe+" * vec4("+nt+", "+Qe+", 1.0);\n    }\n  ",n={inFragmentShader:!0,variables:[],attributes:[],stringLiteralsMap:{},functions:{},bandCount:t},i=[];if(void 0!==e.color){var o=St(n,e.color,vt);i.push("color = "+o+";")}if(void 0!==e.contrast){var a=St(n,e.contrast,pt);i.push("color.rgb = clamp(("+a+" + 1.0) * color.rgb - ("+a+" / 2.0), vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));")}if(void 0!==e.exposure){var s=St(n,e.exposure,pt);i.push("color.rgb = clamp(("+s+" + 1.0) * color.rgb, vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));")}if(void 0!==e.saturation){var u=St(n,e.saturation,pt);i.push("\n      float saturation = "+u+" + 1.0;\n      float sr = (1.0 - saturation) * 0.2126;\n      float sg = (1.0 - saturation) * 0.7152;\n      float sb = (1.0 - saturation) * 0.0722;\n      mat3 saturationMatrix = mat3(\n        sr + saturation, sr, sr,\n        sg, sg + saturation, sg,\n        sb, sb, sb + saturation\n      );\n      color.rgb = clamp(saturationMatrix * color.rgb, vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));\n    ")}if(void 0!==e.gamma){var l=St(n,e.gamma,pt);i.push("color.rgb = pow(color.rgb, vec3(1.0 / "+l+"));")}if(void 0!==e.brightness){var c=St(n,e.brightness,pt);i.push("color.rgb = clamp(color.rgb + "+c+", vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));")}var f={},h=n.variables.length;if(h>1&&!e.variables)throw new Error("Missing variables in style (expected "+n.variables+")");for(var d=function(t){var r=n.variables[t];if(!(r in e.variables))throw new Error("Missing '"+r+"' in style variables");var i=Zt(r);f[i]=function(){var t=e.variables[r];return"string"==typeof t&&(t=kt(n,t)),void 0!==t?t:-9999999}},p=0;p<h;++p)d(p);var m=Object.keys(f).map((function(e){return"uniform float "+e+";"})),v=Math.ceil(t/4);m.push("uniform sampler2D "+qe+"["+v+"];"),n.paletteTextures&&m.push("uniform sampler2D u_paletteTextures["+n.paletteTextures.length+"];");var y=Object.keys(n.functions).map((function(e){return n.functions[e]}));return{vertexShader:r,fragmentShader:"\n    #ifdef GL_FRAGMENT_PRECISION_HIGH\n    precision highp float;\n    #else\n    precision mediump float;\n    #endif\n\n    varying vec2 v_textureCoord;\n    uniform float "+Ye+";\n    uniform float "+Je+";\n    uniform float "+et+";\n    uniform float "+tt+";\n    uniform float "+rt+";\n\n    "+m.join("\n")+"\n\n    "+y.join("\n")+"\n\n    void main() {\n      vec4 color = texture2D("+qe+"[0],  v_textureCoord);\n\n      "+i.join("\n")+"\n\n      if (color.a == 0.0) {\n        discard;\n      }\n\n      gl_FragColor = color;\n      gl_FragColor.rgb *= gl_FragColor.a;\n      gl_FragColor *= "+Ye+";\n    }",uniforms:f,paletteTextures:n.paletteTextures}}var Nt=function(e){function t(t){var r=this,n=t?(0,ee.f0)({},t):{},i=n.style||{};delete n.style;var o=n.cacheSize;return delete n.cacheSize,(r=e.call(this,n)||this).style_=i,r.cacheSize_=o,r.styleVariables_=r.style_.variables||{},r.addChangeListener($.Z.SOURCE,r.handleSourceUpdate_),r}return jt(t,e),t.prototype.handleSourceUpdate_=function(){this.setStyle(this.style_)},t.prototype.getSourceBandCount_=function(){var e=this.getSource();return e&&"bandCount"in e?e.bandCount:4},t.prototype.createRenderer=function(){var e=Bt(this.style_,this.getSourceBandCount_());return new ct(this,{vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,uniforms:e.uniforms,cacheSize:this.cacheSize_,paletteTextures:e.paletteTextures})},t.prototype.setStyle=function(e){this.style_=e;var t=Bt(this.style_,this.getSourceBandCount_());this.getRenderer().reset({vertexShader:t.vertexShader,fragmentShader:t.fragmentShader,uniforms:t.uniforms,paletteTextures:t.paletteTextures}),this.changed()},t.prototype.updateStyleVariables=function(e){(0,ee.f0)(this.styleVariables_,e),this.changed()},t}(V.Z);Nt.prototype.dispose;var zt=Nt,Vt=r(9894),$t=r(9044),Kt=r(1842),Wt=r(8935),Ht=r(8945),qt=r(7326),Xt=r(4578),Yt=r(4533),Qt=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Jt=function(e){function t(t){var r=this,n=q.Z.IDLE;return(r=e.call(this,t.tileCoord,n,{transition:t.transition,interpolate:t.interpolate})||this).loader_=t.loader,r.data_=null,r.error_=null,r}return Qt(t,e),t.prototype.getData=function(){return this.data_},t.prototype.getError=function(){return this.error_},t.prototype.load=function(){this.state=q.Z.LOADING,this.changed();var e=this;this.loader_().then((function(t){e.data_=t,e.state=q.Z.LOADED,e.changed()})).catch((function(t){e.error_=t,e.state=q.Z.ERROR,e.changed()}))},t}(Yt.Z),er=r(6362),tr=r(4973),rr=r(147),nr=r(5594),ir=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),or=function(e){function t(t){var r=this,n=void 0===t.projection?"EPSG:3857":t.projection,i=t.tileGrid;return void 0===i&&n&&(i=(0,rr.dl)({extent:(0,rr.Tl)(n),maxResolution:t.maxResolution,maxZoom:t.maxZoom,minZoom:t.minZoom,tileSize:t.tileSize})),(r=e.call(this,{cacheSize:.1,projection:n,tileGrid:i,opaque:t.opaque,state:t.state,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate})||this).tileLoadingKeys_={},r.loader_=t.loader,r.handleTileChange_=r.handleTileChange_.bind(r),r.bandCount=void 0===t.bandCount?4:t.bandCount,r}return ir(t,e),t.prototype.setLoader=function(e){this.loader_=e},t.prototype.getTile=function(e,t,r,n,i){var o=(0,Ve.lg)(e,t,r);if(this.tileCache.containsKey(o))return this.tileCache.get(o);var a=this.loader_;var s=new Jt((0,ee.f0)({tileCoord:[e,t,r],loader:function(){return(0,nr.Vi)((function(){return a(e,t,r)}))}},this.tileOptions));return s.key=this.getKey(),s.addEventListener(Y.Z.CHANGE,this.handleTileChange_),this.tileCache.set(o,s),s},t.prototype.handleTileChange_=function(e){var t,r=e.target,n=(0,xe.sq)(r),i=r.getState();i==q.Z.LOADING?(this.tileLoadingKeys_[n]=!0,t=er.Z.TILELOADSTART):n in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[n],t=i==q.Z.ERROR?er.Z.TILELOADERROR:i==q.Z.LOADED?er.Z.TILELOADEND:void 0),t&&this.dispatchEvent(new tr.s(t,r))},t}(tr.Z),ar=r(7053);var sr,ur=r(9160),lr=r(9498),cr=lr.Pool,fr=lr.fromUrl,hr=lr.fromBlob,dr="STATISTICS_MAXIMUM",pr="STATISTICS_MINIMUM";function mr(){var e,t;return sr||(sr=new cr(void 0,(e=new Blob(['function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function asyncGeneratorStep(e,t,r,n,a,i,o){try{var s=e[i](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,a)}function _asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){asyncGeneratorStep(i,n,a,o,s,"next",e)}function s(e){asyncGeneratorStep(i,n,a,o,s,"throw",e)}o(void 0)}))}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(e,"prototype",{value:Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),writable:!1}),t&&_setPrototypeOf(e,t)}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn\'t been initialised - super() hasn\'t been called");return e}function _possibleConstructorReturn(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var r,n=_getPrototypeOf(e);if(t){var a=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var runtime={exports:{}};!function(e){var t=function(e){var t,r=Object.prototype,n=r.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",o=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function f(e,t,r,n){var a=t&&t.prototype instanceof g?t:g,i=Object.create(a.prototype),o=new A(n||[]);return i._invoke=function(e,t,r){var n=u;return function(a,i){if(n===h)throw new Error("Generator is already running");if(n===p){if("throw"===a)throw i;return I()}for(r.method=a,r.arg=i;;){var o=r.delegate;if(o){var s=x(o,r);if(s){if(s===m)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===u)throw n=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=h;var l=c(e,t,r);if("normal"===l.type){if(n=r.done?p:d,l.arg===m)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n=p,r.method="throw",r.arg=l.arg)}}}(e,r,o),i}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=f;var u="suspendedStart",d="suspendedYield",h="executing",p="completed",m={};function g(){}function y(){}function _(){}var b={};l(b,i,(function(){return this}));var v=Object.getPrototypeOf,w=v&&v(v(M([])));w&&w!==r&&n.call(w,i)&&(b=w);var k=_.prototype=g.prototype=Object.create(b);function T(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function r(a,i,o,s){var l=c(e[a],e,i);if("throw"!==l.type){var f=l.arg,u=f.value;return u&&"object"===_typeof(u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){r("next",e,o,s)}),(function(e){r("throw",e,o,s)})):t.resolve(u).then((function(e){f.value=e,o(f)}),(function(e){return r("throw",e,o,s)}))}s(l.arg)}var a;this._invoke=function(e,n){function i(){return new t((function(t,a){r(e,n,t,a)}))}return a=a?a.then(i,i):i()}}function x(e,r){var n=e.iterator[r.method];if(n===t){if(r.delegate=null,"throw"===r.method){if(e.iterator.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method))return m;r.method="throw",r.arg=new TypeError("The iterator does not provide a \'throw\' method")}return m}var a=c(n,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,m;var i=a.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function D(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function M(e){if(e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,o=function r(){for(;++a<e.length;)if(n.call(e,a))return r.value=e[a],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}return{next:I}}function I(){return{value:t,done:!0}}return y.prototype=_,l(k,"constructor",_),l(_,"constructor",y),y.displayName=l(_,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,l(e,s,"GeneratorFunction")),e.prototype=Object.create(k),e},e.awrap=function(e){return{__await:e}},T(E.prototype),l(E.prototype,o,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,a,i){void 0===i&&(i=Promise);var o=new E(f(t,r,n,a),i);return e.isGeneratorFunction(r)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},T(k),l(k,s,"Generator"),l(k,i,(function(){return this})),l(k,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=M,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(D),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function a(n,a){return s.type="throw",s.arg=e,r.next=n,a&&(r.method="next",r.arg=t),!!a}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return a("end");if(o.tryLoc<=this.prev){var l=n.call(o,"catchLoc"),f=n.call(o,"finallyLoc");if(l&&f){if(this.prev<o.catchLoc)return a(o.catchLoc,!0);if(this.prev<o.finallyLoc)return a(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return a(o.catchLoc,!0)}else{if(!f)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return a(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),D(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;D(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:M(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}(e.exports);try{regeneratorRuntime=t}catch(e){"object"===("undefined"==typeof globalThis?"undefined":_typeof(globalThis))?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}}(runtime);var worker={},isObservable=function(e){return!!e&&("symbol"===_typeof(Symbol.observable)&&"function"==typeof e[Symbol.observable]?e===e[Symbol.observable]():"function"==typeof e["@@observable"]&&e===e["@@observable"]())},common$1={},serializers={};function extendSerializer(e,t){var r=e.deserialize.bind(e),n=e.serialize.bind(e);return{deserialize:function(e){return t.deserialize(e,r)},serialize:function(e){return t.serialize(e,n)}}}Object.defineProperty(serializers,"__esModule",{value:!0}),serializers.DefaultSerializer=serializers.extendSerializer=void 0,serializers.extendSerializer=extendSerializer;var DefaultErrorSerializer={deserialize:function(e){return Object.assign(Error(e.message),{name:e.name,stack:e.stack})},serialize:function(e){return{__error_marker:"$$error",message:e.message,name:e.name,stack:e.stack}}},isSerializedError=function(e){return e&&"object"===_typeof(e)&&"__error_marker"in e&&"$$error"===e.__error_marker};serializers.DefaultSerializer={deserialize:function(e){return isSerializedError(e)?DefaultErrorSerializer.deserialize(e):e},serialize:function(e){return e instanceof Error?DefaultErrorSerializer.serialize(e):e}},Object.defineProperty(common$1,"__esModule",{value:!0}),common$1.serialize=common$1.deserialize=common$1.registerSerializer=void 0;var serializers_1=serializers,registeredSerializer=serializers_1.DefaultSerializer;function registerSerializer(e){registeredSerializer=serializers_1.extendSerializer(registeredSerializer,e)}function deserialize(e){return registeredSerializer.deserialize(e)}function serialize(e){return registeredSerializer.serialize(e)}common$1.registerSerializer=registerSerializer,common$1.deserialize=deserialize,common$1.serialize=serialize;var transferable={},symbols={};Object.defineProperty(symbols,"__esModule",{value:!0}),symbols.$worker=symbols.$transferable=symbols.$terminate=symbols.$events=symbols.$errors=void 0,symbols.$errors=Symbol("thread.errors"),symbols.$events=Symbol("thread.events"),symbols.$terminate=Symbol("thread.terminate"),symbols.$transferable=Symbol("thread.transferable"),symbols.$worker=Symbol("thread.worker"),Object.defineProperty(transferable,"__esModule",{value:!0}),transferable.Transfer=transferable.isTransferDescriptor=void 0;var symbols_1=symbols;function isTransferable(e){return!(!e||"object"!==_typeof(e))}function isTransferDescriptor(e){return e&&"object"===_typeof(e)&&e[symbols_1.$transferable]}function Transfer$1(e,t){var r;if(!t){if(!isTransferable(e))throw Error();t=[e]}return _defineProperty(r={},symbols_1.$transferable,!0),_defineProperty(r,"send",e),_defineProperty(r,"transferables",t),r}transferable.isTransferDescriptor=isTransferDescriptor,transferable.Transfer=Transfer$1;var messages$1={},exports,MasterMessageType,WorkerMessageType;exports=messages$1,Object.defineProperty(exports,"__esModule",{value:!0}),exports.WorkerMessageType=exports.MasterMessageType=void 0,(MasterMessageType=exports.MasterMessageType||(exports.MasterMessageType={})).cancel="cancel",MasterMessageType.run="run",(WorkerMessageType=exports.WorkerMessageType||(exports.WorkerMessageType={})).error="error",WorkerMessageType.init="init",WorkerMessageType.result="result",WorkerMessageType.running="running",WorkerMessageType.uncaughtError="uncaughtError";var implementation$1={},implementation_browser={};Object.defineProperty(implementation_browser,"__esModule",{value:!0});var isWorkerRuntime$2=function(){var e="undefined"!=typeof self&&"undefined"!=typeof Window&&self instanceof Window;return!("undefined"==typeof self||!self.postMessage||e)},postMessageToMaster$2=function(e,t){self.postMessage(e,t)},subscribeToMasterMessages$2=function(e){var t=function(t){e(t.data)};return self.addEventListener("message",t),function(){self.removeEventListener("message",t)}};implementation_browser.default={isWorkerRuntime:isWorkerRuntime$2,postMessageToMaster:postMessageToMaster$2,subscribeToMasterMessages:subscribeToMasterMessages$2};var implementation_tinyWorker={};Object.defineProperty(implementation_tinyWorker,"__esModule",{value:!0}),"undefined"==typeof self&&(commonjsGlobal.self=commonjsGlobal);var isWorkerRuntime$1=function(){return!("undefined"==typeof self||!self.postMessage)},postMessageToMaster$1=function(e){self.postMessage(e)},muxingHandlerSetUp=!1,messageHandlers=new Set,subscribeToMasterMessages$1=function(e){muxingHandlerSetUp||(self.addEventListener("message",(function(e){messageHandlers.forEach((function(t){return t(e.data)}))})),muxingHandlerSetUp=!0),messageHandlers.add(e);return function(){return messageHandlers.delete(e)}};implementation_tinyWorker.default={isWorkerRuntime:isWorkerRuntime$1,postMessageToMaster:postMessageToMaster$1,subscribeToMasterMessages:subscribeToMasterMessages$1};var implementation_worker_threads={},worker_threads={},implementation;function selectImplementation(){return"function"==typeof __non_webpack_require__?__non_webpack_require__("worker_threads"):eval("require")("worker_threads")}function getImplementation(){return implementation||(implementation=selectImplementation()),implementation}Object.defineProperty(worker_threads,"__esModule",{value:!0}),worker_threads.default=getImplementation;var __importDefault$1=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(implementation_worker_threads,"__esModule",{value:!0});var worker_threads_1=__importDefault$1(worker_threads);function assertMessagePort(e){if(!e)throw Error("Invariant violation: MessagePort to parent is not available.");return e}var isWorkerRuntime=function(){return!worker_threads_1.default().isMainThread},postMessageToMaster=function(e,t){assertMessagePort(worker_threads_1.default().parentPort).postMessage(e,t)},subscribeToMasterMessages=function(e){var t=worker_threads_1.default().parentPort;if(!t)throw Error("Invariant violation: MessagePort to parent is not available.");var r=function(t){e(t)};return assertMessagePort(t).on("message",r),function(){assertMessagePort(t).off("message",r)}};function testImplementation(){worker_threads_1.default()}implementation_worker_threads.default={isWorkerRuntime:isWorkerRuntime,postMessageToMaster:postMessageToMaster,subscribeToMasterMessages:subscribeToMasterMessages,testImplementation:testImplementation};var __importDefault=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(implementation$1,"__esModule",{value:!0});var implementation_browser_1=__importDefault(implementation_browser),implementation_tiny_worker_1=__importDefault(implementation_tinyWorker),implementation_worker_threads_1=__importDefault(implementation_worker_threads),runningInNode="undefined"!=typeof process&&"browser"!==process.arch&&"pid"in process;function selectNodeImplementation(){try{return implementation_worker_threads_1.default.testImplementation(),implementation_worker_threads_1.default}catch(e){return implementation_tiny_worker_1.default}}implementation$1.default=runningInNode?selectNodeImplementation():implementation_browser_1.default,function(e){var t=commonjsGlobal&&commonjsGlobal.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{l(n.next(e))}catch(e){i(e)}}function s(e){try{l(n.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}l((n=n.apply(e,t||[])).next())}))},r=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e,"__esModule",{value:!0}),e.expose=e.isWorkerRuntime=e.Transfer=e.registerSerializer=void 0;var n=r(isObservable),a=common$1,i=transferable,o=messages$1,s=r(implementation$1),l=common$1;Object.defineProperty(e,"registerSerializer",{enumerable:!0,get:function(){return l.registerSerializer}});var f=transferable;Object.defineProperty(e,"Transfer",{enumerable:!0,get:function(){return f.Transfer}}),e.isWorkerRuntime=s.default.isWorkerRuntime;var c=!1,u=new Map,d=function(e){return e&&e.type===o.MasterMessageType.run},h=function(e){return n.default(e)||function(e){return e&&"object"===_typeof(e)&&"function"==typeof e.subscribe}(e)};function p(e){return i.isTransferDescriptor(e)?{payload:e.send,transferables:e.transferables}:{payload:e,transferables:void 0}}function m(e,t){var r=p(t),n=r.payload,i=r.transferables,l={type:o.WorkerMessageType.error,uid:e,error:a.serialize(n)};s.default.postMessageToMaster(l,i)}function g(e,t,r){var n=p(r),a=n.payload,i=n.transferables,l={type:o.WorkerMessageType.result,uid:e,complete:!!t||void 0,payload:a};s.default.postMessageToMaster(l,i)}function y(e,t){var r={type:o.WorkerMessageType.running,uid:e,resultType:t};s.default.postMessageToMaster(r)}function _(e){try{var t={type:o.WorkerMessageType.uncaughtError,error:a.serialize(e)};s.default.postMessageToMaster(t)}catch(t){console.error("Not reporting uncaught error back to master thread as it occured while reporting an uncaught error already.\\nLatest error:",t,"\\nOriginal error:",e)}}function b(e,r,n){return t(this,void 0,void 0,regeneratorRuntime.mark((function t(){var i,o,s,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.prev=0,i=r.apply(void 0,_toConsumableArray(n)),t.next=7;break;case 4:return t.prev=4,t.t0=t.catch(0),t.abrupt("return",m(e,t.t0));case 7:if(o=h(i)?"observable":"promise",y(e,o),!h(i)){t.next=14;break}s=i.subscribe((function(t){return g(e,!1,a.serialize(t))}),(function(t){m(e,a.serialize(t)),u.delete(e)}),(function(){g(e,!0),u.delete(e)})),u.set(e,s),t.next=24;break;case 14:return t.prev=14,t.next=17,i;case 17:l=t.sent,g(e,!0,a.serialize(l)),t.next=24;break;case 21:t.prev=21,t.t1=t.catch(14),m(e,a.serialize(t.t1));case 24:case"end":return t.stop()}}),t,null,[[0,4],[14,21]])})))}e.expose=function(e){if(!s.default.isWorkerRuntime())throw Error("expose() called in the master thread.");if(c)throw Error("expose() called more than once. This is not possible. Pass an object to expose() if you want to expose multiple functions.");if(c=!0,"function"==typeof e)s.default.subscribeToMasterMessages((function(t){d(t)&&!t.method&&b(t.uid,e,t.args.map(a.deserialize))})),t={type:o.WorkerMessageType.init,exposed:{type:"function"}},s.default.postMessageToMaster(t);else{if("object"!==_typeof(e)||!e)throw Error("Invalid argument passed to expose(). Expected a function or an object, got: ".concat(e));s.default.subscribeToMasterMessages((function(t){d(t)&&t.method&&b(t.uid,e[t.method],t.args.map(a.deserialize))})),function(e){var t={type:o.WorkerMessageType.init,exposed:{type:"module",methods:e}};s.default.postMessageToMaster(t)}(Object.keys(e).filter((function(t){return"function"==typeof e[t]})))}var t;s.default.subscribeToMasterMessages((function(e){if((n=e)&&n.type===o.MasterMessageType.cancel){var t=e.uid,r=u.get(t);r&&(r.unsubscribe(),u.delete(t))}var n}))},"undefined"!=typeof self&&"function"==typeof self.addEventListener&&s.default.isWorkerRuntime()&&(self.addEventListener("error",(function(e){setTimeout((function(){return _(e.error||e)}),250)})),self.addEventListener("unhandledrejection",(function(e){var t=e.reason;t&&"string"==typeof t.message&&setTimeout((function(){return _(t)}),250)}))),"undefined"!=typeof process&&"function"==typeof process.on&&s.default.isWorkerRuntime()&&(process.on("uncaughtException",(function(e){setTimeout((function(){return _(e)}),250)})),process.on("unhandledRejection",(function(e){e&&"string"==typeof e.message&&setTimeout((function(){return _(e)}),250)})))}(worker);var WorkerContext=getDefaultExportFromCjs(worker),expose=WorkerContext.expose;WorkerContext.registerSerializer;var Transfer=WorkerContext.Transfer,registry=new Map;function addDecoder(e,t){Array.isArray(e)||(e=[e]),e.forEach((function(e){return registry.set(e,t)}))}function getDecoder(e){return _getDecoder.apply(this,arguments)}function _getDecoder(){return(_getDecoder=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=registry.get(t.Compression)){e.next=3;break}throw new Error("Unknown compression method identifier: ".concat(t.Compression));case 3:return e.next=5,r();case 5:return n=e.sent,e.abrupt("return",new n(t));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function decode(e,t){return _decode.apply(this,arguments)}function _decode(){return(_decode=_asyncToGenerator(regeneratorRuntime.mark((function e(t,r){var n,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,getDecoder(t);case 2:return n=e.sent,e.next=5,n.decode(t,r);case 5:return a=e.sent,e.abrupt("return",Transfer(a));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function decodeRowAcc(e,t){var r=e.length-t,n=0;do{for(var a=t;a>0;a--)e[n+t]+=e[n],n++;r-=t}while(r>0)}function decodeRowFloatingPoint(e,t,r){for(var n=0,a=e.length,i=a/r;a>t;){for(var o=t;o>0;--o)e[n+t]+=e[n],++n;a-=t}for(var s=e.slice(),l=0;l<i;++l)for(var f=0;f<r;++f)e[r*l+f]=s[(r-f-1)*i+l]}function applyPredictor(e,t,r,n,a,i){if(!t||1===t)return e;for(var o=0;o<a.length;++o){if(a[o]%8!=0)throw new Error("When decoding with predictor, only multiple of 8 bits are supported.");if(a[o]!==a[0])throw new Error("When decoding with predictor, all samples must have the same size.")}for(var s=a[0]/8,l=2===i?1:a.length,f=0;f<n&&!(f*l*r*s>=e.byteLength);++f){var c=void 0;if(2===t){switch(a[0]){case 8:c=new Uint8Array(e,f*l*r*s,l*r*s);break;case 16:c=new Uint16Array(e,f*l*r*s,l*r*s/2);break;case 32:c=new Uint32Array(e,f*l*r*s,l*r*s/4);break;default:throw new Error("Predictor 2 not allowed with ".concat(a[0]," bits per sample."))}decodeRowAcc(c,l)}else 3===t&&decodeRowFloatingPoint(c=new Uint8Array(e,f*l*r*s,l*r*s),l,s)}return e}addDecoder([void 0,1],(function(){return Promise.resolve().then((function(){return raw})).then((function(e){return e.default}))})),addDecoder(5,(function(){return Promise.resolve().then((function(){return lzw})).then((function(e){return e.default}))})),addDecoder(6,(function(){throw new Error("old style JPEG compression is not supported.")})),addDecoder(7,(function(){return Promise.resolve().then((function(){return jpeg})).then((function(e){return e.default}))})),addDecoder([8,32946],(function(){return Promise.resolve().then((function(){return deflate})).then((function(e){return e.default}))})),addDecoder(32773,(function(){return Promise.resolve().then((function(){return packbits})).then((function(e){return e.default}))})),addDecoder(34887,(function(){return Promise.resolve().then((function(){return lerc})).then((function(e){return e.default}))})),expose(decode);var BaseDecoder=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"decode",value:function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(t,r){var n,a,i,o,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.decodeBlock(r);case 2:if(n=e.sent,1===(a=t.Predictor||1)){e.next=9;break}return i=!t.StripOffsets,o=i?t.TileWidth:t.ImageWidth,s=i?t.TileLength:t.RowsPerStrip||t.ImageLength,e.abrupt("return",applyPredictor(n,a,o,s,t.BitsPerSample,t.PlanarConfiguration));case 9:return e.abrupt("return",n);case 10:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()}]),e}(),RawDecoder=function(e){_inherits(r,BaseDecoder);var t=_createSuper(r);function r(){return _classCallCheck(this,r),t.apply(this,arguments)}return _createClass(r,[{key:"decodeBlock",value:function(e){return e}}]),r}(),raw=Object.freeze({__proto__:null,default:RawDecoder}),MIN_BITS=9,CLEAR_CODE=256,EOI_CODE=257,MAX_BYTELENGTH=12;function getByte(e,t,r){var n=t%8,a=Math.floor(t/8),i=8-n,o=t+r-8*(a+1),s=8*(a+2)-(t+r),l=8*(a+2)-t;if(s=Math.max(0,s),a>=e.length)return console.warn("ran off the end of the buffer before finding EOI_CODE (end on input code)"),EOI_CODE;var f=e[a]&Math.pow(2,8-n)-1,c=f<<=r-i;if(a+1<e.length){var u=e[a+1]>>>s;c+=u<<=Math.max(0,r-l)}if(o>8&&a+2<e.length){var d=8*(a+3)-(t+r);c+=e[a+2]>>>d}return c}function appendReversed(e,t){for(var r=t.length-1;r>=0;r--)e.push(t[r]);return e}function decompress(e){for(var t=new Uint16Array(4093),r=new Uint8Array(4093),n=0;n<=257;n++)t[n]=4096,r[n]=n;var a=258,i=MIN_BITS,o=0;function s(){a=258,i=MIN_BITS}function l(e){var t=getByte(e,o,i);return o+=i,t}function f(e,n){return r[a]=n,t[a]=e,++a-1}function c(e){for(var n=[],a=e;4096!==a;a=t[a])n.push(r[a]);return n}var u=[];s();for(var d,h=new Uint8Array(e),p=l(h);p!==EOI_CODE;){if(p===CLEAR_CODE){for(s(),p=l(h);p===CLEAR_CODE;)p=l(h);if(p===EOI_CODE)break;if(p>CLEAR_CODE)throw new Error("corrupted code at scanline ".concat(p));appendReversed(u,c(p)),d=p}else if(p<a){var m=c(p);appendReversed(u,m),f(d,m[m.length-1]),d=p}else{var g=c(d);if(!g)throw new Error("Bogus entry. Not in dictionary, ".concat(d," / ").concat(a,", position: ").concat(o));appendReversed(u,g),u.push(g[g.length-1]),f(d,g[g.length-1]),d=p}a+1>=Math.pow(2,i)&&(i===MAX_BYTELENGTH?d=void 0:i++),p=l(h)}return new Uint8Array(u)}var LZWDecoder=function(e){_inherits(r,BaseDecoder);var t=_createSuper(r);function r(){return _classCallCheck(this,r),t.apply(this,arguments)}return _createClass(r,[{key:"decodeBlock",value:function(e){return decompress(e).buffer}}]),r}(),lzw=Object.freeze({__proto__:null,default:LZWDecoder}),dctZigZag=new Int32Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),dctCos1=4017,dctSin1=799,dctCos3=3406,dctSin3=2276,dctCos6=1567,dctSin6=3784,dctSqrt2=5793,dctSqrt1d2=2896;function buildHuffmanTable(e,t){for(var r=0,n=[],a=16;a>0&&!e[a-1];)--a;n.push({children:[],index:0});for(var i,o=n[0],s=0;s<a;s++){for(var l=0;l<e[s];l++){for((o=n.pop()).children[o.index]=t[r];o.index>0;)o=n.pop();for(o.index++,n.push(o);n.length<=s;)n.push(i={children:[],index:0}),o.children[o.index]=i.children,o=i;r++}s+1<a&&(n.push(i={children:[],index:0}),o.children[o.index]=i.children,o=i)}return n[0].children}function decodeScan(e,t,r,n,a,i,o,s,l){var f=r.mcusPerLine,c=r.progressive,u=t,d=t,h=0,p=0;function m(){if(p>0)return p--,h>>p&1;if(255===(h=e[d++])){var t=e[d++];if(t)throw new Error("unexpected marker: ".concat((h<<8|t).toString(16)))}return p=7,h>>>7}function g(e){for(var t,r=e;null!==(t=m());){if("number"==typeof(r=r[t]))return r;if("object"!==_typeof(r))throw new Error("invalid huffman sequence")}return null}function y(e){for(var t=e,r=0;t>0;){var n=m();if(null===n)return;r=r<<1|n,--t}return r}function _(e){var t=y(e);return t>=1<<e-1?t:t+(-1<<e)+1}var b=0;var v,w=0;function k(e,t,r,n,a){var i=r%f,o=(r/f|0)*e.v+n,s=i*e.h+a;t(e,e.blocks[o][s])}function T(e,t,r){var n=r/e.blocksPerLine|0,a=r%e.blocksPerLine;t(e,e.blocks[n][a])}var E,x,S,D,A,M,I=n.length;M=c?0===i?0===s?function(e,t){var r=g(e.huffmanTableDC),n=0===r?0:_(r)<<l;e.pred+=n,t[0]=e.pred}:function(e,t){t[0]|=m()<<l}:0===s?function(e,t){if(b>0)b--;else for(var r=i,n=o;r<=n;){var a=g(e.huffmanTableAC),s=15&a,f=a>>4;if(0===s){if(f<15){b=y(f)+(1<<f)-1;break}r+=16}else t[dctZigZag[r+=f]]=_(s)*(1<<l),r++}}:function(e,t){for(var r=i,n=o,a=0;r<=n;){var s=dctZigZag[r],f=t[s]<0?-1:1;switch(w){case 0:var c=g(e.huffmanTableAC),u=15&c;if(a=c>>4,0===u)a<15?(b=y(a)+(1<<a),w=4):(a=16,w=1);else{if(1!==u)throw new Error("invalid ACn encoding");v=_(u),w=a?2:3}continue;case 1:case 2:t[s]?t[s]+=(m()<<l)*f:0==--a&&(w=2===w?3:0);break;case 3:t[s]?t[s]+=(m()<<l)*f:(t[s]=v<<l,w=0);break;case 4:t[s]&&(t[s]+=(m()<<l)*f)}r++}4===w&&0==--b&&(w=0)}:function(e,t){var r=g(e.huffmanTableDC),n=0===r?0:_(r);e.pred+=n,t[0]=e.pred;for(var a=1;a<64;){var i=g(e.huffmanTableAC),o=15&i,s=i>>4;if(0===o){if(s<15)break;a+=16}else t[dctZigZag[a+=s]]=_(o),a++}};var R,O,C=0;O=1===I?n[0].blocksPerLine*n[0].blocksPerColumn:f*r.mcusPerColumn;for(var P=a||O;C<O;){for(x=0;x<I;x++)n[x].pred=0;if(b=0,1===I)for(E=n[0],A=0;A<P;A++)T(E,M,C),C++;else for(A=0;A<P;A++){for(x=0;x<I;x++){var L=E=n[x],U=L.h,B=L.v;for(S=0;S<B;S++)for(D=0;D<U;D++)k(E,M,C,S,D)}if(++C===O)break}if(p=0,(R=e[d]<<8|e[d+1])<65280)throw new Error("marker was not found");if(!(R>=65488&&R<=65495))break;d+=2}return d-u}function buildComponentData(e,t){var r=[],n=t.blocksPerLine,a=t.blocksPerColumn,i=n<<3,o=new Int32Array(64),s=new Uint8Array(64);function l(e,r,n){var a,i,o,s,l,f,c,u,d,h,p=t.quantizationTable,m=n;for(h=0;h<64;h++)m[h]=e[h]*p[h];for(h=0;h<8;++h){var g=8*h;0!==m[1+g]||0!==m[2+g]||0!==m[3+g]||0!==m[4+g]||0!==m[5+g]||0!==m[6+g]||0!==m[7+g]?(a=dctSqrt2*m[0+g]+128>>8,i=dctSqrt2*m[4+g]+128>>8,o=m[2+g],s=m[6+g],l=dctSqrt1d2*(m[1+g]-m[7+g])+128>>8,u=dctSqrt1d2*(m[1+g]+m[7+g])+128>>8,f=m[3+g]<<4,c=m[5+g]<<4,d=a-i+1>>1,a=a+i+1>>1,i=d,d=o*dctSin6+s*dctCos6+128>>8,o=o*dctCos6-s*dctSin6+128>>8,s=d,d=l-c+1>>1,l=l+c+1>>1,c=d,d=u+f+1>>1,f=u-f+1>>1,u=d,d=a-s+1>>1,a=a+s+1>>1,s=d,d=i-o+1>>1,i=i+o+1>>1,o=d,d=l*dctSin3+u*dctCos3+2048>>12,l=l*dctCos3-u*dctSin3+2048>>12,u=d,d=f*dctSin1+c*dctCos1+2048>>12,f=f*dctCos1-c*dctSin1+2048>>12,c=d,m[0+g]=a+u,m[7+g]=a-u,m[1+g]=i+c,m[6+g]=i-c,m[2+g]=o+f,m[5+g]=o-f,m[3+g]=s+l,m[4+g]=s-l):(d=dctSqrt2*m[0+g]+512>>10,m[0+g]=d,m[1+g]=d,m[2+g]=d,m[3+g]=d,m[4+g]=d,m[5+g]=d,m[6+g]=d,m[7+g]=d)}for(h=0;h<8;++h){var y=h;0!==m[8+y]||0!==m[16+y]||0!==m[24+y]||0!==m[32+y]||0!==m[40+y]||0!==m[48+y]||0!==m[56+y]?(a=dctSqrt2*m[0+y]+2048>>12,i=dctSqrt2*m[32+y]+2048>>12,o=m[16+y],s=m[48+y],l=dctSqrt1d2*(m[8+y]-m[56+y])+2048>>12,u=dctSqrt1d2*(m[8+y]+m[56+y])+2048>>12,f=m[24+y],c=m[40+y],d=a-i+1>>1,a=a+i+1>>1,i=d,d=o*dctSin6+s*dctCos6+2048>>12,o=o*dctCos6-s*dctSin6+2048>>12,s=d,d=l-c+1>>1,l=l+c+1>>1,c=d,d=u+f+1>>1,f=u-f+1>>1,u=d,d=a-s+1>>1,a=a+s+1>>1,s=d,d=i-o+1>>1,i=i+o+1>>1,o=d,d=l*dctSin3+u*dctCos3+2048>>12,l=l*dctCos3-u*dctSin3+2048>>12,u=d,d=f*dctSin1+c*dctCos1+2048>>12,f=f*dctCos1-c*dctSin1+2048>>12,c=d,m[0+y]=a+u,m[56+y]=a-u,m[8+y]=i+c,m[48+y]=i-c,m[16+y]=o+f,m[40+y]=o-f,m[24+y]=s+l,m[32+y]=s-l):(d=dctSqrt2*n[h+0]+8192>>14,m[0+y]=d,m[8+y]=d,m[16+y]=d,m[24+y]=d,m[32+y]=d,m[40+y]=d,m[48+y]=d,m[56+y]=d)}for(h=0;h<64;++h){var _=128+(m[h]+8>>4);r[h]=_<0?0:_>255?255:_}}for(var f=0;f<a;f++){for(var c=f<<3,u=0;u<8;u++)r.push(new Uint8Array(i));for(var d=0;d<n;d++){l(t.blocks[f][d],s,o);for(var h=0,p=d<<3,m=0;m<8;m++)for(var g=r[c+m],y=0;y<8;y++)g[p+y]=s[h++]}}return r}var JpegStreamReader=function(){function e(){_classCallCheck(this,e),this.jfif=null,this.adobe=null,this.quantizationTables=[],this.huffmanTablesAC=[],this.huffmanTablesDC=[],this.resetFrames()}return _createClass(e,[{key:"resetFrames",value:function(){this.frames=[]}},{key:"parse",value:function(e){var t=0;function r(){var r=e[t]<<8|e[t+1];return t+=2,r}function n(e){var t,r,n=0,a=0;for(r in e.components)e.components.hasOwnProperty(r)&&(n<(t=e.components[r]).h&&(n=t.h),a<t.v&&(a=t.v));var i=Math.ceil(e.samplesPerLine/8/n),o=Math.ceil(e.scanLines/8/a);for(r in e.components)if(e.components.hasOwnProperty(r)){t=e.components[r];for(var s=Math.ceil(Math.ceil(e.samplesPerLine/8)*t.h/n),l=Math.ceil(Math.ceil(e.scanLines/8)*t.v/a),f=i*t.h,c=o*t.v,u=[],d=0;d<c;d++){for(var h=[],p=0;p<f;p++)h.push(new Int32Array(64));u.push(h)}t.blocksPerLine=s,t.blocksPerColumn=l,t.blocks=u}e.maxH=n,e.maxV=a,e.mcusPerLine=i,e.mcusPerColumn=o}var a,i,o=r();if(65496!==o)throw new Error("SOI not found");for(o=r();65497!==o;){switch(o){case 65280:break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var s=(a=void 0,i=void 0,a=r(),i=e.subarray(t,t+a-2),t+=i.length,i);65504===o&&74===s[0]&&70===s[1]&&73===s[2]&&70===s[3]&&0===s[4]&&(this.jfif={version:{major:s[5],minor:s[6]},densityUnits:s[7],xDensity:s[8]<<8|s[9],yDensity:s[10]<<8|s[11],thumbWidth:s[12],thumbHeight:s[13],thumbData:s.subarray(14,14+3*s[12]*s[13])}),65518===o&&65===s[0]&&100===s[1]&&111===s[2]&&98===s[3]&&101===s[4]&&0===s[5]&&(this.adobe={version:s[6],flags0:s[7]<<8|s[8],flags1:s[9]<<8|s[10],transformCode:s[11]});break;case 65499:for(var l=r()+t-2;t<l;){var f=e[t++],c=new Int32Array(64);if(f>>4==0)for(var u=0;u<64;u++){c[dctZigZag[u]]=e[t++]}else{if(f>>4!=1)throw new Error("DQT: invalid table spec");for(var d=0;d<64;d++){c[dctZigZag[d]]=r()}}this.quantizationTables[15&f]=c}break;case 65472:case 65473:case 65474:r();for(var h={extended:65473===o,progressive:65474===o,precision:e[t++],scanLines:r(),samplesPerLine:r(),components:{},componentsOrder:[]},p=e[t++],m=void 0,g=0;g<p;g++){m=e[t];var y=e[t+1]>>4,_=15&e[t+1],b=e[t+2];h.componentsOrder.push(m),h.components[m]={h:y,v:_,quantizationIdx:b},t+=3}n(h),this.frames.push(h);break;case 65476:for(var v=r(),w=2;w<v;){for(var k=e[t++],T=new Uint8Array(16),E=0,x=0;x<16;x++,t++)T[x]=e[t],E+=T[x];for(var S=new Uint8Array(E),D=0;D<E;D++,t++)S[D]=e[t];w+=17+E,k>>4==0?this.huffmanTablesDC[15&k]=buildHuffmanTable(T,S):this.huffmanTablesAC[15&k]=buildHuffmanTable(T,S)}break;case 65501:r(),this.resetInterval=r();break;case 65498:r();for(var A=e[t++],M=[],I=this.frames[0],R=0;R<A;R++){var O=I.components[e[t++]],C=e[t++];O.huffmanTableDC=this.huffmanTablesDC[C>>4],O.huffmanTableAC=this.huffmanTablesAC[15&C],M.push(O)}var P=e[t++],L=e[t++],U=e[t++],B=decodeScan(e,t,I,M,this.resetInterval,P,L,U>>4,15&U);t+=B;break;case 65535:255!==e[t]&&t--;break;default:if(255===e[t-3]&&e[t-2]>=192&&e[t-2]<=254){t-=3;break}throw new Error("unknown JPEG marker ".concat(o.toString(16)))}o=r()}}},{key:"getResult",value:function(){var e=this.frames;if(0===this.frames.length)throw new Error("no frames were decoded");this.frames.length>1&&console.warn("more than one frame is not supported");for(var t=0;t<this.frames.length;t++)for(var r=this.frames[t].components,n=0,a=Object.keys(r);n<a.length;n++){var i=a[n];r[i].quantizationTable=this.quantizationTables[r[i].quantizationIdx],delete r[i].quantizationIdx}for(var o=e[0],s=o.components,l=o.componentsOrder,f=[],c=o.samplesPerLine,u=o.scanLines,d=0;d<l.length;d++){var h=s[l[d]];f.push({lines:buildComponentData(o,h),scaleX:h.h/o.maxH,scaleY:h.v/o.maxV})}for(var p=new Uint8Array(c*u*f.length),m=0,g=0;g<u;++g)for(var y=0;y<c;++y)for(var _=0;_<f.length;++_){var b=f[_];p[m]=b.lines[0|g*b.scaleY][0|y*b.scaleX],++m}return p}}]),e}(),JpegDecoder=function(e){_inherits(r,BaseDecoder);var t=_createSuper(r);function r(e){var n;return _classCallCheck(this,r),(n=t.call(this)).reader=new JpegStreamReader,e.JPEGTables&&n.reader.parse(e.JPEGTables),n}return _createClass(r,[{key:"decodeBlock",value:function(e){return this.reader.resetFrames(),this.reader.parse(new Uint8Array(e)),this.reader.getResult().buffer}}]),r}(),jpeg=Object.freeze({__proto__:null,default:JpegDecoder});function zero$1(e){for(var t=e.length;--t>=0;)e[t]=0}var MIN_MATCH$1=3,MAX_MATCH$1=258,LENGTH_CODES$1=29,LITERALS$1=256,L_CODES$1=LITERALS$1+1+LENGTH_CODES$1,D_CODES$1=30,DIST_CODE_LEN=512,static_ltree=new Array(2*(L_CODES$1+2));zero$1(static_ltree);var static_dtree=new Array(2*D_CODES$1);zero$1(static_dtree);var _dist_code=new Array(DIST_CODE_LEN);zero$1(_dist_code);var _length_code=new Array(MAX_MATCH$1-MIN_MATCH$1+1);zero$1(_length_code);var base_length=new Array(LENGTH_CODES$1);zero$1(base_length);var base_dist=new Array(D_CODES$1);zero$1(base_dist);var adler32=function(e,t,r,n){for(var a=65535&e|0,i=e>>>16&65535|0,o=0;0!==r;){r-=o=r>2e3?2e3:r;do{i=i+(a=a+t[n++]|0)|0}while(--o);a%=65521,i%=65521}return a|i<<16|0},adler32_1=adler32,makeTable=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t},crcTable=new Uint32Array(makeTable()),crc32=function(e,t,r,n){var a=crcTable,i=n+r;e^=-1;for(var o=n;o<i;o++)e=e>>>8^a[255&(e^t[o])];return-1^e},crc32_1=crc32,messages={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},constants$2={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},_has=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var r=t.shift();if(r){if("object"!==_typeof(r))throw new TypeError(r+"must be non-object");for(var n in r)_has(r,n)&&(e[n]=r[n])}}return e},flattenChunks=function(e){for(var t=0,r=0,n=e.length;r<n;r++)t+=e[r].length;for(var a=new Uint8Array(t),i=0,o=0,s=e.length;i<s;i++){var l=e[i];a.set(l,o),o+=l.length}return a},common={assign:assign,flattenChunks:flattenChunks},STR_APPLY_UIA_OK=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){STR_APPLY_UIA_OK=!1}for(var _utf8len=new Uint8Array(256),q=0;q<256;q++)_utf8len[q]=q>=252?6:q>=248?5:q>=240?4:q>=224?3:q>=192?2:1;_utf8len[254]=_utf8len[254]=1;var string2buf=function(e){if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);var t,r,n,a,i,o=e.length,s=0;for(a=0;a<o;a++)55296==(64512&(r=e.charCodeAt(a)))&&a+1<o&&56320==(64512&(n=e.charCodeAt(a+1)))&&(r=65536+(r-55296<<10)+(n-56320),a++),s+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(s),i=0,a=0;i<s;a++)55296==(64512&(r=e.charCodeAt(a)))&&a+1<o&&56320==(64512&(n=e.charCodeAt(a+1)))&&(r=65536+(r-55296<<10)+(n-56320),a++),r<128?t[i++]=r:r<2048?(t[i++]=192|r>>>6,t[i++]=128|63&r):r<65536?(t[i++]=224|r>>>12,t[i++]=128|r>>>6&63,t[i++]=128|63&r):(t[i++]=240|r>>>18,t[i++]=128|r>>>12&63,t[i++]=128|r>>>6&63,t[i++]=128|63&r);return t},buf2binstring=function(e,t){if(t<65534&&e.subarray&&STR_APPLY_UIA_OK)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));for(var r="",n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r},buf2string=function(e,t){var r,n,a=t||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));var i=new Array(2*a);for(n=0,r=0;r<a;){var o=e[r++];if(o<128)i[n++]=o;else{var s=_utf8len[o];if(s>4)i[n++]=65533,r+=s-1;else{for(o&=2===s?31:3===s?15:7;s>1&&r<a;)o=o<<6|63&e[r++],s--;s>1?i[n++]=65533:o<65536?i[n++]=o:(o-=65536,i[n++]=55296|o>>10&1023,i[n++]=56320|1023&o)}}}return buf2binstring(i,n)},utf8border=function(e,t){(t=t||e.length)>e.length&&(t=e.length);for(var r=t-1;r>=0&&128==(192&e[r]);)r--;return r<0||0===r?t:r+_utf8len[e[r]]>t?r:t},strings={string2buf:string2buf,buf2string:buf2string,utf8border:utf8border};function ZStream(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var zstream=ZStream,BAD$1=30,TYPE$1=12,inffast=function(e,t){var r,n,a,i,o,s,l,f,c,u,d,h,p,m,g,y,_,b,v,w,k,T,E,x,S=e.state;r=e.next_in,E=e.input,n=r+(e.avail_in-5),a=e.next_out,x=e.output,i=a-(t-e.avail_out),o=a+(e.avail_out-257),s=S.dmax,l=S.wsize,f=S.whave,c=S.wnext,u=S.window,d=S.hold,h=S.bits,p=S.lencode,m=S.distcode,g=(1<<S.lenbits)-1,y=(1<<S.distbits)-1;e:do{h<15&&(d+=E[r++]<<h,h+=8,d+=E[r++]<<h,h+=8),_=p[d&g];t:for(;;){if(d>>>=b=_>>>24,h-=b,0===(b=_>>>16&255))x[a++]=65535&_;else{if(!(16&b)){if(0==(64&b)){_=p[(65535&_)+(d&(1<<b)-1)];continue t}if(32&b){S.mode=TYPE$1;break e}e.msg="invalid literal/length code",S.mode=BAD$1;break e}v=65535&_,(b&=15)&&(h<b&&(d+=E[r++]<<h,h+=8),v+=d&(1<<b)-1,d>>>=b,h-=b),h<15&&(d+=E[r++]<<h,h+=8,d+=E[r++]<<h,h+=8),_=m[d&y];r:for(;;){if(d>>>=b=_>>>24,h-=b,!(16&(b=_>>>16&255))){if(0==(64&b)){_=m[(65535&_)+(d&(1<<b)-1)];continue r}e.msg="invalid distance code",S.mode=BAD$1;break e}if(w=65535&_,h<(b&=15)&&(d+=E[r++]<<h,(h+=8)<b&&(d+=E[r++]<<h,h+=8)),(w+=d&(1<<b)-1)>s){e.msg="invalid distance too far back",S.mode=BAD$1;break e}if(d>>>=b,h-=b,w>(b=a-i)){if((b=w-b)>f&&S.sane){e.msg="invalid distance too far back",S.mode=BAD$1;break e}if(k=0,T=u,0===c){if(k+=l-b,b<v){v-=b;do{x[a++]=u[k++]}while(--b);k=a-w,T=x}}else if(c<b){if(k+=l+c-b,(b-=c)<v){v-=b;do{x[a++]=u[k++]}while(--b);if(k=0,c<v){v-=b=c;do{x[a++]=u[k++]}while(--b);k=a-w,T=x}}}else if(k+=c-b,b<v){v-=b;do{x[a++]=u[k++]}while(--b);k=a-w,T=x}for(;v>2;)x[a++]=T[k++],x[a++]=T[k++],x[a++]=T[k++],v-=3;v&&(x[a++]=T[k++],v>1&&(x[a++]=T[k++]))}else{k=a-w;do{x[a++]=x[k++],x[a++]=x[k++],x[a++]=x[k++],v-=3}while(v>2);v&&(x[a++]=x[k++],v>1&&(x[a++]=x[k++]))}break}}break}}while(r<n&&a<o);r-=v=h>>3,d&=(1<<(h-=v<<3))-1,e.next_in=r,e.next_out=a,e.avail_in=r<n?n-r+5:5-(r-n),e.avail_out=a<o?o-a+257:257-(a-o),S.hold=d,S.bits=h},MAXBITS=15,ENOUGH_LENS$1=852,ENOUGH_DISTS$1=592,CODES$1=0,LENS$1=1,DISTS$1=2,lbase=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),lext=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),dbase=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),dext=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),inflate_table=function(e,t,r,n,a,i,o,s){var l,f,c,u,d,h,p,m,g,y=s.bits,_=0,b=0,v=0,w=0,k=0,T=0,E=0,x=0,S=0,D=0,A=null,M=0,I=new Uint16Array(MAXBITS+1),R=new Uint16Array(MAXBITS+1),O=null,C=0;for(_=0;_<=MAXBITS;_++)I[_]=0;for(b=0;b<n;b++)I[t[r+b]]++;for(k=y,w=MAXBITS;w>=1&&0===I[w];w--);if(k>w&&(k=w),0===w)return a[i++]=20971520,a[i++]=20971520,s.bits=1,0;for(v=1;v<w&&0===I[v];v++);for(k<v&&(k=v),x=1,_=1;_<=MAXBITS;_++)if(x<<=1,(x-=I[_])<0)return-1;if(x>0&&(e===CODES$1||1!==w))return-1;for(R[1]=0,_=1;_<MAXBITS;_++)R[_+1]=R[_]+I[_];for(b=0;b<n;b++)0!==t[r+b]&&(o[R[t[r+b]]++]=b);if(e===CODES$1?(A=O=o,h=19):e===LENS$1?(A=lbase,M-=257,O=lext,C-=257,h=256):(A=dbase,O=dext,h=-1),D=0,b=0,_=v,d=i,T=k,E=0,c=-1,u=(S=1<<k)-1,e===LENS$1&&S>ENOUGH_LENS$1||e===DISTS$1&&S>ENOUGH_DISTS$1)return 1;for(;;){p=_-E,o[b]<h?(m=0,g=o[b]):o[b]>h?(m=O[C+o[b]],g=A[M+o[b]]):(m=96,g=0),l=1<<_-E,v=f=1<<T;do{a[d+(D>>E)+(f-=l)]=p<<24|m<<16|g|0}while(0!==f);for(l=1<<_-1;D&l;)l>>=1;if(0!==l?(D&=l-1,D+=l):D=0,b++,0==--I[_]){if(_===w)break;_=t[r+o[b]]}if(_>k&&(D&u)!==c){for(0===E&&(E=k),d+=v,x=1<<(T=_-E);T+E<w&&!((x-=I[T+E])<=0);)T++,x<<=1;if(S+=1<<T,e===LENS$1&&S>ENOUGH_LENS$1||e===DISTS$1&&S>ENOUGH_DISTS$1)return 1;a[c=D&u]=k<<24|T<<16|d-i|0}}return 0!==D&&(a[d+D]=_-E<<24|64<<16|0),s.bits=k,0},inftrees=inflate_table,CODES=0,LENS=1,DISTS=2,Z_FINISH$1=constants$2.Z_FINISH,Z_BLOCK=constants$2.Z_BLOCK,Z_TREES=constants$2.Z_TREES,Z_OK$1=constants$2.Z_OK,Z_STREAM_END$1=constants$2.Z_STREAM_END,Z_NEED_DICT$1=constants$2.Z_NEED_DICT,Z_STREAM_ERROR$1=constants$2.Z_STREAM_ERROR,Z_DATA_ERROR$1=constants$2.Z_DATA_ERROR,Z_MEM_ERROR$1=constants$2.Z_MEM_ERROR,Z_BUF_ERROR=constants$2.Z_BUF_ERROR,Z_DEFLATED=constants$2.Z_DEFLATED,HEAD=1,FLAGS=2,TIME=3,OS=4,EXLEN=5,EXTRA=6,NAME=7,COMMENT=8,HCRC=9,DICTID=10,DICT=11,TYPE=12,TYPEDO=13,STORED=14,COPY_=15,COPY=16,TABLE=17,LENLENS=18,CODELENS=19,LEN_=20,LEN=21,LENEXT=22,DIST=23,DISTEXT=24,MATCH=25,LIT=26,CHECK=27,LENGTH=28,DONE=29,BAD=30,MEM=31,SYNC=32,ENOUGH_LENS=852,ENOUGH_DISTS=592,MAX_WBITS=15,DEF_WBITS=MAX_WBITS,zswap32=function(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)};function InflateState(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}var inflateResetKeep=function(e){if(!e||!e.state)return Z_STREAM_ERROR$1;var t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=HEAD,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(ENOUGH_LENS),t.distcode=t.distdyn=new Int32Array(ENOUGH_DISTS),t.sane=1,t.back=-1,Z_OK$1},inflateReset=function(e){if(!e||!e.state)return Z_STREAM_ERROR$1;var t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,inflateResetKeep(e)},inflateReset2=function(e,t){var r;if(!e||!e.state)return Z_STREAM_ERROR$1;var n=e.state;return t<0?(r=0,t=-t):(r=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?Z_STREAM_ERROR$1:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,inflateReset(e))},inflateInit2=function(e,t){if(!e)return Z_STREAM_ERROR$1;var r=new InflateState;e.state=r,r.window=null;var n=inflateReset2(e,t);return n!==Z_OK$1&&(e.state=null),n},inflateInit=function(e){return inflateInit2(e,DEF_WBITS)},virgin=!0,lenfix,distfix,fixedtables=function(e){if(virgin){lenfix=new Int32Array(512),distfix=new Int32Array(32);for(var t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(inftrees(LENS,e.lens,0,288,lenfix,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;inftrees(DISTS,e.lens,0,32,distfix,0,e.work,{bits:5}),virgin=!1}e.lencode=lenfix,e.lenbits=9,e.distcode=distfix,e.distbits=5},updatewindow=function(e,t,r,n){var a,i=e.state;return null===i.window&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new Uint8Array(i.wsize)),n>=i.wsize?(i.window.set(t.subarray(r-i.wsize,r),0),i.wnext=0,i.whave=i.wsize):((a=i.wsize-i.wnext)>n&&(a=n),i.window.set(t.subarray(r-n,r-n+a),i.wnext),(n-=a)?(i.window.set(t.subarray(r-n,r),0),i.wnext=n,i.whave=i.wsize):(i.wnext+=a,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=a))),0},inflate$2=function(e,t){var r,n,a,i,o,s,l,f,c,u,d,h,p,m,g,y,_,b,v,w,k,T,E,x,S=0,D=new Uint8Array(4),A=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return Z_STREAM_ERROR$1;(r=e.state).mode===TYPE&&(r.mode=TYPEDO),o=e.next_out,a=e.output,l=e.avail_out,i=e.next_in,n=e.input,s=e.avail_in,f=r.hold,c=r.bits,u=s,d=l,T=Z_OK$1;e:for(;;)switch(r.mode){case HEAD:if(0===r.wrap){r.mode=TYPEDO;break}for(;c<16;){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}if(2&r.wrap&&35615===f){r.check=0,D[0]=255&f,D[1]=f>>>8&255,r.check=crc32_1(r.check,D,2,0),f=0,c=0,r.mode=FLAGS;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&f)<<8)+(f>>8))%31){e.msg="incorrect header check",r.mode=BAD;break}if((15&f)!==Z_DEFLATED){e.msg="unknown compression method",r.mode=BAD;break}if(c-=4,k=8+(15&(f>>>=4)),0===r.wbits)r.wbits=k;else if(k>r.wbits){e.msg="invalid window size",r.mode=BAD;break}r.dmax=1<<r.wbits,e.adler=r.check=1,r.mode=512&f?DICTID:TYPE,f=0,c=0;break;case FLAGS:for(;c<16;){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}if(r.flags=f,(255&r.flags)!==Z_DEFLATED){e.msg="unknown compression method",r.mode=BAD;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=BAD;break}r.head&&(r.head.text=f>>8&1),512&r.flags&&(D[0]=255&f,D[1]=f>>>8&255,r.check=crc32_1(r.check,D,2,0)),f=0,c=0,r.mode=TIME;case TIME:for(;c<32;){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}r.head&&(r.head.time=f),512&r.flags&&(D[0]=255&f,D[1]=f>>>8&255,D[2]=f>>>16&255,D[3]=f>>>24&255,r.check=crc32_1(r.check,D,4,0)),f=0,c=0,r.mode=OS;case OS:for(;c<16;){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}r.head&&(r.head.xflags=255&f,r.head.os=f>>8),512&r.flags&&(D[0]=255&f,D[1]=f>>>8&255,r.check=crc32_1(r.check,D,2,0)),f=0,c=0,r.mode=EXLEN;case EXLEN:if(1024&r.flags){for(;c<16;){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}r.length=f,r.head&&(r.head.extra_len=f),512&r.flags&&(D[0]=255&f,D[1]=f>>>8&255,r.check=crc32_1(r.check,D,2,0)),f=0,c=0}else r.head&&(r.head.extra=null);r.mode=EXTRA;case EXTRA:if(1024&r.flags&&((h=r.length)>s&&(h=s),h&&(r.head&&(k=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(i,i+h),k)),512&r.flags&&(r.check=crc32_1(r.check,n,h,i)),s-=h,i+=h,r.length-=h),r.length))break e;r.length=0,r.mode=NAME;case NAME:if(2048&r.flags){if(0===s)break e;h=0;do{k=n[i+h++],r.head&&k&&r.length<65536&&(r.head.name+=String.fromCharCode(k))}while(k&&h<s);if(512&r.flags&&(r.check=crc32_1(r.check,n,h,i)),s-=h,i+=h,k)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=COMMENT;case COMMENT:if(4096&r.flags){if(0===s)break e;h=0;do{k=n[i+h++],r.head&&k&&r.length<65536&&(r.head.comment+=String.fromCharCode(k))}while(k&&h<s);if(512&r.flags&&(r.check=crc32_1(r.check,n,h,i)),s-=h,i+=h,k)break e}else r.head&&(r.head.comment=null);r.mode=HCRC;case HCRC:if(512&r.flags){for(;c<16;){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}if(f!==(65535&r.check)){e.msg="header crc mismatch",r.mode=BAD;break}f=0,c=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=TYPE;break;case DICTID:for(;c<32;){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}e.adler=r.check=zswap32(f),f=0,c=0,r.mode=DICT;case DICT:if(0===r.havedict)return e.next_out=o,e.avail_out=l,e.next_in=i,e.avail_in=s,r.hold=f,r.bits=c,Z_NEED_DICT$1;e.adler=r.check=1,r.mode=TYPE;case TYPE:if(t===Z_BLOCK||t===Z_TREES)break e;case TYPEDO:if(r.last){f>>>=7&c,c-=7&c,r.mode=CHECK;break}for(;c<3;){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}switch(r.last=1&f,c-=1,3&(f>>>=1)){case 0:r.mode=STORED;break;case 1:if(fixedtables(r),r.mode=LEN_,t===Z_TREES){f>>>=2,c-=2;break e}break;case 2:r.mode=TABLE;break;case 3:e.msg="invalid block type",r.mode=BAD}f>>>=2,c-=2;break;case STORED:for(f>>>=7&c,c-=7&c;c<32;){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}if((65535&f)!=(f>>>16^65535)){e.msg="invalid stored block lengths",r.mode=BAD;break}if(r.length=65535&f,f=0,c=0,r.mode=COPY_,t===Z_TREES)break e;case COPY_:r.mode=COPY;case COPY:if(h=r.length){if(h>s&&(h=s),h>l&&(h=l),0===h)break e;a.set(n.subarray(i,i+h),o),s-=h,i+=h,l-=h,o+=h,r.length-=h;break}r.mode=TYPE;break;case TABLE:for(;c<14;){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}if(r.nlen=257+(31&f),f>>>=5,c-=5,r.ndist=1+(31&f),f>>>=5,c-=5,r.ncode=4+(15&f),f>>>=4,c-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=BAD;break}r.have=0,r.mode=LENLENS;case LENLENS:for(;r.have<r.ncode;){for(;c<3;){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}r.lens[A[r.have++]]=7&f,f>>>=3,c-=3}for(;r.have<19;)r.lens[A[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,E={bits:r.lenbits},T=inftrees(CODES,r.lens,0,19,r.lencode,0,r.work,E),r.lenbits=E.bits,T){e.msg="invalid code lengths set",r.mode=BAD;break}r.have=0,r.mode=CODELENS;case CODELENS:for(;r.have<r.nlen+r.ndist;){for(;y=(S=r.lencode[f&(1<<r.lenbits)-1])>>>16&255,_=65535&S,!((g=S>>>24)<=c);){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}if(_<16)f>>>=g,c-=g,r.lens[r.have++]=_;else{if(16===_){for(x=g+2;c<x;){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}if(f>>>=g,c-=g,0===r.have){e.msg="invalid bit length repeat",r.mode=BAD;break}k=r.lens[r.have-1],h=3+(3&f),f>>>=2,c-=2}else if(17===_){for(x=g+3;c<x;){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}c-=g,k=0,h=3+(7&(f>>>=g)),f>>>=3,c-=3}else{for(x=g+7;c<x;){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}c-=g,k=0,h=11+(127&(f>>>=g)),f>>>=7,c-=7}if(r.have+h>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=BAD;break}for(;h--;)r.lens[r.have++]=k}}if(r.mode===BAD)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=BAD;break}if(r.lenbits=9,E={bits:r.lenbits},T=inftrees(LENS,r.lens,0,r.nlen,r.lencode,0,r.work,E),r.lenbits=E.bits,T){e.msg="invalid literal/lengths set",r.mode=BAD;break}if(r.distbits=6,r.distcode=r.distdyn,E={bits:r.distbits},T=inftrees(DISTS,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,E),r.distbits=E.bits,T){e.msg="invalid distances set",r.mode=BAD;break}if(r.mode=LEN_,t===Z_TREES)break e;case LEN_:r.mode=LEN;case LEN:if(s>=6&&l>=258){e.next_out=o,e.avail_out=l,e.next_in=i,e.avail_in=s,r.hold=f,r.bits=c,inffast(e,d),o=e.next_out,a=e.output,l=e.avail_out,i=e.next_in,n=e.input,s=e.avail_in,f=r.hold,c=r.bits,r.mode===TYPE&&(r.back=-1);break}for(r.back=0;y=(S=r.lencode[f&(1<<r.lenbits)-1])>>>16&255,_=65535&S,!((g=S>>>24)<=c);){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}if(y&&0==(240&y)){for(b=g,v=y,w=_;y=(S=r.lencode[w+((f&(1<<b+v)-1)>>b)])>>>16&255,_=65535&S,!(b+(g=S>>>24)<=c);){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}f>>>=b,c-=b,r.back+=b}if(f>>>=g,c-=g,r.back+=g,r.length=_,0===y){r.mode=LIT;break}if(32&y){r.back=-1,r.mode=TYPE;break}if(64&y){e.msg="invalid literal/length code",r.mode=BAD;break}r.extra=15&y,r.mode=LENEXT;case LENEXT:if(r.extra){for(x=r.extra;c<x;){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}r.length+=f&(1<<r.extra)-1,f>>>=r.extra,c-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=DIST;case DIST:for(;y=(S=r.distcode[f&(1<<r.distbits)-1])>>>16&255,_=65535&S,!((g=S>>>24)<=c);){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}if(0==(240&y)){for(b=g,v=y,w=_;y=(S=r.distcode[w+((f&(1<<b+v)-1)>>b)])>>>16&255,_=65535&S,!(b+(g=S>>>24)<=c);){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}f>>>=b,c-=b,r.back+=b}if(f>>>=g,c-=g,r.back+=g,64&y){e.msg="invalid distance code",r.mode=BAD;break}r.offset=_,r.extra=15&y,r.mode=DISTEXT;case DISTEXT:if(r.extra){for(x=r.extra;c<x;){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}r.offset+=f&(1<<r.extra)-1,f>>>=r.extra,c-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=BAD;break}r.mode=MATCH;case MATCH:if(0===l)break e;if(h=d-l,r.offset>h){if((h=r.offset-h)>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=BAD;break}h>r.wnext?(h-=r.wnext,p=r.wsize-h):p=r.wnext-h,h>r.length&&(h=r.length),m=r.window}else m=a,p=o-r.offset,h=r.length;h>l&&(h=l),l-=h,r.length-=h;do{a[o++]=m[p++]}while(--h);0===r.length&&(r.mode=LEN);break;case LIT:if(0===l)break e;a[o++]=r.length,l--,r.mode=LEN;break;case CHECK:if(r.wrap){for(;c<32;){if(0===s)break e;s--,f|=n[i++]<<c,c+=8}if(d-=l,e.total_out+=d,r.total+=d,d&&(e.adler=r.check=r.flags?crc32_1(r.check,a,d,o-d):adler32_1(r.check,a,d,o-d)),d=l,(r.flags?f:zswap32(f))!==r.check){e.msg="incorrect data check",r.mode=BAD;break}f=0,c=0}r.mode=LENGTH;case LENGTH:if(r.wrap&&r.flags){for(;c<32;){if(0===s)break e;s--,f+=n[i++]<<c,c+=8}if(f!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=BAD;break}f=0,c=0}r.mode=DONE;case DONE:T=Z_STREAM_END$1;break e;case BAD:T=Z_DATA_ERROR$1;break e;case MEM:return Z_MEM_ERROR$1;case SYNC:default:return Z_STREAM_ERROR$1}return e.next_out=o,e.avail_out=l,e.next_in=i,e.avail_in=s,r.hold=f,r.bits=c,(r.wsize||d!==e.avail_out&&r.mode<BAD&&(r.mode<CHECK||t!==Z_FINISH$1))&&updatewindow(e,e.output,e.next_out,d-e.avail_out),u-=e.avail_in,d-=e.avail_out,e.total_in+=u,e.total_out+=d,r.total+=d,r.wrap&&d&&(e.adler=r.check=r.flags?crc32_1(r.check,a,d,e.next_out-d):adler32_1(r.check,a,d,e.next_out-d)),e.data_type=r.bits+(r.last?64:0)+(r.mode===TYPE?128:0)+(r.mode===LEN_||r.mode===COPY_?256:0),(0===u&&0===d||t===Z_FINISH$1)&&T===Z_OK$1&&(T=Z_BUF_ERROR),T},inflateEnd=function(e){if(!e||!e.state)return Z_STREAM_ERROR$1;var t=e.state;return t.window&&(t.window=null),e.state=null,Z_OK$1},inflateGetHeader=function(e,t){if(!e||!e.state)return Z_STREAM_ERROR$1;var r=e.state;return 0==(2&r.wrap)?Z_STREAM_ERROR$1:(r.head=t,t.done=!1,Z_OK$1)},inflateSetDictionary=function(e,t){var r,n=t.length;return e&&e.state?0!==(r=e.state).wrap&&r.mode!==DICT?Z_STREAM_ERROR$1:r.mode===DICT&&adler32_1(1,t,n,0)!==r.check?Z_DATA_ERROR$1:updatewindow(e,t,n,n)?(r.mode=MEM,Z_MEM_ERROR$1):(r.havedict=1,Z_OK$1):Z_STREAM_ERROR$1},inflateReset_1=inflateReset,inflateReset2_1=inflateReset2,inflateResetKeep_1=inflateResetKeep,inflateInit_1=inflateInit,inflateInit2_1=inflateInit2,inflate_2$1=inflate$2,inflateEnd_1=inflateEnd,inflateGetHeader_1=inflateGetHeader,inflateSetDictionary_1=inflateSetDictionary,inflateInfo="pako inflate (from Nodeca project)",inflate_1$2={inflateReset:inflateReset_1,inflateReset2:inflateReset2_1,inflateResetKeep:inflateResetKeep_1,inflateInit:inflateInit_1,inflateInit2:inflateInit2_1,inflate:inflate_2$1,inflateEnd:inflateEnd_1,inflateGetHeader:inflateGetHeader_1,inflateSetDictionary:inflateSetDictionary_1,inflateInfo:inflateInfo};function GZheader(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var gzheader=GZheader,toString=Object.prototype.toString,Z_NO_FLUSH=constants$2.Z_NO_FLUSH,Z_FINISH=constants$2.Z_FINISH,Z_OK=constants$2.Z_OK,Z_STREAM_END=constants$2.Z_STREAM_END,Z_NEED_DICT=constants$2.Z_NEED_DICT,Z_STREAM_ERROR=constants$2.Z_STREAM_ERROR,Z_DATA_ERROR=constants$2.Z_DATA_ERROR,Z_MEM_ERROR=constants$2.Z_MEM_ERROR;function Inflate$1(e){this.options=common.assign({chunkSize:65536,windowBits:15,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new zstream,this.strm.avail_out=0;var r=inflate_1$2.inflateInit2(this.strm,t.windowBits);if(r!==Z_OK)throw new Error(messages[r]);if(this.header=new gzheader,inflate_1$2.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=strings.string2buf(t.dictionary):"[object ArrayBuffer]"===toString.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=inflate_1$2.inflateSetDictionary(this.strm,t.dictionary))!==Z_OK))throw new Error(messages[r])}function inflate$1(e,t){var r=new Inflate$1(t);if(r.push(e),r.err)throw r.msg||messages[r.err];return r.result}function inflateRaw$1(e,t){return(t=t||{}).raw=!0,inflate$1(e,t)}Inflate$1.prototype.push=function(e,t){var r,n,a,i=this.strm,o=this.options.chunkSize,s=this.options.dictionary;if(this.ended)return!1;for(n=t===~~t?t:!0===t?Z_FINISH:Z_NO_FLUSH,"[object ArrayBuffer]"===toString.call(e)?i.input=new Uint8Array(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;;){for(0===i.avail_out&&(i.output=new Uint8Array(o),i.next_out=0,i.avail_out=o),(r=inflate_1$2.inflate(i,n))===Z_NEED_DICT&&s&&((r=inflate_1$2.inflateSetDictionary(i,s))===Z_OK?r=inflate_1$2.inflate(i,n):r===Z_DATA_ERROR&&(r=Z_NEED_DICT));i.avail_in>0&&r===Z_STREAM_END&&i.state.wrap>0&&0!==e[i.next_in];)inflate_1$2.inflateReset(i),r=inflate_1$2.inflate(i,n);switch(r){case Z_STREAM_ERROR:case Z_DATA_ERROR:case Z_NEED_DICT:case Z_MEM_ERROR:return this.onEnd(r),this.ended=!0,!1}if(a=i.avail_out,i.next_out&&(0===i.avail_out||r===Z_STREAM_END))if("string"===this.options.to){var l=strings.utf8border(i.output,i.next_out),f=i.next_out-l,c=strings.buf2string(i.output,l);i.next_out=f,i.avail_out=o-f,f&&i.output.set(i.output.subarray(l,l+f),0),this.onData(c)}else this.onData(i.output.length===i.next_out?i.output:i.output.subarray(0,i.next_out));if(r!==Z_OK||0!==a){if(r===Z_STREAM_END)return r=inflate_1$2.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,!0;if(0===i.avail_in)break}}return!0},Inflate$1.prototype.onData=function(e){this.chunks.push(e)},Inflate$1.prototype.onEnd=function(e){e===Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=common.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var Inflate_1$1=Inflate$1,inflate_2=inflate$1,inflateRaw_1$1=inflateRaw$1,ungzip$1=inflate$1,constants=constants$2,inflate_1$1={Inflate:Inflate_1$1,inflate:inflate_2,inflateRaw:inflateRaw_1$1,ungzip:ungzip$1,constants:constants},inflate=inflate_1$1.inflate,inflate_1=inflate,DeflateDecoder=function(e){_inherits(r,BaseDecoder);var t=_createSuper(r);function r(){return _classCallCheck(this,r),t.apply(this,arguments)}return _createClass(r,[{key:"decodeBlock",value:function(e){return inflate_1(new Uint8Array(e)).buffer}}]),r}(),deflate=Object.freeze({__proto__:null,default:DeflateDecoder}),PackbitsDecoder=function(e){_inherits(r,BaseDecoder);var t=_createSuper(r);function r(){return _classCallCheck(this,r),t.apply(this,arguments)}return _createClass(r,[{key:"decodeBlock",value:function(e){for(var t=new DataView(e),r=[],n=0;n<e.byteLength;++n){var a=t.getInt8(n);if(a<0){var i=t.getUint8(n+1);a=-a;for(var o=0;o<=a;++o)r.push(i);n+=1}else{for(var s=0;s<=a;++s)r.push(t.getUint8(n+s+1));n+=a+1}}return new Uint8Array(r).buffer}}]),r}(),packbits=Object.freeze({__proto__:null,default:PackbitsDecoder}),LercDecode={exports:{}},module;module=LercDecode,\n/* Copyright 2015-2021 Esri. Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0 @preserve */\nfunction(){var e,t,r,n,a,i,o,s,l,f,c,u,d,h,p,m,g=(e={defaultNoDataValue:-34027999387901484e22,decode:function(i,o){var s=(o=o||{}).encodedMaskData||null===o.encodedMaskData,l=a(i,o.inputOffset||0,s),f=null!==o.noDataValue?o.noDataValue:e.defaultNoDataValue,c=t(l,o.pixelType||Float32Array,o.encodedMaskData,f,o.returnMask),u={width:l.width,height:l.height,pixelData:c.resultPixels,minValue:c.minValue,maxValue:l.pixels.maxValue,noDataValue:f};return c.resultMask&&(u.maskData=c.resultMask),o.returnEncodedMask&&l.mask&&(u.encodedMaskData=l.mask.bitset?l.mask.bitset:null),o.returnFileInfo&&(u.fileInfo=r(l),o.computeUsedBitDepths&&(u.fileInfo.bitDepths=n(l))),u}},t=function(e,t,r,n,a){var o,s,l,f=0,c=e.pixels.numBlocksX,u=e.pixels.numBlocksY,d=Math.floor(e.width/c),h=Math.floor(e.height/u),p=2*e.maxZError,m=Number.MAX_VALUE;r=r||(e.mask?e.mask.bitset:null),s=new t(e.width*e.height),a&&r&&(l=new Uint8Array(e.width*e.height));for(var g,y,_=new Float32Array(d*h),b=0;b<=u;b++){var v=b!==u?h:e.height%u;if(0!==v)for(var w=0;w<=c;w++){var k=w!==c?d:e.width%c;if(0!==k){var T,E,x,S,D=b*e.width*h+w*d,A=e.width-k,M=e.pixels.blocks[f];if(M.encoding<2?(0===M.encoding?T=M.rawData:(i(M.stuffedData,M.bitsPerPixel,M.numValidPixels,M.offset,p,_,e.pixels.maxValue),T=_),E=0):x=2===M.encoding?0:M.offset,r)for(y=0;y<v;y++){for(7&D&&(S=r[D>>3],S<<=7&D),g=0;g<k;g++)7&D||(S=r[D>>3]),128&S?(l&&(l[D]=1),m=m>(o=M.encoding<2?T[E++]:x)?o:m,s[D++]=o):(l&&(l[D]=0),s[D++]=n),S<<=1;D+=A}else if(M.encoding<2)for(y=0;y<v;y++){for(g=0;g<k;g++)m=m>(o=T[E++])?o:m,s[D++]=o;D+=A}else for(m=m>x?x:m,y=0;y<v;y++){for(g=0;g<k;g++)s[D++]=x;D+=A}if(1===M.encoding&&E!==M.numValidPixels)throw"Block and Mask do not match";f++}}}return{resultPixels:s,resultMask:l,minValue:m}},r=function(e){return{fileIdentifierString:e.fileIdentifierString,fileVersion:e.fileVersion,imageType:e.imageType,height:e.height,width:e.width,maxZError:e.maxZError,eofOffset:e.eofOffset,mask:e.mask?{numBlocksX:e.mask.numBlocksX,numBlocksY:e.mask.numBlocksY,numBytes:e.mask.numBytes,maxValue:e.mask.maxValue}:null,pixels:{numBlocksX:e.pixels.numBlocksX,numBlocksY:e.pixels.numBlocksY,numBytes:e.pixels.numBytes,maxValue:e.pixels.maxValue,noDataValue:e.noDataValue}}},n=function(e){for(var t=e.pixels.numBlocksX*e.pixels.numBlocksY,r={},n=0;n<t;n++){var a=e.pixels.blocks[n];0===a.encoding?r.float32=!0:1===a.encoding?r[a.bitsPerPixel]=!0:r[0]=!0}return Object.keys(r)},a=function(e,t,r){var n={},a=new Uint8Array(e,t,10);if(n.fileIdentifierString=String.fromCharCode.apply(null,a),"CntZImage"!==n.fileIdentifierString.trim())throw"Unexpected file identifier string: "+n.fileIdentifierString;t+=10;var i=new DataView(e,t,24);if(n.fileVersion=i.getInt32(0,!0),n.imageType=i.getInt32(4,!0),n.height=i.getUint32(8,!0),n.width=i.getUint32(12,!0),n.maxZError=i.getFloat64(16,!0),t+=24,!r)if(i=new DataView(e,t,16),n.mask={},n.mask.numBlocksY=i.getUint32(0,!0),n.mask.numBlocksX=i.getUint32(4,!0),n.mask.numBytes=i.getUint32(8,!0),n.mask.maxValue=i.getFloat32(12,!0),t+=16,n.mask.numBytes>0){var o=new Uint8Array(Math.ceil(n.width*n.height/8)),s=(i=new DataView(e,t,n.mask.numBytes)).getInt16(0,!0),l=2,f=0;do{if(s>0)for(;s--;)o[f++]=i.getUint8(l++);else{var c=i.getUint8(l++);for(s=-s;s--;)o[f++]=c}s=i.getInt16(l,!0),l+=2}while(l<n.mask.numBytes);if(-32768!==s||f<o.length)throw"Unexpected end of mask RLE encoding";n.mask.bitset=o,t+=n.mask.numBytes}else 0==(n.mask.numBytes|n.mask.numBlocksY|n.mask.maxValue)&&(n.mask.bitset=new Uint8Array(Math.ceil(n.width*n.height/8)));i=new DataView(e,t,16),n.pixels={},n.pixels.numBlocksY=i.getUint32(0,!0),n.pixels.numBlocksX=i.getUint32(4,!0),n.pixels.numBytes=i.getUint32(8,!0),n.pixels.maxValue=i.getFloat32(12,!0),t+=16;var u=n.pixels.numBlocksX,d=n.pixels.numBlocksY,h=u+(n.width%u>0?1:0),p=d+(n.height%d>0?1:0);n.pixels.blocks=new Array(h*p);for(var m=0,g=0;g<p;g++)for(var y=0;y<h;y++){var _=0,b=e.byteLength-t;i=new DataView(e,t,Math.min(10,b));var v={};n.pixels.blocks[m++]=v;var w=i.getUint8(0);if(_++,v.encoding=63&w,v.encoding>3)throw"Invalid block encoding ("+v.encoding+")";if(2!==v.encoding){if(0!==w&&2!==w){if(w>>=6,v.offsetType=w,2===w)v.offset=i.getInt8(1),_++;else if(1===w)v.offset=i.getInt16(1,!0),_+=2;else{if(0!==w)throw"Invalid block offset type";v.offset=i.getFloat32(1,!0),_+=4}if(1===v.encoding)if(w=i.getUint8(_),_++,v.bitsPerPixel=63&w,w>>=6,v.numValidPixelsType=w,2===w)v.numValidPixels=i.getUint8(_),_++;else if(1===w)v.numValidPixels=i.getUint16(_,!0),_+=2;else{if(0!==w)throw"Invalid valid pixel count type";v.numValidPixels=i.getUint32(_,!0),_+=4}}var k;if(t+=_,3!==v.encoding)if(0===v.encoding){var T=(n.pixels.numBytes-1)/4;if(T!==Math.floor(T))throw"uncompressed block has invalid length";k=new ArrayBuffer(4*T),new Uint8Array(k).set(new Uint8Array(e,t,4*T));var E=new Float32Array(k);v.rawData=E,t+=4*T}else if(1===v.encoding){var x=Math.ceil(v.numValidPixels*v.bitsPerPixel/8),S=Math.ceil(x/4);k=new ArrayBuffer(4*S),new Uint8Array(k).set(new Uint8Array(e,t,x)),v.stuffedData=new Uint32Array(k),t+=x}}else t++}return n.eofOffset=t,n},i=function(e,t,r,n,a,i,o){var s,l,f,c=(1<<t)-1,u=0,d=0,h=Math.ceil((o-n)/a),p=4*e.length-Math.ceil(t*r/8);for(e[e.length-1]<<=8*p,s=0;s<r;s++){if(0===d&&(f=e[u++],d=32),d>=t)l=f>>>d-t&c,d-=t;else{var m=t-d;l=(f&c)<<m&c,l+=(f=e[u++])>>>(d=32-m)}i[s]=l<h?n+l*a:o}return i},e),y=(o=function(e,t,r,n,a,i,o,s){var l,f,c,u,d,h=(1<<r)-1,p=0,m=0,g=4*e.length-Math.ceil(r*n/8);if(e[e.length-1]<<=8*g,a)for(l=0;l<n;l++)0===m&&(c=e[p++],m=32),m>=r?(f=c>>>m-r&h,m-=r):(f=(c&h)<<(u=r-m)&h,f+=(c=e[p++])>>>(m=32-u)),t[l]=a[f];else for(d=Math.ceil((s-i)/o),l=0;l<n;l++)0===m&&(c=e[p++],m=32),m>=r?(f=c>>>m-r&h,m-=r):(f=(c&h)<<(u=r-m)&h,f+=(c=e[p++])>>>(m=32-u)),t[l]=f<d?i+f*o:s},s=function(e,t,r,n,a,i){var o,s=(1<<t)-1,l=0,f=0,c=0,u=0,d=0,h=[],p=4*e.length-Math.ceil(t*r/8);e[e.length-1]<<=8*p;var m=Math.ceil((i-n)/a);for(f=0;f<r;f++)0===u&&(o=e[l++],u=32),u>=t?(d=o>>>u-t&s,u-=t):(d=(o&s)<<(c=t-u)&s,d+=(o=e[l++])>>>(u=32-c)),h[f]=d<m?n+d*a:i;return h.unshift(n),h},l=function(e,t,r,n,a,i,o,s){var l,f,c,u,d=(1<<r)-1,h=0,p=0,m=0;if(a)for(l=0;l<n;l++)0===p&&(c=e[h++],p=32,m=0),p>=r?(f=c>>>m&d,p-=r,m+=r):(f=c>>>m&d,p=32-(u=r-p),f|=((c=e[h++])&(1<<u)-1)<<r-u,m=u),t[l]=a[f];else{var g=Math.ceil((s-i)/o);for(l=0;l<n;l++)0===p&&(c=e[h++],p=32,m=0),p>=r?(f=c>>>m&d,p-=r,m+=r):(f=c>>>m&d,p=32-(u=r-p),f|=((c=e[h++])&(1<<u)-1)<<r-u,m=u),t[l]=f<g?i+f*o:s}return t},f=function(e,t,r,n,a,i){var o,s=(1<<t)-1,l=0,f=0,c=0,u=0,d=0,h=0,p=[],m=Math.ceil((i-n)/a);for(f=0;f<r;f++)0===u&&(o=e[l++],u=32,h=0),u>=t?(d=o>>>h&s,u-=t,h+=t):(d=o>>>h&s,u=32-(c=t-u),d|=((o=e[l++])&(1<<c)-1)<<t-c,h=c),p[f]=d<m?n+d*a:i;return p.unshift(n),p},c=function(e,t,r,n){var a,i,o,s,l=(1<<r)-1,f=0,c=0,u=4*e.length-Math.ceil(r*n/8);for(e[e.length-1]<<=8*u,a=0;a<n;a++)0===c&&(o=e[f++],c=32),c>=r?(i=o>>>c-r&l,c-=r):(i=(o&l)<<(s=r-c)&l,i+=(o=e[f++])>>>(c=32-s)),t[a]=i;return t},u=function(e,t,r,n){var a,i,o,s,l=(1<<r)-1,f=0,c=0,u=0;for(a=0;a<n;a++)0===c&&(o=e[f++],c=32,u=0),c>=r?(i=o>>>u&l,c-=r,u+=r):(i=o>>>u&l,c=32-(s=r-c),i|=((o=e[f++])&(1<<s)-1)<<r-s,u=s),t[a]=i;return t},d={HUFFMAN_LUT_BITS_MAX:12,computeChecksumFletcher32:function(e){for(var t=65535,r=65535,n=e.length,a=Math.floor(n/2),i=0;a;){var o=a>=359?359:a;a-=o;do{t+=e[i++]<<8,r+=t+=e[i++]}while(--o);t=(65535&t)+(t>>>16),r=(65535&r)+(r>>>16)}return 1&n&&(r+=t+=e[i]<<8),((r=(65535&r)+(r>>>16))<<16|(t=(65535&t)+(t>>>16)))>>>0},readHeaderInfo:function(e,t){var r=t.ptr,n=new Uint8Array(e,r,6),a={};if(a.fileIdentifierString=String.fromCharCode.apply(null,n),0!==a.fileIdentifierString.lastIndexOf("Lerc2",0))throw"Unexpected file identifier string (expect Lerc2 ): "+a.fileIdentifierString;r+=6;var i,o=new DataView(e,r,8),s=o.getInt32(0,!0);if(a.fileVersion=s,r+=4,s>=3&&(a.checksum=o.getUint32(4,!0),r+=4),o=new DataView(e,r,12),a.height=o.getUint32(0,!0),a.width=o.getUint32(4,!0),r+=8,s>=4?(a.numDims=o.getUint32(8,!0),r+=4):a.numDims=1,o=new DataView(e,r,40),a.numValidPixel=o.getUint32(0,!0),a.microBlockSize=o.getInt32(4,!0),a.blobSize=o.getInt32(8,!0),a.imageType=o.getInt32(12,!0),a.maxZError=o.getFloat64(16,!0),a.zMin=o.getFloat64(24,!0),a.zMax=o.getFloat64(32,!0),r+=40,t.headerInfo=a,t.ptr=r,s>=3&&(i=s>=4?52:48,this.computeChecksumFletcher32(new Uint8Array(e,r-i,a.blobSize-14))!==a.checksum))throw"Checksum failed.";return!0},checkMinMaxRanges:function(e,t){var r=t.headerInfo,n=this.getDataTypeArray(r.imageType),a=r.numDims*this.getDataTypeSize(r.imageType),i=this.readSubArray(e,t.ptr,n,a),o=this.readSubArray(e,t.ptr+a,n,a);t.ptr+=2*a;var s,l=!0;for(s=0;s<r.numDims;s++)if(i[s]!==o[s]){l=!1;break}return r.minValues=i,r.maxValues=o,l},readSubArray:function(e,t,r,n){var a;if(r===Uint8Array)a=new Uint8Array(e,t,n);else{var i=new ArrayBuffer(n);new Uint8Array(i).set(new Uint8Array(e,t,n)),a=new r(i)}return a},readMask:function(e,t){var r,n,a=t.ptr,i=t.headerInfo,o=i.width*i.height,s=i.numValidPixel,l=new DataView(e,a,4),f={};if(f.numBytes=l.getUint32(0,!0),a+=4,(0===s||o===s)&&0!==f.numBytes)throw"invalid mask";if(0===s)r=new Uint8Array(Math.ceil(o/8)),f.bitset=r,n=new Uint8Array(o),t.pixels.resultMask=n,a+=f.numBytes;else if(f.numBytes>0){r=new Uint8Array(Math.ceil(o/8));var c=(l=new DataView(e,a,f.numBytes)).getInt16(0,!0),u=2,d=0,h=0;do{if(c>0)for(;c--;)r[d++]=l.getUint8(u++);else for(h=l.getUint8(u++),c=-c;c--;)r[d++]=h;c=l.getInt16(u,!0),u+=2}while(u<f.numBytes);if(-32768!==c||d<r.length)throw"Unexpected end of mask RLE encoding";n=new Uint8Array(o);var p=0,m=0;for(m=0;m<o;m++)7&m?(p=r[m>>3],p<<=7&m):p=r[m>>3],128&p&&(n[m]=1);t.pixels.resultMask=n,f.bitset=r,a+=f.numBytes}return t.ptr=a,t.mask=f,!0},readDataOneSweep:function(e,t,r,n){var a,i=t.ptr,o=t.headerInfo,s=o.numDims,l=o.width*o.height,f=o.imageType,c=o.numValidPixel*d.getDataTypeSize(f)*s,u=t.pixels.resultMask;if(r===Uint8Array)a=new Uint8Array(e,i,c);else{var h=new ArrayBuffer(c);new Uint8Array(h).set(new Uint8Array(e,i,c)),a=new r(h)}if(a.length===l*s)t.pixels.resultPixels=n?d.swapDimensionOrder(a,l,s,r,!0):a;else{t.pixels.resultPixels=new r(l*s);var p=0,m=0,g=0,y=0;if(s>1){if(n){for(m=0;m<l;m++)if(u[m])for(y=m,g=0;g<s;g++,y+=l)t.pixels.resultPixels[y]=a[p++]}else for(m=0;m<l;m++)if(u[m])for(y=m*s,g=0;g<s;g++)t.pixels.resultPixels[y+g]=a[p++]}else for(m=0;m<l;m++)u[m]&&(t.pixels.resultPixels[m]=a[p++])}return i+=c,t.ptr=i,!0},readHuffmanTree:function(e,t){var r=this.HUFFMAN_LUT_BITS_MAX,n=new DataView(e,t.ptr,16);if(t.ptr+=16,n.getInt32(0,!0)<2)throw"unsupported Huffman version";var a=n.getInt32(4,!0),i=n.getInt32(8,!0),o=n.getInt32(12,!0);if(i>=o)return!1;var s=new Uint32Array(o-i);d.decodeBits(e,t,s);var l,f,c,u,p=[];for(l=i;l<o;l++)p[f=l-(l<a?0:a)]={first:s[l-i],second:null};var m=e.byteLength-t.ptr,g=Math.ceil(m/4),y=new ArrayBuffer(4*g);new Uint8Array(y).set(new Uint8Array(e,t.ptr,m));var _,b=new Uint32Array(y),v=0,w=0;for(_=b[0],l=i;l<o;l++)(u=p[f=l-(l<a?0:a)].first)>0&&(p[f].second=_<<v>>>32-u,32-v>=u?32===(v+=u)&&(v=0,_=b[++w]):(v+=u-32,_=b[++w],p[f].second|=_>>>32-v));var k=0,T=0,E=new h;for(l=0;l<p.length;l++)void 0!==p[l]&&(k=Math.max(k,p[l].first));T=k>=r?r:k;var x,S,D,A,M,I=[];for(l=i;l<o;l++)if((u=p[f=l-(l<a?0:a)].first)>0)if(x=[u,f],u<=T)for(S=p[f].second<<T-u,D=1<<T-u,c=0;c<D;c++)I[S|c]=x;else for(S=p[f].second,M=E,A=u-1;A>=0;A--)S>>>A&1?(M.right||(M.right=new h),M=M.right):(M.left||(M.left=new h),M=M.left),0!==A||M.val||(M.val=x[1]);return{decodeLut:I,numBitsLUTQick:T,numBitsLUT:k,tree:E,stuffedData:b,srcPtr:w,bitPos:v}},readHuffman:function(e,t,r,n){var a,i,o,s,l,f,c,u,h,p=t.headerInfo.numDims,m=t.headerInfo.height,g=t.headerInfo.width,y=g*m,_=this.readHuffmanTree(e,t),b=_.decodeLut,v=_.tree,w=_.stuffedData,k=_.srcPtr,T=_.bitPos,E=_.numBitsLUTQick,x=_.numBitsLUT,S=0===t.headerInfo.imageType?128:0,D=t.pixels.resultMask,A=0;T>0&&(k++,T=0);var M,I=w[k],R=1===t.encodeMode,O=new r(y*p),C=O;if(p<2||R){for(M=0;M<p;M++)if(p>1&&(C=new r(O.buffer,y*M,y),A=0),t.headerInfo.numValidPixel===g*m)for(u=0,f=0;f<m;f++)for(c=0;c<g;c++,u++){if(i=0,l=s=I<<T>>>32-E,32-T<E&&(l=s|=w[k+1]>>>64-T-E),b[l])i=b[l][1],T+=b[l][0];else for(l=s=I<<T>>>32-x,32-T<x&&(l=s|=w[k+1]>>>64-T-x),a=v,h=0;h<x;h++)if(!(a=s>>>x-h-1&1?a.right:a.left).left&&!a.right){i=a.val,T=T+h+1;break}T>=32&&(T-=32,I=w[++k]),o=i-S,R?(o+=c>0?A:f>0?C[u-g]:A,o&=255,C[u]=o,A=o):C[u]=o}else for(u=0,f=0;f<m;f++)for(c=0;c<g;c++,u++)if(D[u]){if(i=0,l=s=I<<T>>>32-E,32-T<E&&(l=s|=w[k+1]>>>64-T-E),b[l])i=b[l][1],T+=b[l][0];else for(l=s=I<<T>>>32-x,32-T<x&&(l=s|=w[k+1]>>>64-T-x),a=v,h=0;h<x;h++)if(!(a=s>>>x-h-1&1?a.right:a.left).left&&!a.right){i=a.val,T=T+h+1;break}T>=32&&(T-=32,I=w[++k]),o=i-S,R?(c>0&&D[u-1]?o+=A:f>0&&D[u-g]?o+=C[u-g]:o+=A,o&=255,C[u]=o,A=o):C[u]=o}}else for(u=0,f=0;f<m;f++)for(c=0;c<g;c++)if(u=f*g+c,!D||D[u])for(M=0;M<p;M++,u+=y){if(i=0,l=s=I<<T>>>32-E,32-T<E&&(l=s|=w[k+1]>>>64-T-E),b[l])i=b[l][1],T+=b[l][0];else for(l=s=I<<T>>>32-x,32-T<x&&(l=s|=w[k+1]>>>64-T-x),a=v,h=0;h<x;h++)if(!(a=s>>>x-h-1&1?a.right:a.left).left&&!a.right){i=a.val,T=T+h+1;break}T>=32&&(T-=32,I=w[++k]),o=i-S,C[u]=o}t.ptr=t.ptr+4*(k+1)+(T>0?4:0),t.pixels.resultPixels=O,p>1&&!n&&(t.pixels.resultPixels=d.swapDimensionOrder(O,y,p,r))},decodeBits:function(e,t,r,n,a){var i=t.headerInfo,d=i.fileVersion,h=0,p=e.byteLength-t.ptr>=5?5:e.byteLength-t.ptr,m=new DataView(e,t.ptr,p),g=m.getUint8(0);h++;var y=g>>6,_=0===y?4:3-y,b=(32&g)>0,v=31&g,w=0;if(1===_)w=m.getUint8(h),h++;else if(2===_)w=m.getUint16(h,!0),h+=2;else{if(4!==_)throw"Invalid valid pixel count type";w=m.getUint32(h,!0),h+=4}var k,T,E,x,S,D,A,M,I,R=2*i.maxZError,O=i.numDims>1?i.maxValues[a]:i.zMax;if(b){for(t.counter.lut++,M=m.getUint8(h),h++,x=Math.ceil((M-1)*v/8),S=Math.ceil(x/4),T=new ArrayBuffer(4*S),E=new Uint8Array(T),t.ptr+=h,E.set(new Uint8Array(e,t.ptr,x)),A=new Uint32Array(T),t.ptr+=x,I=0;M-1>>>I;)I++;x=Math.ceil(w*I/8),S=Math.ceil(x/4),T=new ArrayBuffer(4*S),(E=new Uint8Array(T)).set(new Uint8Array(e,t.ptr,x)),k=new Uint32Array(T),t.ptr+=x,D=d>=3?f(A,v,M-1,n,R,O):s(A,v,M-1,n,R,O),d>=3?l(k,r,I,w,D):o(k,r,I,w,D)}else t.counter.bitstuffer++,I=v,t.ptr+=h,I>0&&(x=Math.ceil(w*I/8),S=Math.ceil(x/4),T=new ArrayBuffer(4*S),(E=new Uint8Array(T)).set(new Uint8Array(e,t.ptr,x)),k=new Uint32Array(T),t.ptr+=x,d>=3?null==n?u(k,r,I,w):l(k,r,I,w,!1,n,R,O):null==n?c(k,r,I,w):o(k,r,I,w,!1,n,R,O))},readTiles:function(e,t,r,n){var a=t.headerInfo,i=a.width,o=a.height,s=i*o,l=a.microBlockSize,f=a.imageType,c=d.getDataTypeSize(f),u=Math.ceil(i/l),h=Math.ceil(o/l);t.pixels.numBlocksY=h,t.pixels.numBlocksX=u,t.pixels.ptr=0;var p,m,g,y,_,b,v,w,k,T,E=0,x=0,S=0,D=0,A=0,M=0,I=0,R=0,O=0,C=0,P=0,L=0,U=0,B=0,$=0,N=new r(l*l),z=o%l||l,Z=i%l||l,G=a.numDims,j=t.pixels.resultMask,V=t.pixels.resultPixels,F=a.fileVersion>=5?14:15,K=a.zMax;for(S=0;S<h;S++)for(A=S!==h-1?l:z,D=0;D<u;D++)for(C=S*i*l+D*l,P=i-(M=D!==u-1?l:Z),w=0;w<G;w++){if(G>1?(T=V,C=S*i*l+D*l,V=new r(t.pixels.resultPixels.buffer,s*w*c,s),K=a.maxValues[w]):T=null,I=e.byteLength-t.ptr,m={},$=0,R=(p=new DataView(e,t.ptr,Math.min(10,I))).getUint8(0),$++,k=a.fileVersion>=5?4&R:0,O=R>>6&255,(R>>2&F)!=(D*l>>3&F))throw"integrity issue";if(k&&0===w)throw"integrity issue";if((_=3&R)>3)throw t.ptr+=$,"Invalid block encoding ("+_+")";if(2!==_)if(0===_){if(k)throw"integrity issue";if(t.counter.uncompressed++,t.ptr+=$,L=(L=A*M*c)<(U=e.byteLength-t.ptr)?L:U,g=new ArrayBuffer(L%c==0?L:L+c-L%c),new Uint8Array(g).set(new Uint8Array(e,t.ptr,L)),y=new r(g),B=0,j)for(E=0;E<A;E++){for(x=0;x<M;x++)j[C]&&(V[C]=y[B++]),C++;C+=P}else for(E=0;E<A;E++){for(x=0;x<M;x++)V[C++]=y[B++];C+=P}t.ptr+=B*c}else if(b=d.getDataTypeUsed(k&&f<6?4:f,O),v=d.getOnePixel(m,$,b,p),$+=d.getDataTypeSize(b),3===_)if(t.ptr+=$,t.counter.constantoffset++,j)for(E=0;E<A;E++){for(x=0;x<M;x++)j[C]&&(V[C]=k?Math.min(K,T[C]+v):v),C++;C+=P}else for(E=0;E<A;E++){for(x=0;x<M;x++)V[C]=k?Math.min(K,T[C]+v):v,C++;C+=P}else if(t.ptr+=$,d.decodeBits(e,t,N,v,w),$=0,k)if(j)for(E=0;E<A;E++){for(x=0;x<M;x++)j[C]&&(V[C]=N[$++]+T[C]),C++;C+=P}else for(E=0;E<A;E++){for(x=0;x<M;x++)V[C]=N[$++]+T[C],C++;C+=P}else if(j)for(E=0;E<A;E++){for(x=0;x<M;x++)j[C]&&(V[C]=N[$++]),C++;C+=P}else for(E=0;E<A;E++){for(x=0;x<M;x++)V[C++]=N[$++];C+=P}else{if(k)if(j)for(E=0;E<A;E++)for(x=0;x<M;x++)j[C]&&(V[C]=T[C]),C++;else for(E=0;E<A;E++)for(x=0;x<M;x++)V[C]=T[C],C++;t.counter.constant++,t.ptr+=$}}G>1&&!n&&(t.pixels.resultPixels=d.swapDimensionOrder(t.pixels.resultPixels,s,G,r))},formatFileInfo:function(e){return{fileIdentifierString:e.headerInfo.fileIdentifierString,fileVersion:e.headerInfo.fileVersion,imageType:e.headerInfo.imageType,height:e.headerInfo.height,width:e.headerInfo.width,numValidPixel:e.headerInfo.numValidPixel,microBlockSize:e.headerInfo.microBlockSize,blobSize:e.headerInfo.blobSize,maxZError:e.headerInfo.maxZError,pixelType:d.getPixelType(e.headerInfo.imageType),eofOffset:e.eofOffset,mask:e.mask?{numBytes:e.mask.numBytes}:null,pixels:{numBlocksX:e.pixels.numBlocksX,numBlocksY:e.pixels.numBlocksY,maxValue:e.headerInfo.zMax,minValue:e.headerInfo.zMin,noDataValue:e.noDataValue}}},constructConstantSurface:function(e,t){var r=e.headerInfo.zMax,n=e.headerInfo.zMin,a=e.headerInfo.maxValues,i=e.headerInfo.numDims,o=e.headerInfo.height*e.headerInfo.width,s=0,l=0,f=0,c=e.pixels.resultMask,u=e.pixels.resultPixels;if(c)if(i>1){if(t)for(s=0;s<i;s++)for(f=s*o,r=a[s],l=0;l<o;l++)c[l]&&(u[f+l]=r);else for(l=0;l<o;l++)if(c[l])for(f=l*i,s=0;s<i;s++)u[f+i]=a[s]}else for(l=0;l<o;l++)c[l]&&(u[l]=r);else if(i>1&&n!==r)if(t)for(s=0;s<i;s++)for(f=s*o,r=a[s],l=0;l<o;l++)u[f+l]=r;else for(l=0;l<o;l++)for(f=l*i,s=0;s<i;s++)u[f+s]=a[s];else for(l=0;l<o*i;l++)u[l]=r},getDataTypeArray:function(e){var t;switch(e){case 0:t=Int8Array;break;case 1:t=Uint8Array;break;case 2:t=Int16Array;break;case 3:t=Uint16Array;break;case 4:t=Int32Array;break;case 5:t=Uint32Array;break;case 6:t=Float32Array;break;case 7:t=Float64Array;break;default:t=Float32Array}return t},getPixelType:function(e){var t;switch(e){case 0:t="S8";break;case 1:t="U8";break;case 2:t="S16";break;case 3:t="U16";break;case 4:t="S32";break;case 5:t="U32";break;case 6:t="F32";break;case 7:t="F64";break;default:t="F32"}return t},isValidPixelValue:function(e,t){if(null==t)return!1;var r;switch(e){case 0:r=t>=-128&&t<=127;break;case 1:r=t>=0&&t<=255;break;case 2:r=t>=-32768&&t<=32767;break;case 3:r=t>=0&&t<=65536;break;case 4:r=t>=-2147483648&&t<=2147483647;break;case 5:r=t>=0&&t<=4294967296;break;case 6:r=t>=-34027999387901484e22&&t<=34027999387901484e22;break;case 7:r=t>=-17976931348623157e292&&t<=17976931348623157e292;break;default:r=!1}return r},getDataTypeSize:function(e){var t=0;switch(e){case 0:case 1:t=1;break;case 2:case 3:t=2;break;case 4:case 5:case 6:t=4;break;case 7:t=8;break;default:t=e}return t},getDataTypeUsed:function(e,t){var r=e;switch(e){case 2:case 4:r=e-t;break;case 3:case 5:r=e-2*t;break;case 6:r=0===t?e:1===t?2:1;break;case 7:r=0===t?e:e-2*t+1;break;default:r=e}return r},getOnePixel:function(e,t,r,n){var a=0;switch(r){case 0:a=n.getInt8(t);break;case 1:a=n.getUint8(t);break;case 2:a=n.getInt16(t,!0);break;case 3:a=n.getUint16(t,!0);break;case 4:a=n.getInt32(t,!0);break;case 5:a=n.getUInt32(t,!0);break;case 6:a=n.getFloat32(t,!0);break;case 7:a=n.getFloat64(t,!0);break;default:throw"the decoder does not understand this pixel type"}return a},swapDimensionOrder:function(e,t,r,n,a){var i=0,o=0,s=0,l=0,f=e;if(r>1)if(f=new n(t*r),a)for(i=0;i<t;i++)for(l=i,s=0;s<r;s++,l+=t)f[l]=e[o++];else for(i=0;i<t;i++)for(l=i,s=0;s<r;s++,l+=t)f[o++]=e[l];return f}},h=function(e,t,r){this.val=e,this.left=t,this.right=r},{decode:function(e,t){var r=(t=t||{}).noDataValue,n=0,a={};a.ptr=t.inputOffset||0,a.pixels={},d.readHeaderInfo(e,a);var i=a.headerInfo,o=i.fileVersion,s=d.getDataTypeArray(i.imageType);if(o>5)throw"unsupported lerc version 2."+o;d.readMask(e,a),i.numValidPixel===i.width*i.height||a.pixels.resultMask||(a.pixels.resultMask=t.maskData);var l=i.width*i.height;a.pixels.resultPixels=new s(l*i.numDims),a.counter={onesweep:0,uncompressed:0,lut:0,bitstuffer:0,constant:0,constantoffset:0};var f,c=!t.returnPixelInterleavedDims;if(0!==i.numValidPixel)if(i.zMax===i.zMin)d.constructConstantSurface(a,c);else if(o>=4&&d.checkMinMaxRanges(e,a))d.constructConstantSurface(a,c);else{var u=new DataView(e,a.ptr,2),h=u.getUint8(0);if(a.ptr++,h)d.readDataOneSweep(e,a,s,c);else if(o>1&&i.imageType<=1&&Math.abs(i.maxZError-.5)<1e-5){var p=u.getUint8(1);if(a.ptr++,a.encodeMode=p,p>2||o<4&&p>1)throw"Invalid Huffman flag "+p;p?d.readHuffman(e,a,s,c):d.readTiles(e,a,s,c)}else d.readTiles(e,a,s,c)}a.eofOffset=a.ptr,t.inputOffset?(f=a.headerInfo.blobSize+t.inputOffset-a.ptr,Math.abs(f)>=1&&(a.eofOffset=t.inputOffset+a.headerInfo.blobSize)):(f=a.headerInfo.blobSize-a.ptr,Math.abs(f)>=1&&(a.eofOffset=a.headerInfo.blobSize));var m={width:i.width,height:i.height,pixelData:a.pixels.resultPixels,minValue:i.zMin,maxValue:i.zMax,validPixelCount:i.numValidPixel,dimCount:i.numDims,dimStats:{minValues:i.minValues,maxValues:i.maxValues},maskData:a.pixels.resultMask};if(a.pixels.resultMask&&d.isValidPixelValue(i.imageType,r)){var g=a.pixels.resultMask;for(n=0;n<l;n++)g[n]||(m.pixelData[n]=r);m.noDataValue=r}return a.noDataValue=r,t.returnFileInfo&&(m.fileInfo=d.formatFileInfo(a)),m},getBandCount:function(e){for(var t=0,r=0,n={ptr:0,pixels:{}};r<e.byteLength-58;)d.readHeaderInfo(e,n),r+=n.headerInfo.blobSize,t++,n.ptr=r;return t}}),_=(p=new ArrayBuffer(4),m=new Uint8Array(p),new Uint32Array(p)[0]=1,1===m[0]),b={decode:function(e,t){if(!_)throw"Big endian system is not supported.";var r,n,a=(t=t||{}).inputOffset||0,i=new Uint8Array(e,a,10),o=String.fromCharCode.apply(null,i);if("CntZImage"===o.trim())r=g,n=1;else{if("Lerc2"!==o.substring(0,5))throw"Unexpected file identifier string: "+o;r=y,n=2}for(var s,l,f,c,u,d,h=0,p=e.byteLength-10,m=[],b={width:0,height:0,pixels:[],pixelType:t.pixelType,mask:null,statistics:[]},v=0;a<p;){var w=r.decode(e,{inputOffset:a,encodedMaskData:s,maskData:f,returnMask:0===h,returnEncodedMask:0===h,returnFileInfo:!0,returnPixelInterleavedDims:t.returnPixelInterleavedDims,pixelType:t.pixelType||null,noDataValue:t.noDataValue||null});a=w.fileInfo.eofOffset,f=w.maskData,0===h&&(s=w.encodedMaskData,b.width=w.width,b.height=w.height,b.dimCount=w.dimCount||1,b.pixelType=w.pixelType||w.fileInfo.pixelType,b.mask=f),n>1&&(f&&m.push(f),w.fileInfo.mask&&w.fileInfo.mask.numBytes>0&&v++),h++,b.pixels.push(w.pixelData),b.statistics.push({minValue:w.minValue,maxValue:w.maxValue,noDataValue:w.noDataValue,dimStats:w.dimStats})}if(n>1&&v>1){for(d=b.width*b.height,b.bandMasks=m,(f=new Uint8Array(d)).set(m[0]),c=1;c<m.length;c++)for(l=m[c],u=0;u<d;u++)f[u]=f[u]&l[u];b.maskData=f}return b}};module.exports?module.exports=b:this.Lerc=b}();var Lerc=LercDecode.exports,fieldTagNames={315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",259:"Compression",33432:"Copyright",306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",273:"StripOffsets",255:"SubfileType",263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",322:"TileWidth",301:"TransferFunction",318:"WhitePoint",344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",37510:"UserComment",33723:"IPTC",34675:"ICC Profile",700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop",33550:"ModelPixelScale",33922:"ModelTiepoint",34264:"ModelTransformation",34735:"GeoKeyDirectory",34736:"GeoDoubleParams",34737:"GeoAsciiParams",50674:"LercParameters"},fieldTags={};for(var key in fieldTagNames)fieldTagNames.hasOwnProperty(key)&&(fieldTags[fieldTagNames[key]]=parseInt(key,10));fieldTags.BitsPerSample,fieldTags.ExtraSamples,fieldTags.SampleFormat,fieldTags.StripByteCounts,fieldTags.StripOffsets,fieldTags.StripRowCounts,fieldTags.TileByteCounts,fieldTags.TileOffsets,fieldTags.SubIFDs;var fieldTypeNames={1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",10:"SRATIONAL",11:"FLOAT",12:"DOUBLE",13:"IFD",16:"LONG8",17:"SLONG8",18:"IFD8"},fieldTypes={};for(var _key in fieldTypeNames)fieldTypeNames.hasOwnProperty(_key)&&(fieldTypes[fieldTypeNames[_key]]=parseInt(_key,10));var LercParameters={Version:0,AddCompression:1},LercAddCompression={None:0,Deflate:1},geoKeyNames={1024:"GTModelTypeGeoKey",1025:"GTRasterTypeGeoKey",1026:"GTCitationGeoKey",2048:"GeographicTypeGeoKey",2049:"GeogCitationGeoKey",2050:"GeogGeodeticDatumGeoKey",2051:"GeogPrimeMeridianGeoKey",2052:"GeogLinearUnitsGeoKey",2053:"GeogLinearUnitSizeGeoKey",2054:"GeogAngularUnitsGeoKey",2055:"GeogAngularUnitSizeGeoKey",2056:"GeogEllipsoidGeoKey",2057:"GeogSemiMajorAxisGeoKey",2058:"GeogSemiMinorAxisGeoKey",2059:"GeogInvFlatteningGeoKey",2060:"GeogAzimuthUnitsGeoKey",2061:"GeogPrimeMeridianLongGeoKey",2062:"GeogTOWGS84GeoKey",3072:"ProjectedCSTypeGeoKey",3073:"PCSCitationGeoKey",3074:"ProjectionGeoKey",3075:"ProjCoordTransGeoKey",3076:"ProjLinearUnitsGeoKey",3077:"ProjLinearUnitSizeGeoKey",3078:"ProjStdParallel1GeoKey",3079:"ProjStdParallel2GeoKey",3080:"ProjNatOriginLongGeoKey",3081:"ProjNatOriginLatGeoKey",3082:"ProjFalseEastingGeoKey",3083:"ProjFalseNorthingGeoKey",3084:"ProjFalseOriginLongGeoKey",3085:"ProjFalseOriginLatGeoKey",3086:"ProjFalseOriginEastingGeoKey",3087:"ProjFalseOriginNorthingGeoKey",3088:"ProjCenterLongGeoKey",3089:"ProjCenterLatGeoKey",3090:"ProjCenterEastingGeoKey",3091:"ProjCenterNorthingGeoKey",3092:"ProjScaleAtNatOriginGeoKey",3093:"ProjScaleAtCenterGeoKey",3094:"ProjAzimuthAngleGeoKey",3095:"ProjStraightVertPoleLongGeoKey",3096:"ProjRectifiedGridAngleGeoKey",4096:"VerticalCSTypeGeoKey",4097:"VerticalCitationGeoKey",4098:"VerticalDatumGeoKey",4099:"VerticalUnitsGeoKey"},geoKeys={};for(var _key2 in geoKeyNames)geoKeyNames.hasOwnProperty(_key2)&&(geoKeys[geoKeyNames[_key2]]=parseInt(_key2,10));var LercDecoder=function(e){_inherits(r,BaseDecoder);var t=_createSuper(r);function r(e){var n;return _classCallCheck(this,r),(n=t.call(this)).planarConfiguration=void 0!==e.PlanarConfiguration?e.PlanarConfiguration:1,n.samplesPerPixel=void 0!==e.SamplesPerPixel?e.SamplesPerPixel:1,n.addCompression=e.LercParameters[LercParameters.AddCompression],n}return _createClass(r,[{key:"decodeBlock",value:function(e){switch(this.addCompression){case LercAddCompression.None:break;case LercAddCompression.Deflate:e=inflate_1(new Uint8Array(e)).buffer;break;default:throw new Error("Unsupported LERC additional compression method identifier: ".concat(this.addCompression))}return Lerc.decode(e,{returnPixelInterleavedDims:1===this.planarConfiguration}).pixels[0].buffer}}]),r}(),lerc=Object.freeze({__proto__:null,default:LercDecoder});'],{type:"application/javascript"}),t=URL.createObjectURL(e),new Worker(t)))),sr}function vr(e){try{return e.getBoundingBox()}catch(r){var t=e.fileDirectory;return[0,0,t.ImageWidth,t.ImageLength]}}function yr(e){try{return e.getOrigin().slice(0,2)}catch(t){return[0,e.fileDirectory.ImageLength]}}function gr(e,t){try{return e.getResolution(t)[0]}catch(r){return t.fileDirectory.ImageWidth/e.fileDirectory.ImageWidth}}function br(e){var t=e.geoKeys;if(!t)return null;if(t.ProjectedCSTypeGeoKey){var r="EPSG:"+t.ProjectedCSTypeGeoKey,n=(0,$e.U2)(r);if(!n){var i=(0,ur.Ne)(t.ProjLinearUnitsGeoKey);i&&(n=new $e.kv({code:r,units:i}))}return n}if(t.GeographicTypeGeoKey){var o="EPSG:"+t.GeographicTypeGeoKey,a=(0,$e.U2)(o);if(!a){var s=(0,ur.Ne)(t.GeogAngularUnitsGeoKey);s&&(a=new $e.kv({code:o,units:s}))}return a}return null}function wr(e){return e.getImageCount().then((function(t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e.getImage(n);return Promise.all(r)}))}function _r(e,t,r,n,i){if(Array.isArray(e)){var o=e.length;if(!Array.isArray(t)||o!=t.length){var a=new Error(n);throw i(a),a}for(var s=0;s<o;++s)_r(e[s],t[s],r,n,i)}else if(t=t,Math.abs(e-t)>r*e)throw new Error(n)}function xr(e){return e instanceof Int8Array?-128:e instanceof Int16Array?-32768:e instanceof Int32Array?-2147483648:e instanceof Float32Array?12e-39:0}function Tr(e){return e instanceof Int8Array?127:e instanceof Uint8Array||e instanceof Uint8ClampedArray?255:e instanceof Int16Array?32767:e instanceof Uint16Array?65535:e instanceof Int32Array?2147483647:e instanceof Uint32Array?4294967295:e instanceof Float32Array?34e37:255}var Er=function(e){function t(t){var r;(r=e.call(this,{state:W.Z.LOADING,tileGrid:null,projection:null,opaque:t.opaque,transition:t.transition,interpolate:!1!==t.interpolate,wrapX:t.wrapX})||this).sourceInfo_=t.sources;var n=r.sourceInfo_.length;r.sourceImagery_=new Array(n),r.resolutionFactors_=new Array(n),r.samplesPerPixel_,r.nodataValues_,r.metadata_,r.normalize_=!1!==t.normalize,r.addAlpha_=!1,r.error_=null,r.readMethod_=t.convertToRGB?"readRGB":"readRasters",r.setKey(r.sourceInfo_.map((function(e){return e.url})).join(","));for(var i,o=(0,qt.Z)(r),a=new Array(n),s=0;s<n;++s)a[s]=((i=r.sourceInfo_[s]).blob?hr(i.blob):fr(i.url)).then(wr);return Promise.all(a).then((function(e){o.configure_(e)})).catch((function(e){console.error(e),o.error_=e,o.setState(W.Z.ERROR)})),r}(0,Xt.Z)(t,e);var r=t.prototype;return r.getError=function(){return this.error_},r.configure_=function(e){for(var t,r,n,i,o=this,a=new Array(e.length),s=new Array(e.length),u=new Array(e.length),l=0,c=e.length,f=0;f<c;++f){var h=e[f],d=h.length,p=void 0,m=void 0,v=new Array(d),y=new Array(d);s[f]=new Array(d),u[f]=new Array(d);for(var g=0;g<d;++g){var b=h[g],w=b.getGDALNoData();u[f][g]=b.getGDALMetadata(),s[f][g]=null===w?NaN:w;var _=this.sourceInfo_[f].bands;a[f]=_?_.length:b.getSamplesPerPixel();var x=d-(g+1);p||(p=vr(b)),m||(m=yr(b)),y[x]=gr(b,h[0]),v[x]=[b.getTileWidth(),b.getTileHeight()]}if(t?(0,Ke.Ed)(t,p,t):t=p,r)_r(r,m,0,"Origin mismatch for source "+f+", got ["+m+"] but expected ["+r+"]",this.viewRejector);else r=m;i?function(){i.length-l>y.length&&(l=i.length-y.length);var e=i[i.length-1]/y[y.length-1];o.resolutionFactors_[f]=e;var t=y.map((function(t){return t*e})),r="Resolution mismatch for source "+f+", got ["+t+"] but expected ["+i+"]";_r(i.slice(l,i.length),t,.005,r,o.viewRejector)}():(i=y,this.resolutionFactors_[f]=1),n?_r(n.slice(l,n.length),v,0,"Tile size mismatch for source "+f,this.viewRejector):n=v,this.sourceImagery_[f]=h.reverse()}for(var T=0,E=this.sourceImagery_.length;T<E;++T)for(var k=this.sourceImagery_[T];k.length<i.length;)k.unshift(void 0);if(!this.getProjection())for(var S=e[0],A=S.length-1;A>=0;--A){var R=br(S[A]);if(R){this.projection=R;break}}this.samplesPerPixel_=a,this.nodataValues_=s,this.metadata_=u;e:for(var C=0;C<c;++C){if(void 0!==this.sourceInfo_[C].nodata){this.addAlpha_=!0;break}var P=s[C],D=this.sourceInfo_[C].bands;if(D){for(var O=0;O<D.length;++O)if(!isNaN(P[D[O]-1])){this.addAlpha_=!0;break e}}else for(var M=0;M<P.length;++M)if(!isNaN(P[M])){this.addAlpha_=!0;break e}}var I=this.addAlpha_?1:0;this.bandCount=a.reduce((function(e,t){return e+=t}),0)+I;var L=new ar.Z({extent:t,minZoom:l,origin:r,resolutions:i,tileSizes:n});this.tileGrid=L,this.setLoader(this.loadTile_.bind(this)),this.setState(W.Z.READY),this.viewResolver({projection:this.projection,resolutions:i,center:(0,$e.lO)((0,Ke.qg)(t),this.projection),extent:(0,$e.Fj)(t,this.projection),zoom:0})},r.loadTile_=function(e,t,r){for(var n=this,i=(0,z.Pq)(this.tileGrid.getTileSize(e)),o=this.sourceImagery_.length,a=new Array(o),s=this.addAlpha_,u=this.bandCount,l=this.samplesPerPixel_,c=this.nodataValues_,f=this.sourceInfo_,h=function(o){var s=f[o],u=n.resolutionFactors_[o],l=[Math.round(t*(i[0]*u)),Math.round(r*(i[1]*u)),Math.round((t+1)*(i[0]*u)),Math.round((r+1)*(i[1]*u))],h=n.sourceImagery_[o][e],d=void 0;s.bands&&(d=s.bands.map((function(e){return e-1})));var p=void 0;p=isNaN(s.nodata)?d?d.map((function(e){return c[o][e]})):c[o]:s.nodata,a[o]=h[n.readMethod_]({window:l,width:i[0],height:i[1],samples:d,fillValue:p,pool:mr(),interleave:!1})},d=0;d<o;++d)h(d);var p=i[0]*i[1],m=p*u,v=this.normalize_,y=this.metadata_;return Promise.all(a).then((function(e){var t;t=v?new Uint8Array(m):new Float32Array(m);for(var r=0,n=0;n<p;++n){for(var i=s,a=0;a<o;++a){var u=f[a],h=u.min,d=u.max,g=void 0,b=void 0;if(v){var w=y[a][0];void 0===h&&(h=w&&pr in w?parseFloat(w.STATISTICS_MINIMUM):xr(e[a][0])),void 0===d&&(d=w&&dr in w?parseFloat(w.STATISTICS_MAXIMUM):Tr(e[a][0])),b=-h*(g=255/(d-h))}for(var _=0;_<l[a];++_){var x=e[a][_][n],T=void 0;if(T=v?(0,dt.uZ)(g*x+b,0,255):x,s){var E=u.nodata;if(void 0===E){var k=void 0;k=u.bands?u.bands[_]-1:_,E=c[a][k]}x!==E&&(i=!1,t[r]=T)}else t[r]=T;r++}}s&&(i||(t[r]=255),r++)}return t}))},t}(or);Er.prototype.getView;var kr=Er,Sr=(0,j.Z)("div")({overflow:"hidden"}),Ar=(0,j.Z)(R.Z)({overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"}),Rr=(0,j.Z)(Sr)({flex:"1 1 auto"}),Cr=(0,j.Z)("div")({flex:"0 0 auto"}),Pr=(0,j.Z)("ul")({listStyle:"none",margin:0,padding:0,"& > li":{marginTop:"5px","&:firstChild":{marginTop:0}}}),Dr={type:"file",url:"",geotiff:"",bands:"1,2,3",nodata:"0",min:"0",max:"255"},Or=function(){var e=(0,Ht.e)(),t=s.useState([]),r=t[0],o=t[1],f=s.useState(null),h=f[0],d=f[1],p=s.useState(),m=p[0],v=p[1],y=(0,l.cI)({mode:"onSubmit",criteriaMode:"all",defaultValues:{sources:[Dr]}}),g=y.control,b=y.handleSubmit,w=y.register,_=y.watch,x=y.reset,T=y.setValue,E=y.formState.errors,k=(0,l.Dq)({name:"sources",control:g}),S=k.fields,j=k.append,V=k.remove,$=_("sources"),K=s.useCallback((function(t){o((function(r){var n=(0,i.Z)(r),o=n.findIndex((function(e){return t===e.id})),a=n[o];return e.map&&a?(e.map.removeLayer(a.layer),n.splice(o,1),n):r}))}),[e.map]),H=s.useCallback((function(e,t){o((function(r){var n=(0,i.Z)(r),o=n.findIndex((function(t){return e===t.id})),a=n[o];return a&&a.error!==t?(a.error=t,n):r}))}),[]),X=s.useCallback(function(){var e=(0,n.Z)(a().mark((function e(t,r,n,s){var u,l,c,f,h,p,m,v,y;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.getView();case 2:if(u=e.sent,(l=null==u?void 0:u.projection)instanceof $e.kv){e.next=7;break}return d("NotFoundCrs"),e.abrupt("return");case 7:if(c=l.getCode(),(0,$e.U2)(c)){e.next=19;break}e.prev=9,f=Wt.utils.getCrs(c),Kt.default.defs(c,f),e.next=18;break;case 14:return e.prev=14,e.t0=e.catch(9),d("UnsupportedCrs"),e.abrupt("return");case 18:(0,$t.z)(Kt.default);case 19:h=r.getTileGrid(),p=new Vt.Z({tileGrid:h,url:"{z},{x},{y}",interpolate:!1,tileLoadFunction:function(e,t){var i=t.split(",").map(Number),o=r.getTile(i[0],i[1],i[2],1,l),a=function(){var t=(0,z.Pq)(h.getTileSize(i[0])),r=document.createElement("canvas");r.width=t[0],r.height=t[1];var n=r.getContext("2d");if(n){var a=n.getImageData(0,0,r.width,r.height),s=a.data,u=o.getData();if(!(u instanceof DataView)){for(var l=u.length,c=0;c<l;c++)s[c]=u[c];n.putImageData(a,0,0),e.getImage().src=r.toDataURL()}}};if(o.getState()===q.Z.LOADED)a();else{o.addEventListener("change",(function e(){var t=o.getState();t!==q.Z.LOADING&&(o.removeEventListener("change",e),t===q.Z.LOADED&&a(),t===q.Z.ERROR&&H(n,"FailedLoadTile"))})),o.load()}},projection:l}),m=new zt({source:p}),t.addLayer(m),o((function(e){return[].concat((0,i.Z)(e),[{id:n,layer:m,sources:s,error:null}])})),(v=u.extent)&&((y=(0,$e.$A)(v,c,"EPSG:3857"))[0]>y[2]&&(y[2]+=2*(0,Kt.default)("EPSG:4326","EPSG:3857",[180,0])[0]),t.getView().fit(y,{padding:[40,20,40,20],maxZoom:20}));case 26:case"end":return e.stop()}}),e,null,[[9,14]])})));return function(t,r,n,i){return e.apply(this,arguments)}}(),[H]),Y=s.useCallback((function(t){var r=t.sources,n=t.id;v(!0);var i=new kr({sources:r});if(i.getState()===W.Z.READY)e.map&&X(e.map,i,n,r),v(!1);else{i.addEventListener("change",(function t(){var o=i.getState();o===W.Z.ERROR&&(i.removeEventListener("change",t),d("FailedLoadSource"),v(!1)),o===W.Z.READY&&(i.removeEventListener("change",t),e.map&&X(e.map,i,n,r),v(!1))}))}}),[e.map,X]),Q=s.useCallback((function(e){for(var t="",n=0,i=[],o=0;o<e.sources.length;o++){var a=e.sources[o],s=a.bands.split(",").map((function(e){return parseInt(e,10)}));n+=s.length;var u=parseFloat(a.min),l=parseFloat(a.max),c=parseFloat(a.nodata),f="";switch(a.type){case"file":if(!(a.geotiff instanceof FileList))break;var h=a.geotiff[0];f+=h.name,i.push({blob:h,bands:s,min:u,max:l,nodata:c});break;case"url":var p=a.url;f+=p,i.push({url:p,bands:s,min:u,max:l,nodata:c})}f.length>0&&(t+=f+"_"+s.join("")+"_"+a.min+"_"+a.max+"_"+a.nodata)}if(1===i.length&&1===n){var m=i[0].bands[0];i[0].bands=[m,m,m]}else if(3!==n)return void d("UnmatchBands");r.findIndex((function(e){return t===e.id}))>=0?d("Duplicate"):Y({id:t,sources:i})}),[Y,r]);s.useEffect((function(){!1===m&&x()}),[m,x]);var J=s.useCallback((function(){T("sources",[{type:"url",geotiff:"",url:"https://sentinel-cogs.s3.us-west-2.amazonaws.com/sentinel-s2-l2a-cogs/2020/S2A_36QWD_20200701_0_L2A/TCI.tif",bands:"1,2,3",nodata:"0",min:"0",max:"255"}]),d(null)}),[T,d]),ee=s.useCallback((function(){T("sources",[{type:"url",geotiff:"",url:"https://landsat-pds.s3.amazonaws.com/c1/L8/139/045/LC08_L1TP_139045_20170304_20170316_01_T1/LC08_L1TP_139045_20170304_20170316_01_T1_B4.TIF",bands:"1",nodata:"0",min:"1",max:"15978"},{type:"url",geotiff:"",url:"https://landsat-pds.s3.amazonaws.com/c1/L8/139/045/LC08_L1TP_139045_20170304_20170316_01_T1/LC08_L1TP_139045_20170304_20170316_01_T1_B3.TIF",bands:"1",nodata:"0",min:"1",max:"15239"},{type:"url",geotiff:"",url:"https://landsat-pds.s3.amazonaws.com/c1/L8/139/045/LC08_L1TP_139045_20170304_20170316_01_T1/LC08_L1TP_139045_20170304_20170316_01_T1_B2.TIF",bands:"1",nodata:"0",min:"1",max:"14947"}]),d(null)}),[T,d]);return s.createElement(s.Fragment,null,s.createElement(c.ZP,null),s.createElement(u.Helmet,null,s.createElement("title",null,"Display GeoTIFF"),s.createElement("meta",{name:"description",content:"Display GeoTIFF on map."}),s.createElement("link",{rel:"canonical",href:"https://yonda-yonda.github.io/exmap/geotiff"}),s.createElement("link",{rel:"icon",type:"image/x-icon",href:"https://github.githubassets.com/favicon.ico"}),s.createElement("link",{rel:"stylesheet",href:"https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap"}),s.createElement("meta",{name:"twitter:card",content:"summary_large_image"}),s.createElement("meta",{name:"twitter:title",content:"Display GeoTIFF"}),s.createElement("meta",{name:"twitter:description",content:"GeoTIFFを表示します"}),s.createElement("meta",{property:"og:url",content:"https://yonda-yonda.github.io/exmap/geotiff"}),s.createElement("meta",{name:"twitter:image",content:"https://yonda-yonda.github.io/exmap/image/twitter_geotiff.png"})),s.createElement(C.Z,null,s.createElement(R.Z,{variant:"h2",component:"h1"},"Display GeoTIFF"),s.createElement(P.Z,{my:4,spacing:4},s.createElement("div",null,s.createElement(D.ZP,{container:!0,spacing:2},s.createElement(D.ZP,{item:!0,xs:9},s.createElement("div",{ref:e.ref,style:{width:"100%",height:"340px"}})),s.createElement(D.ZP,{item:!0,xs:3},r.length>0?s.createElement(Pr,null,r.map((function(e){return s.createElement("li",{key:e.id},s.createElement(P.Z,{direction:"row",spacing:1,justifyContent:"space-between",alignItems:"center"},s.createElement(Rr,null,e.sources.map((function(e,t){var r="";return e.blob&&(r+=e.blob.name),e.url&&(r+=e.url.split("/").pop()),s.createElement(O.Z,{key:t,title:s.createElement(R.Z,{variant:"caption",display:"block"},r,s.createElement("br",null),"bands: ",e.bands.join(","),s.createElement("br",null),"range:"," ",e.min+" to "+e.max,s.createElement("br",null),"nodata: ",e.nodata),arrow:!0,placement:"left"},s.createElement(Ar,{variant:"body2"},r))})),"FailedLoadTile"===e.error&&s.createElement(R.Z,{variant:"caption",display:"block"},"Failed to load tiles. ",s.createElement("br",null),"タイルの読み込みに失敗しました。")),s.createElement(Cr,null,s.createElement(M.Z,{size:"small",variant:"outlined",onClick:function(){K(e.id)}},"REMOVE"))))}))):s.createElement(R.Z,null,"Nothing to display.")))),s.createElement("div",null,s.createElement("form",{onSubmit:b(Q)},s.createElement(P.Z,{spacing:2},s.createElement("div",null,s.createElement(M.Z,{variant:"outlined",onClick:J,size:"small",sx:{mr:1}},"sample 1"),s.createElement(M.Z,{variant:"outlined",onClick:ee,size:"small"},"sample 2")),S.map((function(e,t){var r,n,i,o,a,u,c,f;return s.createElement("div",{key:e.id},s.createElement(l.Qr,{control:g,name:"sources."+t+".type",render:function(e){var t=e.field;return s.createElement(I.Z,{fullWidth:!0},s.createElement(L.Z,Object.assign({row:!0},t),s.createElement(Z.Z,{value:"file",control:s.createElement(U.Z,{size:"small"}),label:"Local File"}),s.createElement(Z.Z,{value:"url",control:s.createElement(U.Z,{size:"small"}),label:"URL"})))}}),"file"===$[t].type&&s.createElement(I.Z,{component:"fieldset",error:!(null==E||null===(r=E.sources)||void 0===r||null===(n=r[t])||void 0===n||!n.geotiff),fullWidth:!0},s.createElement("input",Object.assign({},w("sources."+t+".geotiff",{required:!0,validate:{length:function(e){return e instanceof FileList&&1===e.length}}}),{type:"file"})),"required"===(null==E||null===(i=E.sources)||void 0===i||null===(o=i[t])||void 0===o||null===(a=o.geotiff)||void 0===a?void 0:a.type)&&s.createElement(F.Z,null,"Required. ",s.createElement("br",null),"ファイルを選択してください。"),"length"===(null==E||null===(u=E.sources)||void 0===u||null===(c=u[t])||void 0===c||null===(f=c.geotiff)||void 0===f?void 0:f.type)&&s.createElement(F.Z,null,"Required. ",s.createElement("br",null),"ファイルを1つ選択してください。")),"url"===$[t].type&&s.createElement(l.Qr,{control:g,name:"sources."+t+".url",render:function(e){var t=e.field,r=e.fieldState,n=r.invalid,i=r.error;return s.createElement(I.Z,{component:"fieldset",error:n,fullWidth:!0},s.createElement(G.Z,Object.assign({},t,{label:"url",size:"small",error:n,placeholder:"https://"})),"required"===(null==i?void 0:i.type)&&s.createElement(F.Z,null,"Required. ",s.createElement("br",null),"必須です。入力してください。"),"pattern"===(null==i?void 0:i.type)&&s.createElement(F.Z,null,"Not matched URL pattern.",s.createElement("br",null),"URLの形式が正しくありません。"))},rules:{required:!0,pattern:/^(https?):\/\/[^ "]+$/}}),s.createElement(P.Z,{direction:"row",spacing:2,sx:{mt:2,mb:1}},s.createElement(l.Qr,{control:g,name:"sources."+t+".bands",render:function(e){var t=e.field,r=e.fieldState,n=r.invalid,i=r.error;return s.createElement(I.Z,{component:"fieldset",error:n,fullWidth:!0},s.createElement(G.Z,Object.assign({},t,{label:"bands",size:"small",error:n,placeholder:"1,2,3"})),"required"===(null==i?void 0:i.type)&&s.createElement(F.Z,null,"Required. ",s.createElement("br",null),"必須です。入力してください。"),"pattern"===(null==i?void 0:i.type)&&s.createElement(F.Z,null,"Must be positive numbers(maximum of three) separated by commas.",s.createElement("br",null),"カンマ区切りで正数（最大で3つ）を入力してください。"))},rules:{required:!0,pattern:/^\s*([1-9]\d*){1,}(\s*,\s*([1-9]\d*)){0,2}\s*$/}}),s.createElement(l.Qr,{control:g,name:"sources."+t+".nodata",render:function(e){var t=e.field,r=e.fieldState,n=r.invalid,i=r.error;return s.createElement(I.Z,{component:"fieldset",error:n,fullWidth:!0},s.createElement(G.Z,Object.assign({},t,{label:"nodata",size:"small",error:n})),"required"===(null==i?void 0:i.type)&&s.createElement(F.Z,null,"Required. ",s.createElement("br",null),"必須です。入力してください。"),"pattern"===(null==i?void 0:i.type)&&s.createElement(F.Z,null,"must be a number. ",s.createElement("br",null),"数値を入力してください。"))},rules:{required:!0,pattern:/^((\+|-){0,1}[1-9]\d*|0)(\.\d+)?$/}}),s.createElement(l.Qr,{control:g,name:"sources."+t+".min",render:function(e){var t=e.field,r=e.fieldState,n=r.invalid,i=r.error;return s.createElement(I.Z,{component:"fieldset",error:n,fullWidth:!0},s.createElement(G.Z,Object.assign({},t,{label:"min",size:"small",error:n})),"required"===(null==i?void 0:i.type)&&s.createElement(F.Z,null,"Required. ",s.createElement("br",null),"必須です。入力してください。"),"pattern"===(null==i?void 0:i.type)&&s.createElement(F.Z,null,"must be a number. ",s.createElement("br",null),"数値を入力してください。"))},rules:{required:!0,pattern:/^((\+|-){0,1}[1-9]\d*|0)(\.\d+)?$/}}),s.createElement(l.Qr,{control:g,name:"sources."+t+".max",render:function(e){var t=e.field,r=e.fieldState,n=r.invalid,i=r.error;return s.createElement(I.Z,{component:"fieldset",error:n,fullWidth:!0},s.createElement(G.Z,Object.assign({},t,{label:"max",size:"small",error:n})),"required"===(null==i?void 0:i.type)&&s.createElement(F.Z,null,"Required. ",s.createElement("br",null),"必須です。入力してください。"),"pattern"===(null==i?void 0:i.type)&&s.createElement(F.Z,null,"must be a number. ",s.createElement("br",null),"数値を入力してください。"))},rules:{required:!0,pattern:/^((\+|-){0,1}[1-9]\d*|0)(\.\d+)?$/}})),s.createElement("div",null,t>0&&s.createElement(A,{color:"primary",size:"small","aria-label":"Delete",component:"span",onClick:function(){V(t)}},s.createElement(N.Z,null)),t===S.length-1&&t<2&&s.createElement(A,{color:"primary",size:"small","aria-label":"Add",component:"span",onClick:function(){j(Dr)}},s.createElement(B.Z,null))))}))),s.createElement(I.Z,{error:!!h,sx:{mt:3}},s.createElement("div",null,s.createElement(M.Z,{variant:"contained",type:"submit",onClick:function(){d(null)}},"Add Layer")),"FailedLoadSource"===h&&s.createElement(F.Z,{sx:{ml:0}},"Failed to load source. ",s.createElement("br",null),"ファイルの読み込みに失敗しました。"),"Duplicate"===h&&s.createElement(F.Z,{sx:{ml:0}},"Duplicate Layer. ",s.createElement("br",null),"すでに同じレイヤーが存在します。"),"UnmatchBands"===h&&s.createElement(F.Z,{sx:{ml:0}},"Number of Bands must be 3. ",s.createElement("br",null),"バンド数の合計が3になるよう設定してください。"),"NotFoundCrs"===h&&s.createElement(F.Z,{sx:{ml:0}},"Not found CRS. ",s.createElement("br",null),"ファイルの投影情報を取得することができませんでした。"),"UnsupportedCrs"===h&&s.createElement(F.Z,{sx:{ml:0}},"Unsupported CRS. ",s.createElement("br",null),"サポート外の投影系でファイルが作られています。")))))))}},1555:function(){},2913:function(){},8419:function(){},713:function(){},1120:function(e,t,r){"use strict";function n(e){return n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},n(e)}r.d(t,{Z:function(){return n}})},136:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(9611);function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&(0,n.Z)(e,t)}},6215:function(e,t,r){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}r.d(t,{Z:function(){return o}});var i=r(7326);function o(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return(0,i.Z)(e)}}}]);
//# sourceMappingURL=component---src-pages-geotiff-index-tsx-b45c48606e10e05223fa.js.map